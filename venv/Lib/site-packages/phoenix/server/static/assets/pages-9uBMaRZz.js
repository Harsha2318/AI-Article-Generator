import{A as E,b5 as me,b6 as Qe,b7 as Ae,b8 as Kt,B as xt,r as m,j as e,R as pe,u as ut,w as x,l as s,aA as Le,aB as Pn,aD as we,aE as Z,S as J,T as se,b9 as qe,ba as Je,ad as xl,bb as Ci,ac as Oe,ah as tn,ag as W,U as xe,P as U,ax as ie,E as F,bc as Ke,aI as ue,bd as Be,be as km,a8 as Dt,ay as Ca,a9 as _t,bf as mn,bg as bm,aJ as Sm,bh as vm,H as Fi,bi as mt,aP as _e,aO as vn,bj as pn,bk as In,m as gr,$ as Cm,F as Ki,K as Fm,bl as Km,bm as ol,bn as dl,bo as Ga,q as pt,bp as Tm,aU as yr,bq as Pm,br as Ti,bs as Im,bt as xm,bu as Dm,bv as _m,bw as Lm,bx as wm,by as Em,bz as Rm,bA as Mm,bB as it,D as Vm,bC as Am,bD as bt,g as fr,bE as zm,aF as Dl,bF as hr,bG as kr,bH as br,bI as Nm,ai as $m,bJ as Om,ae as Qm,af as jm,bK as qm,n as Bm}from"./vendor-C3H3sezv.js";import{c as X,D as ae,C as q,t as _l,h as xn,b as Lt,L as wt,v as Et,w as Sr,o as Ll,P as Va,f as $e,g as la,T as Se,E as Rt,q as ia,r as Aa,a as Ne,d as ra,x as Fa,s as Mt,y as Um,i as Vt,z as Hm,A as Gm,B as Wm,G as wl,H as El,u as Jm,J as Zm}from"./vendor-arizeai-DT8pwHfH.js";import{s as Xm,l as Ym,j as Rl,a as Ve,i as Ml,b as ep,c as np,d as ea,e as Cn,f as vr,D as Cr,g as Zn,h as tt,k as ap,m as ve,T as en,n as tp,o as Vl,p as Pi,q as lp,r as Ii,t as ip,u as rp,v as sp,G as At,_ as h,w as v,x as M,I as L,E as gt,y as sn,z as C,A as Y,R as Fe,B as Pe,C as he,F as De,H as Ee,J as Re,K as on,L as dn,M as cn,N as Al,O as Ce,P as Dn,Q as Fr,S as He,U as ne,V as de,W as Ge,X as Kr,Y as Pt,Z as ze,$ as An,a0 as op,a1 as Ye,a2 as Tr,a3 as Cl,a4 as zl,a5 as dp,a6 as cp,a7 as Fl,a8 as St,a9 as ce,aa as Pr,ab as up,ac as mp,ad as un,ae as pp,af as wn,ag as gp,ah as Ir,ai as zt,aj as Ka,ak as Nl,al as $l,am as xr,an as yp,ao as fp,ap as hp,aq as kp,ar as bp,as as Sp,at as vp,au as rt,av as Cp,aw as ge,ax as Kl,ay as ye,az as fe,aA as nn,aB as Fp,aC as Kp,aD as Tp,aE as gn,aF as oe,aG as Dr,aH as Pp,aI as Ip,aJ as xp,aK as Nt,aL as $t,aM as _r,aN as Dp,aO as _p,aP as Lp,aQ as Ot,aR as wp,aS as Lr,aT as La,aU as st,aV as Ze,aW as Ep,aX as Ol,aY as yn,aZ as Rp,a_ as Mp,a$ as Vp,b0 as Rn,b1 as be,b2 as Ue,b3 as We,b4 as wr,b5 as sa,b6 as Me,b7 as za,b8 as zn,b9 as Mn,ba as Qt,bb as Na,bc as Ta,bd as Er,be as ln,bf as Rr,bg as Ap,bh as Ql,bi as ha,bj as zp,bk as Gn,bl as Np,bm as $p,bn as jl,bo as jt,bp as Nn,bq as oa,br as xi,bs as Di,bt as Op,bu as Qp,bv as jp,bw as $a,bx as qp,by as Bp,bz as ot,bA as Up,bB as lt,bC as Fn,bD as Xn,bE as qt,bF as Bt,bG as $n,bH as Hp,bI as Gp,bJ as rn,bK as Kn,bL as Oa,bM as ql,bN as Mr,bO as Bl,bP as Wp,bQ as Jp,bR as Zp,bS as Ul,bT as Vr,bU as Ar,bV as zr,bW as Xe,bX as Nr,bY as $r,bZ as Tl,b_ as Xp,b$ as Hl,c0 as Gl,c1 as Or,c2 as Yp,c3 as eg,c4 as ng,c5 as Wl,c6 as ag,c7 as tg,c8 as Jl,c9 as lg,ca as Qr,cb as ig,cc as rg,cd as sg,ce as og,cf as dg,cg,ch as ug,ci as Ut,cj as mg,ck as pg,cl as jr,cm as qr,cn as _i,co as gg,cp as _n,cq as On,cr as Zl,cs as Br,ct as Ur,cu as Li,cv as wi,cw as yg,cx as fg,cy as H,cz as Hr,cA as Ht,cB as Gt,cC as Qa,cD as Gr,cE as ja,cF as qa,cG as Wr,cH as Qn,cI as Wt,cJ as hg,cK as kg,cL as bg,cM as Sg,cN as vg,cO as Cg,cP as Fg,cQ as ba,cR as Jr,cS as Kg,cT as Tg,cU as Ei,cV as Pg,cW as Ig,cX as xg,cY as Dg,cZ as _g,c_ as Lg,c$ as Zr,d0 as wg,d1 as Eg,d2 as Rg,d3 as Mg,d4 as Sa,d5 as Xl,d6 as Xr,d7 as _a,d8 as Jt,d9 as Yr,da as es,db as cl,dc as Vg,dd as ns,de as Ag,df as Yl,dg as Zt,dh as hn,di as zg,dj as as,dk as Ng,dl as $g,dm as ts,dn as ls,dp as Og,dq as Qg,dr as is,ds as na,dt as jg,du as qg,dv as Ri,dw as Bg,dx as Ug,dy as Hg,dz as Gg,dA as Wg,dB as ul,dC as Jg,dD as wa,dE as Zg,dF as Xg,dG as Yg,dH as ey,dI as Xt,dJ as rs,dK as Mi,dL as ny,dM as ay,dN as ty,dO as ly,dP as ss,dQ as os,dR as iy,dS as ry,dT as sy,dU as Vi,dV as Ai}from"./components-QHKgM10W.js";import{g as da,i as ca,d as oy,E as ds,R as ua,k as ei,b as dy,p as yt,n as cs}from"./vendor-codemirror-DvimrGxD.js";import{P as us,C as ms,T as jn,a as ps,R as qn,b as ft,X as ma,Y as Tn,c as pa,B as Ra,A as dt,d as gs,e as ni,L as ys,f as cy}from"./vendor-recharts-DuSQBcYW.js";const uy=4,my={user:["user","human"],ai:["assistant","bot","ai"],system:["system"],tool:["tool"]},py="Unable to parse span input messages, expected messages which include a role and content.",gy="Unable to parse span output messages, expected messages which include a role and content.",yy="Unable to parse span output expected output.value to be present.",fy="Unable to parse span attributes, attributes must be valid JSON.",hy="Unable to parse model config, expected llm.model_name to be present.",ky="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",by="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",Sy="Unable to parse tools, expected tools to be an array of valid tools.",vy="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",zi={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GOOGLE:["gemini"]},Yn="TOOL_CHOICE",Ea="tool_choice",Sn="RESPONSE_FORMAT",kn="response_format",Cy=[Yn,Sn],Fy=E.object({tool_call:E.object({id:E.string().optional(),function:E.object({name:E.string(),arguments:E.string()}).partial()}).partial()}).partial(),fs=E.object({[me.message]:E.object({[Qe.role]:E.string(),[Qe.content]:E.union([E.string(),E.array(E.record(E.string(),E.unknown()))]).default(""),[Qe.tool_calls]:E.array(Fy).optional(),[Qe.tool_call_id]:E.string().optional()})}),Ky=E.object({[me.llm]:E.object({[Ae.input_messages]:E.array(fs)})}),Ty=E.object({[me.llm]:E.object({[Ae.output_messages]:E.array(fs)})}),Py=E.object({[me.output]:E.object({value:E.string()})}),hs=Xm()(E.enum(["user","ai","system","tool"])),Iy=E.object({id:E.number(),role:hs,content:E.string().optional(),toolCallId:E.string().optional(),toolCalls:E.array(Ym).optional()}),xy=E.array(Iy),ks=E.lazy(()=>E.record(Rl)),Dy=ks,bs=E.string().transform((n,a)=>{const{json:t}=Ve(n);if(!Ml(t))return a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER;const{success:l,data:i}=Dy.safeParse(t);return l?i:(a.addIssue({code:E.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),E.NEVER)}).default("{}"),_y=E.object({[me.llm]:E.object({[Ae.provider]:E.string().optional(),[Ae.model_name]:E.string()})}),Ss=E.object({[me.llm]:E.object({[Ae.invocation_parameters]:bs})}),Ly=E.object({[me.llm]:E.object({[Ae.invocation_parameters]:bs.pipe(E.object({response_format:ks.optional()}))})}),wy=E.object({url:E.object({full:E.string(),path:E.string().optional()})}),Ey=E.string().transform((n,a)=>{const{json:t}=Ve(n);return t==null||!Ml(t)?(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid JSON object"}),E.NEVER):t}).transform((n,a)=>{const{data:t,success:l}=ep.safeParse(n);return l?t:(a.addIssue({code:E.ZodIssueCode.custom,message:"The tool JSON schema must be a valid tool schema"}),E.NEVER)}),Ry=E.object({[me.llm]:E.object({[Ae.tools]:E.array(E.object({[me.tool]:E.object({[Kt.json_schema]:Ey})}).optional()).optional()}).optional()}).optional(),My=E.lazy(()=>E.object({type:E.literal("json_schema"),json_schema:E.object({name:E.string().describe("The name of the schema"),schema:np.describe("The schema itself in JSON schema format"),strict:E.literal(!0).describe("The schema must be strict")})})),Vy=xt(My,{removeAdditionalStrategy:"passthrough"}),Ay=E.string().transform((n,a)=>{const{json:t}=Ve(n);return ea(t)?Object.entries(t).reduce((i,[r,o])=>{if(typeof o=="string")i[r]=o;else{const{json:d}=Cn(o);d!=null&&(i[r]=d)}return i},{}):(a.addIssue({code:E.ZodIssueCode.custom,message:"The prompt template variables must be a valid JSON object"}),E.NEVER)}),zy=E.object({[me.llm]:E.object({[Ae.prompt_template]:E.object({variables:Ay}).optional()}).optional()}).optional();function vs(n){return hs.safeParse(n).success}function Wn(n){const a=n.toLowerCase();if(vs(a))return a;for(const[t,l]of Object.entries(my))if(l.includes(a))return t;return ap}function Ny({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:t})=>{var i,r,o,d;if(t==null)return null;let l={};if(((i=t.function)==null?void 0:i.arguments)!=null){const{json:c}=Ve(t.function.arguments);ea(c)&&(l=c)}switch(a){case"OPENAI":case"AZURE_OPENAI":return{id:t.id??"",type:"function",function:{name:((r=t.function)==null?void 0:r.name)??"",arguments:l}};case"ANTHROPIC":return{id:t.id??"",type:"tool_use",name:((o=t.function)==null?void 0:o.name)??"",input:l};case"GOOGLE":return{id:t.id??"",function:{name:((d=t.function)==null?void 0:d.name)??"",arguments:l}};default:ve()}}).filter(t=>t!=null)}function Cs({messages:n,provider:a}){return n.map(({message:t})=>({id:Zn(),role:t.tool_call_id!=null?Wn("tool"):Wn(t.role),content:typeof t.content=="string"?t.content:void 0,toolCalls:Ny({provider:a,toolCalls:t.tool_calls}),toolCallId:t.tool_call_id}))}function $y({provider:n,parsedAttributes:a}){var l;const t=Ky.safeParse(a);if(!t.success)return{messageParsingErrors:[py],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=Ss.safeParse(a);if(i){const o=t.data.llm.input_messages,d=(l=r.llm.invocation_parameters)==null?void 0:l.system;typeof d=="string"&&d&&(!o||o[0].message.role!=="system")&&t.data.llm.input_messages.unshift({message:{role:"system",content:d}})}}return{messageParsingErrors:[],messages:Cs({provider:n,messages:t.data.llm.input_messages})}}function Oy({provider:n,parsedAttributes:a}){const t=[],l=Ty.safeParse(a);if(l.success)return{output:Cs({provider:n,messages:l.data.llm.output_messages}),outputParsingErrors:t};t.push(gy);const i=Py.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:t}:(t.push(yy),{output:void 0,outputParsingErrors:t})}function Fs(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"google":return"GOOGLE";case"azure":return"AZURE_OPENAI";default:return null}}function Qy(n){for(const a of Object.keys(zi))if(zi[a].some(l=>n.includes(l)))return a;return Cr}function jy(n){const{success:a,data:t}=_y.safeParse(n);if(a){const l=Fs(t.llm.provider)||Qy(t.llm.model_name),i=qy(n);return{modelConfig:{...Object.fromEntries(Object.entries(i).filter(([r,o])=>o!==null)),modelName:t.llm.model_name,provider:l,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[hy]}}function qy(n){const{success:a,data:t}=wy.safeParse(n);if(a)try{const l=new URL(t.url.full);let i=l;if(t.url.path)try{i=new URL(t.url.full.split(t.url.path)[0])}catch{}return{baseUrl:`${i.origin}${i.pathname}`,endpoint:l.origin,apiVersion:l.searchParams.get("api-version")||null}}catch{}return{baseUrl:null,apiVersion:null,endpoint:null}}function By(n,a=[]){const{success:t,data:l}=Ss.safeParse(n),i=[];return t||i.push(ky),{invocationParameters:ef((l==null?void 0:l.llm.invocation_parameters)??{},a),parsingErrors:i}}function Uy(n){const{success:a,data:t}=Ly.safeParse(n);return a?{responseFormat:t.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[by]}}function Hy(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(t=>(t==null?void 0:t.tool)==null?null:{id:tt(),definition:t.tool.json_schema}).filter(t=>t!=null)}function Gy(n){var l;const{data:a,success:t}=Ry.safeParse(n);return t?((l=a==null?void 0:a.llm)==null?void 0:l.tools)==null?{tools:null,parsingErrors:[]}:{tools:Hy(a),parsingErrors:[]}:{tools:null,parsingErrors:[Sy]}}function Wy(n){var l;const{success:a,data:t}=zy.safeParse(n);return a?((l=t==null?void 0:t.llm)==null?void 0:l.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:t.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[vy]}}function Jy(n){const{instance:a,instanceMessages:t}=vr(),l={...a,template:{__type:"chat",messages:Object.values(t)}},{json:i,parseError:r}=Ve(n.attributes);if(r)return{playgroundInstance:{...l,spanId:(n==null?void 0:n.id)??null},parsingErrors:[fy]};const o=n.invocationParameters,d=jy(i);let{modelConfig:c}=d;const{parsingErrors:p}=d,{messages:f,messageParsingErrors:u}=$y({provider:(c==null?void 0:c.provider)??l.model.provider,parsedAttributes:i}),{output:g,outputParsingErrors:y}=Oy({provider:(c==null?void 0:c.provider)??l.model.provider,parsedAttributes:i}),{invocationParameters:k,parsingErrors:b}=By(i,o),{variables:S,parsingErrors:K}=Wy(i),{parsingErrors:T}=Uy(i);c=c!=null?{...c,invocationParameters:T.length>0?k.filter(_=>_.invocationName!==kn&&_.canonicalName!==Sn):k}:null;const{tools:D,parsingErrors:w}=Gy(i),P=f==null?void 0:f.map(_=>({..._,content:_.role==="tool"?ai(_.content):_.content}));return{playgroundInstance:{...l,model:c??l.model,template:P!=null?{__type:"chat",messages:P}:l.template,output:g,spanId:n.id,tools:D??l.tools},playgroundInput:S!=null?{variablesValueCache:S}:void 0,parsingErrors:[...u,...y,...p,...w,...b,...T,...K]}}const Zy=n=>xy.safeParse(n).success,Ks=({instance:n,templateFormat:a})=>{if(a==en.NONE)return[];const t=new Set,l=n.template.__type,i=tp(a);switch(l){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(d=>{t.add(d)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(o=>{t.add(o)});break}default:ve()}return Array.from(t)},Xy=({instances:n,templateFormat:a})=>a==en.NONE?[]:Array.from(new Set(n.flatMap(t=>Ks({instance:t,templateFormat:a})))),Ts=({instances:n,templateFormat:a,input:t})=>{if(a==en.NONE)return{variablesMap:{},variableKeys:[]};const l=Xy({instances:n,templateFormat:a}),i=t.variablesValueCache??{};return{variablesMap:l.reduce((o,d)=>(o[d]=i[d]||"",o),{}),variableKeys:l}};function aa(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const Yy=(n,a)=>n.filter(t=>a.some(l=>aa(l,t))).map(t=>{var l;return{...t,invocationName:((l=a.find(i=>aa(i,t)))==null?void 0:l.invocationName)??t.invocationName}}),Ba=n=>n.replace(/_([a-z])/g,(a,t)=>t.toUpperCase()),ef=(n,a)=>Object.entries(n).map(([t,l])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===t.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===t.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[Ba(i.invocationInputField)]:l}}).filter(t=>t!=null),Ps=n=>{const{provider:a,validatedToolDefinition:t}=rp(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return t.function.name;case"ANTHROPIC":return t.name;case"UNKNOWN":return null;default:ve()}},nf=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return{id:tt(),definition:Ii(a)};case"ANTHROPIC":return{id:tt(),definition:ip(a)};case"GOOGLE":return{id:tt(),definition:Ii(a)};default:ve()}},af=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return Pi();case"ANTHROPIC":return lp();case"GOOGLE":return Pi();default:ve()}};function tf(n){return{content:n.content,role:lf(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function lf(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:ve()}}const Is=({playgroundStore:n,instanceId:a,credentials:t})=>{var u;const{instances:l,allInstanceMessages:i}=n.getState(),r=l.find(g=>g.id===a);if(!r)throw new Error(`No instance found for id ${a}`);if(r.template.__type!=="chat")throw new Error("We only support chat templates for now");const o=r.template.messageIds.map(g=>i[g]).filter(g=>g!=null),d=r.model.supportedInvocationParameters;let c=[...r.model.invocationParameters];const p=Vl({toolChoice:r.toolChoice,targetProvider:r.model.provider});r.tools.length>0?(c=c.filter(g=>g.invocationName!==Ea&&g.canonicalName!==Yn),c.push({canonicalName:Yn,invocationName:Ea,valueJson:p})):c=c.filter(g=>g.invocationName!==Ea&&g.canonicalName!==Yn),c=d.length?Yy(c,d):c;const f=r.model.provider==="AZURE_OPENAI"?{endpoint:r.model.endpoint,apiVersion:r.model.apiVersion}:{};return{messages:o.map(tf),model:{providerKey:r.model.provider,name:r.model.modelName||"",baseUrl:r.model.baseUrl,...f},invocationParameters:Ds(c,r.model.provider,r.model.modelName),tools:r.tools.length?r.tools.map(g=>g.definition):void 0,apiKey:t[r.model.provider]||null,promptName:(u=r.prompt)==null?void 0:u.name}},Yt=(n,a)=>{if(n.template.__type==="chat"){const{messageIds:t,...l}=n.template;return{...n,template:{...l,messages:n.template.messageIds.map(i=>a[i])}}}return n},rf=({playgroundStore:n,instanceId:a,credentials:t})=>{const l=Is({playgroundStore:n,instanceId:a,credentials:t}),{instances:i,templateFormat:r,input:o,allInstanceMessages:d}=n.getState(),c=i.map(f=>Yt(f,d)),{variablesMap:p}=Ts({instances:c,input:o,templateFormat:r});return{...l,template:{variables:p,format:r}}},Ni=({playgroundStore:n,instanceId:a,credentials:t,datasetId:l})=>({...Is({playgroundStore:n,instanceId:a,credentials:t}),templateFormat:n.getState().templateFormat,datasetId:l});function ai(n){if(typeof n=="string"){const a=n.startsWith('"{')||n.startsWith('"[')||n.startsWith('"\\"');try{if(a){const l=JSON.parse(n),i=typeof l=="string"?JSON.parse(l):l;return JSON.stringify(i,null,2)}}catch{}if(/^\s*[0-9{[]|true|false|null/.test(n))return n}return JSON.stringify(n,null,2)}function xs(n,a){return a.filter(t=>t.required).every(t=>n.some(l=>aa(l,t)))}const sf=n=>{for(const[a,t]of Object.entries(n))if(a.endsWith("DefaultValue")&&t!=null)return n[a]};function WC(n,a){const t=new Map(n.map(l=>[l.invocationName,l]));return a.forEach(l=>{var c;const i=l.invocationName,r=sf(l),o=Ba(l.invocationInputField||"");if(!l.invocationName||!l.invocationInputField||!i||r==null||((c=t.get(i))==null?void 0:c[o])!=null)return;const d={canonicalName:l.canonicalName,invocationName:l.invocationName,[o]:r};t.set(i,d)}),Array.from(t.values())}const of=E.object({type:E.literal("enabled")}).passthrough(),df=E.object({type:E.enum(["any","tool"])}).passthrough(),cf=(n,a)=>{if(!a)return n;const t=n.some(l=>l.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&l.valueJson&&of.safeParse(l.valueJson).success);return n.filter(l=>{if(l.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&!l.valueJson)return!1;if(t){if(l.canonicalName==="TEMPERATURE"||l.canonicalName==="TOP_P")return!1;if(l.canonicalName===Yn)return!df.safeParse(l.valueJson).success}return!0})},Ds=(n,a,t)=>a==="ANTHROPIC"?cf(n,t):n,_s=m.createContext(null);function JC({children:n,...a}){const[t]=m.useState(()=>sp(a));return e(_s.Provider,{value:t,children:n})}function Ma(n,a){const t=pe.useContext(_s);if(!t)throw new Error("Missing CredentialsContext.Provider in the tree");return ut(t,n,a)}const Ls=m.createContext(null);function uf(){const n=m.useContext(Ls);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function ZC(n){return e(Ls.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}const ws={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GenerativeProvidersCard_data",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};ws.hash="0168d590171b96e7a2e41449a41754be";function mf({query:n}){const[a,t]=m.useState(null),l=Ma(f=>f),i=Ma(f=>f.setCredential),r=x.useFragment(ws,n),o=m.useMemo(()=>[...r.modelProviders],[r]),d=m.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:f})=>s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(At,{provider:f.original.key,height:18}),f.original.name]})},{header:"Environment Variable",accessorKey:"apiKeyEnvVar",cell:({row:f})=>e(v,{children:f.original.apiKeyEnvVar})},{header:"configuration",accessorKey:"apiKeySet",cell:({row:f})=>f.original.dependenciesInstalled?l[f.original.key]?e(v,{color:"success",children:"local"}):f.original.apiKeySet?e(v,{color:"success",children:"configured on the server"}):e(v,{color:"text-700",children:"not configured"}):e(v,{color:"warning",children:"missing dependencies"})},{header:"",accessorKey:"id",cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",gap:"size-100",width:"100%",children:e(M,{size:"S",leadingVisual:e(L,{svg:e(gt,{})}),onPress:()=>{t(f.original)}})})}],[l]),c=Le({columns:d,data:o,getCoreRowModel:we(),getSortedRowModel:Pn()}),p=c.getRowModel().rows;return s(q,{title:"AI Providers",bodyStyle:{padding:0},variant:"compact",children:[s("table",{css:sn,children:[e("thead",{children:c.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(u=>e("th",{colSpan:u.colSpan,children:u.isPlaceholder?null:e("div",{children:Z(u.column.columnDef.header,u.getContext())})},u.id))},f.id))}),e("tbody",{children:p.map(f=>e("tr",{children:f.getVisibleCells().map(u=>e("td",{children:Z(u.column.columnDef.cell,u.getContext())},u.id))},f.id))})]}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>t(null),children:a&&s(X,{title:`Set ${a.name} API Key`,size:"S",children:[s(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:s(v,{size:"XS",children:["Set the credentials for the ",a.name," API. These credentials will be stored entirely in your browser and will only be sent to the server during API requests."]})}),s(Y,{onChange:f=>{i({provider:a.key,value:f})},value:l[a.key],type:"password",children:[e(J,{children:`${a.name} API Key`}),e(se,{placeholder:`e.g. ${a.apiKeyEnvVar}`}),e(v,{slot:"description",children:"The API key will be stored locally in your browser"})]})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(M,{variant:"primary",size:"S",onPress:()=>{t(null)},children:"Set API Key"})})})]})})]})}function XC(){const n=qe();return Je(n),e(mf,{query:n})}const Es={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsAIProvidersPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"GenerativeProvidersCard_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsAIProvidersPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null}]},params:{cacheID:"cc6e19e54ea894e905970362ee382e43",id:null,metadata:{},name:"settingsAIProvidersPageLoaderQuery",operationKind:"query",text:`query settingsAIProvidersPageLoaderQuery {
  ...GenerativeProvidersCard_data
}

fragment GenerativeProvidersCard_data on Query {
  modelProviders {
    name
    key
    dependenciesInstalled
    dependencies
    apiKeyEnvVar
    apiKeySet
  }
}
`}};Es.hash="2c8eecb8897f8c7dadfdc3de4e2a41a8";async function YC(){return await x.fetchQuery(Fe,Es,{}).toPromise()}const Rs=function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},t={defaultValue:null,kind:"LocalArgument",name:"name"},l=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},o],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],storageKey:null},o],storageKey:null}]},params:{cacheID:"799e8f0a627c6ae06e2a87c051d299d0",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}}}();Rs.hash="a6f84fa9e14f363d2e7317d3d6507590";const Ms=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[n,a,t,l,i],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,t,l,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a8cfba9eaaac34bc497efaacbff45c05",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();Ms.hash="ad967afd45af0d5976982c70eaadb330";const Vs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();Vs.hash="55ab8200b5bfda0aa73594ad5cfce96f";const As={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}]},params:{cacheID:"94e06b8cd5879701a5d73bee083ad614",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}};As.hash="de0fc04de739f0adfcbdeaff28b16265";const zs={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:As}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};zs.hash="de0fc04de739f0adfcbdeaff28b16265";function pf({query:n}){const[a,t]=x.useRefetchableFragment(zs,n),l=Pe(),i=he(),[r]=x.useMutation(Vs),o=m.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),m.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:y=>{const k=De(y);l({title:"Error deleting system key",message:(k==null?void 0:k[0])??y.message})}})},[r,l,i,t]),d=m.useMemo(()=>[...a.systemApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Ee},{header:"Created At",accessorKey:"createdAt",cell:Re},{header:"Expires At",accessorKey:"expiresAt",cell:Re},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Al,{handleDelete:()=>{o(y.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=Le({columns:c,data:d,getCoreRowModel:we()}),f=p.getRowModel().rows,u=p.getRowModel().rows.length===0;return s("table",{css:sn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:s("div",{className:y.column.getCanSort()?"cursor-pointer":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[Z(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(L,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},y.id))},g.id))}),u?e(cn,{message:"No Keys"}):e("tbody",{children:f.map(g=>e("tr",{children:g.getVisibleCells().map(y=>e("td",{children:Z(y.column.columnDef.cell,y.getContext())},y.id))},g.id))})]})}const Ns=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();Ns.hash="9b1d898d1d9858016bed85000ce3906e";const $s={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"e70d413b072841dff8565a332590a549",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}};$s.hash="c2b3a579bcb0ba915523ecb35cae3b44";const Os={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:$s}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Os.hash="c2b3a579bcb0ba915523ecb35cae3b44";const $i=70;function gf({query:n}){const[a,t]=x.useRefetchableFragment(Os,n),l=Pe(),i=he(),[r]=x.useMutation(Ns),o=m.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),m.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:y=>{const k=De(y);l({title:"Error deleting user key",message:(k==null?void 0:k[0])??y.message})}})},[r,l,i,t]),d=m.useMemo(()=>[...a.userApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Ee},{header:"Description",accessorKey:"description",cell:Ee},{header:"Created At",accessorKey:"createdAt",size:$i,cell:Re},{header:"Expires At",accessorKey:"expiresAt",size:$i,cell:Re},{header:"User",size:120,accessorKey:"user.email",cell:Ee},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Al,{handleDelete:()=>{o(y.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=Le({columns:c,data:d,getCoreRowModel:we()}),f=p.getRowModel().rows,u=p.getRowModel().rows.length===0;return s("table",{css:sn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:s("div",{className:y.column.getCanSort()?"cursor-pointer":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[Z(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(L,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},y.id))},g.id))}),u?e(cn,{message:"No Keys"}):e("tbody",{children:f.map(g=>e("tr",{children:g.getVisibleCells().map(y=>e("td",{children:Z(y.column.columnDef.cell,y.getContext())},y.id))},g.id))})]})}function yf(){const n=x.useLazyLoadQuery(Ms,{},{fetchPolicy:"network-only"});return s(Ge,{children:[s(He,{children:[e(ne,{id:"system",children:"System Keys"}),e(ne,{id:"user",children:"User Keys"})]}),e(de,{id:"system",children:e(pf,{query:n})}),e(de,{id:"user",children:e(gf,{query:n})})]})}function ff(){const[n,a]=m.useState(null),t=Pe(),l=c=>{a(e(Fr,{jwt:c}))},[i,r]=x.useMutation(Rs),o=m.useCallback(c=>{var p;i({variables:{...c,expiresAt:((p=c.expiresAt)==null?void 0:p.toDate(xl()).toISOString())||null},onCompleted:f=>{l(f.createSystemApiKey.jwt)},onError:f=>{t({title:"Error creating system key",message:f.message})}})},[i,t]);return s("div",{children:[e(_l,{title:"API Keys",variant:"compact",extra:e(M,{size:"S",leadingVisual:e(L,{svg:e(Dn,{})}),onPress:()=>{a(e(Kr,{onSubmit:o,isCommitting:r,defaultName:"System"}))},children:"System Key"}),children:e(m.Suspense,{fallback:e(C,{padding:"size-100",children:e(Ce,{})}),children:e(yf,{})})}),e(ae,{onDismiss:()=>{a(null)},children:n})]})}const Qs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DBUsagePieChart_data",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}],type:"Query",abstractKey:null};Qs.hash="922bf6de312a4be0c38025ffbb868d6d";function js(n,a){const{si:t=!1,decimalPlaces:l=1}={},i=t?1e3:1024;if(Math.abs(n)<i)return n+" B";const r=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=-1;const d=10**l;do n/=i,++o;while(Math.round(Math.abs(n)*d)/d>=i&&o<r.length-1);return n.toFixed(l)+" "+r[o]}const Oi="remaining";function hf({active:n,payload:a}){return n&&a&&a.length?e(An,{children:e(ze,{shape:"square",color:a[0].payload.fill||"transparent",name:a[0].name||"--",value:js(a[0].value||0)})}):null}function kf({query:n}){const a=x.useFragment(Qs,n),t=a.dbTableStats.reduce((r,o)=>r+o.numBytes,0),l=typeof a.dbStorageCapacityBytes=="number"?a.dbStorageCapacityBytes-t:null,i=m.useMemo(()=>{const r=[...a.dbTableStats];return l!==null&&r.push({tableName:Oi,numBytes:l}),r},[a.dbTableStats,l]);return e(qn,{width:"100%",height:245,children:s(ps,{children:[e(us,{data:i,dataKey:"numBytes",nameKey:"tableName",cx:"50%",cy:"50%",innerRadius:70,outerRadius:110,strokeWidth:0,stroke:"transparent",children:i.map((r,o)=>e(ms,{stroke:"0",fill:r.tableName===Oi?"var(--ac-global-color-grey-200)":`${Ci[o%Ci.length]}`},`cell-${o}`))}),e(jn,{content:e(hf,{})}),e("text",{x:"50%",y:"50%",textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-xl)",children:`${typeof a.dbStorageCapacityBytes=="number"?Pt(t/a.dbStorageCapacityBytes*100):js(t)}`}),e("text",{x:"50%",y:"50%",dy:25,textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-s)",children:"Used"}),e("g",{children:e("text",{x:"100%",y:"100%",dx:-80,dy:-2,textAnchor:"right",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:"* approximate"})})]})})}const qs={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"926faf98cad4bc437a919677347e277c",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};qs.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const Bs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"a9bf3794a5355d9d0e0a3acebe7f3809",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
    }
  }
}
`}}}();Bs.hash="97d1aefa41e8831e57b6bb0d1a078a7c";function bf({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:t}){const[l,i]=x.useMutation(Bs),r=m.useCallback(o=>{l({variables:{input:{email:o.email,username:o.username,password:o.password,role:o.role,sendWelcomeEmail:!0}},onCompleted:d=>{n(d.createUser.user.email)},onError:d=>{a(d)}})},[l,n,a]);return e(ae,{onDismiss:t,isDismissable:!0,type:"modal",isKeyboardDismissDisabled:!0,children:e(X,{title:"Add user",children:e(op,{onSubmit:r,isSubmitting:i})})})}const Us={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"d3f85064b63f026a47a8ef139638b933",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};Us.hash="acd5e44c43deb927fea733697593c97d";const Hs={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Us}},name:"UsersTable_users",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Hs.hash="acd5e44c43deb927fea733697593c97d";const Gs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"deleteUsers",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteUserDialogMutation",selections:a},params:{cacheID:"00d3d0f3855e92e529bc446d0f426123",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input)
}
`}}}();Gs.hash="a718ceab0ec0a7d461f6cd5e5b178a1f";function Sf({userId:n,onDeleted:a,onClose:t}){const[l,i]=x.useMutation(Gs),r=he(),o=Pe(),d=m.useCallback(()=>{l({variables:{input:{userIds:[n]}},onCompleted:()=>{r({title:"User deleted",message:"User has been deleted."}),a(),t()},onError:c=>{const p=De(c);o({title:"Failed to delete user",message:(p==null?void 0:p[0])??c.message})}})},[l,o,r,t,a,n]);return s(X,{title:"Delete User",isDismissable:!0,onDismiss:t,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:t,children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},isDisabled:i,children:"Delete user"})]})})]})}const Ws=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();Ws.hash="85b22da61ec094c28e97db2759622b69";const Wa=4;function vf({userId:n,onClose:a}){const t=Pe(),l=he(),[i,r]=x.useMutation(Ws),{control:o,handleSubmit:d,formState:{isDirty:c}}=Oe({defaultValues:{newPassword:"",confirmPassword:""}}),p=m.useCallback(f=>{i({variables:{input:{userId:n,newPassword:f.newPassword}},onCompleted:()=>{l({title:"Password reset",message:"Users password has been reset."}),a()},onError:u=>{t({title:"Failed to reset password",message:u.message})}})},[i,t,l,a,n]);return e(X,{title:"Reset Password",isDismissable:!0,onDismiss:a,children:e(tn,{children:s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",children:[e(W,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:Wa,message:`Password must be at least ${Wa} characters`}},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{isInvalid:k,onChange:u,name:f,onBlur:g,value:y.toString(),type:"password",id:"new-password",autoComplete:"new-password",children:[e(J,{children:"New Password"}),e(se,{placeholder:"New password"}),b!=null&&b.message?e(xe,{children:b.message}):s(v,{slot:"description",children:["Password must be at least ",Wa," characters"]})]})}),e(W,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:Wa,message:`Password must be at least ${Wa} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{isInvalid:k,onChange:u,name:f,onBlur:g,value:y.toString(),type:"password",children:[e(J,{children:"Confirm Password"}),e(se,{placeholder:"Repeat new password"}),b!=null&&b.message?e(xe,{children:b.message}):e(v,{slot:"description",children:"Repeat new password to confirm"})]})})]}),e(C,{paddingTop:"size-200",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",type:"submit",isDisabled:r,onPress:()=>d(p)(),children:r?"Resetting...":"Reset Password"})})})]})})})}function Cf(n){return n==="LOCAL"}function Ff(n){const{userId:a,onUserDeleted:t,authMethod:l}=n,[i,r]=m.useState(null),o=m.useCallback(()=>{r(e(Sf,{userId:a,onClose:()=>r(null),onDeleted:()=>{t(),r(null)}}))},[a,t]),d=m.useCallback(()=>{r(e(vf,{userId:a,onClose:()=>r(null)}))},[a]),c=m.useMemo(()=>{const p=e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ye,{})}),e(U,{children:"Delete"})]})},"deleteUser"),f=e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Tr,{})}),e(U,{children:"Reset Password"})]})},"resetPassword"),u=[p];return Cf(l)&&u.push(f),u},[l]);return s("div",{onClick:p=>{p.preventDefault(),p.stopPropagation()},children:[e(xn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:p=>{switch(p){case"deleteUser":o();break;case"resetPassword":d();break}},children:c}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Js=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:a},params:{cacheID:"44e970c967f83a0b7a6bd1cbafc3a936",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();Js.hash="468eff05b42e39b55f9aa5b9a7d2c483";function Kf({userId:n,email:a,currentRole:t,newRole:l,onRoleChanged:i,onClose:r}){const[o,d]=x.useMutation(Js),c=he(),p=Pe(),f=m.useCallback(()=>{o({variables:{input:{userId:n,newRole:l}},onCompleted:()=>{c({title:"Role Changed",message:"Users role has been changed."}),i(),r()},onError:u=>{p({title:"Failed to delete user",message:u.message})}})},[o,l,p,c,r,i,n]);return s(X,{title:"Confirm role change",children:[e(C,{padding:"size-200",children:s(v,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:Cl(t)})," to"," ",e("b",{children:Cl(l)}),"?"]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{onPress:r,size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",onPress:()=>{f()},isDisabled:d,children:"Change role"})]})})]})}const Tf=55,Pf=F`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,If=F`
  height: ${Tf}px;
`,Qi=n=>n.email==="admin@localhost"||n.username==="admin";function xf({query:n}){const[a,t]=m.useState(null),[l,i]=x.useRefetchableFragment(Hs,n),r=m.useMemo(()=>l.users.edges.map(({user:u})=>({id:u.id,email:u.email,username:u.username,profilePictureUrl:u.profilePictureUrl,createdAt:u.createdAt,role:u.role.name,authMethod:u.authMethod})),[l]),o=m.useCallback(()=>{m.startTransition(()=>{i({},{fetchPolicy:"network-only"})})},[i]),d=m.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:u})=>s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(zl,{name:u.original.username,profilePictureUrl:u.original.profilePictureUrl,size:20}),e("span",{children:u.original.username}),e("a",{href:`mailto:${u.original.email}`,css:Pf,children:u.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:u})=>u.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:u})=>Qi(u.original)?Cl(u.original.role):e(cp,{includeLabel:!1,onChange:g=>{g!==u.original.role&&t(e(Kf,{onClose:()=>t(null),onRoleChanged:o,currentRole:u.original.role,newRole:g,email:u.original.email,userId:u.original.id}))},role:dp(u.original.role)?u.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:Re},{header:"",accessorKey:"id",size:10,cell:({row:u})=>Qi(u.original)?null:e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Ff,{userId:u.original.id,onUserDeleted:o,authMethod:u.original.authMethod})}),meta:{textAlign:"right"}}],[o]),c=Le({columns:d,data:r,getCoreRowModel:we(),getSortedRowModel:Pn()}),p=c.getRowModel().rows,f=c.getRowModel().rows.length===0;return s("table",{css:sn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},g.id))},u.id))}),f?e(cn,{}):e("tbody",{children:p.map(u=>e("tr",{css:If,children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))}),e(ae,{onDismiss:()=>t(null),isDismissable:!0,type:"modal",children:a})]})}function Df(){const[n,a]=m.useState(0),[t,l]=m.useState(null),i=he(),r=Pe(),o=x.useLazyLoadQuery(qs,{},{fetchKey:n,fetchPolicy:"store-and-network"});return s(q,{title:"Users",variant:"compact",bodyStyle:{padding:0,overflowX:"auto"},extra:e(M,{onPress:()=>{l(e(bf,{onDismiss:()=>{l(null)},onNewUserCreated:d=>{l(null),i({title:"User added",message:`User ${d} has been added.`}),a(c=>c+1)},onNewUserCreationError:d=>{const c=De(d);r({title:"Error adding user",message:(c==null?void 0:c[0])??d.message})}}))},size:"S",leadingVisual:e(L,{svg:e(Dn,{})}),children:"Add User"}),children:[e(m.Suspense,{fallback:e(C,{padding:"size-200",children:e(Ce,{})}),children:e(xf,{query:o})}),e(ae,{onDismiss:()=>{l(null)},children:t})]})}const _f=F`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
`;function e2(){const n=qe();return Je(n),s(h,{direction:"column",gap:"size-200",width:"100%",children:[s(h,{direction:"row",gap:"size-200",alignItems:"baseline",children:[e(C,{flex:"2",children:e(q,{title:"Platform Settings",variant:"compact",children:s("form",{css:_f,children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(Y,{value:Fl,isReadOnly:!0,children:[e(J,{children:"Hostname"}),e(se,{}),e(v,{slot:"description",children:"Connect to Phoenix over HTTP"})]}),e(ji,{text:Fl})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(Y,{value:St,isReadOnly:!0,children:[e(J,{children:"Platform Version"}),e(se,{}),e(v,{slot:"description",children:"The version of the Phoenix server"})]}),e(ji,{text:St})]}),s(h,{direction:"row",gap:"size-100",alignItems:"start",children:[s(Y,{value:`pip install 'arize-phoenix==${St}'`,isReadOnly:!0,children:[e(J,{children:"Python Version"}),e(se,{}),e(v,{slot:"description",children:"The version of the Python client library to use to connect to this Phoenix"})]}),e(C,{flex:"none",paddingTop:"size-300",children:e(ce,{size:"M",text:St})})]})]})})}),e(C,{flex:"1",minWidth:280,children:e(q,{title:"Database Usage",variant:"compact",children:e(kf,{query:n})})})]}),e(Pr,{children:s(U,{children:[e(ff,{}),e(Df,{})]})})]})}function ji(n){return e(C,{paddingBottom:"20px",flex:"none",children:e(ce,{text:n.text,size:"M"})})}const Lf=F`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,wf=F`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
  padding-left: var(--px-nav-collapsed-width);
`,Ef=F`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,Rf=F`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,Mf=F`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function n2(){return s("div",{css:Lf,"data-testid":"layout",children:[e(Vf,{}),s("div",{css:wf,children:[e(mp,{children:e(up,{})}),e("div",{"data-testid":"content",css:Ef,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Ke,{})})})]})]})}function Vf(){const n=m.useMemo(()=>window.Config.hasInferences,[]),a=Pe(),{authenticationEnabled:t}=uf(),l=ue(),i=m.useCallback(async()=>{const r=await fetch(un("/auth/logout"),{method:"POST"});if(r.ok){l("/login");return}a({title:"Logout Failed",message:"Failed to log out: "+r.statusText})},[l,a]);return s(vp,{children:[e(pp,{}),s(h,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[s("ul",{css:Mf,children:[n&&e("li",{children:e(wn,{to:"/model",text:"Model",leadingVisual:e(L,{svg:e(gp,{})})})}),e("li",{children:e(wn,{to:"/projects",text:"Projects",leadingVisual:e(L,{svg:e(Ir,{})})})}),e("li",{children:e(wn,{to:"/datasets",text:"Datasets",leadingVisual:e(L,{svg:e(zt,{})})})}),e("li",{children:e(wn,{to:"/playground",text:"Playground",leadingVisual:e(L,{svg:e(Ka,{})})})}),e("li",{children:e(wn,{to:"/prompts",text:"Prompts",leadingVisual:e(L,{svg:e(Nl,{})})})}),e("li",{children:e(wn,{to:"/apis",text:"APIs",leadingVisual:e(L,{svg:e($l,{})})})})]}),s("ul",{css:Rf,children:[e("li",{children:e(wn,{to:"/settings/general",text:"Settings",leadingVisual:e(L,{svg:e(xr,{})})})}),e("li",{children:e(yp,{})}),e("li",{children:e(wn,{to:"/support",text:"Support",leadingVisual:e(L,{svg:e(fp,{})})})}),e("li",{children:e(hp,{})}),t&&s(U,{children:[e("li",{children:e(wn,{to:"/profile",text:"Profile",leadingVisual:e(L,{svg:e(kp,{})})})}),e("li",{children:e(bp,{text:"Log Out",leadingVisual:e(L,{svg:e(Sp,{})}),onClick:i})})]})]})]})]})}const Zs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"73f41a4d1a52207ec36287e8c6c527cc",id:null,metadata:{},name:"ProjectConfigPageProjectConfigCardQuery",operationKind:"query",text:`query ProjectConfigPageProjectConfigCardQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ProjectConfigPage_projectConfigCard
    __isNode: __typename
    id
  }
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}
`}}}();Zs.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const Xs={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Zs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectConfigPage_projectConfigCard",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null};Xs.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const Af=["traces","spans","sessions"],ti=30,Ys=n=>Af.includes(n),eo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"92a104050258aeb9404066cf783b1888",id:null,metadata:{},name:"ProjectPageQueriesProjectConfigQuery",operationKind:"query",text:`query ProjectPageQueriesProjectConfigQuery(
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ...ProjectConfigPage_projectConfigCard
    __isNode: __typename
    id
  }
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}
`}}}();eo.hash="fe300a92a7895152ba48a9cf2ed207ee";const no=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:i,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e0aa57c32efe05d9b7824e47dfe9ffd",id:null,metadata:{},name:"ProjectPageQueriesSessionsQuery",operationKind:"query",text:`query ProjectPageQueriesSessionsQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions on Project {
  name
  sessions(first: 30, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();no.hash="7d7d389710762ff32a681c9e34ea9c60";const ao=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d=[{kind:"Literal",name:"first",value:30},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},r,{kind:"InlineFragment",selections:[o,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:d,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:d,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"05f5f4fe0a7acdcdf65c5f56c7eb693a",id:null,metadata:{},name:"ProjectPageQueriesSpansQuery",operationKind:"query",text:`query ProjectPageQueriesSpansQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
  $orphanSpanAsRootSpan: Boolean!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();ao.hash="a5fa32795ad28b109d44f7d21b18afa0";const to=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],o={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},f=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],u={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:f,storageKey:null},g={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:f,storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},b={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},S={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,o,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},d,c,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},p,u,g,y,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,k,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},b,S,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,o,i,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},d,c,p,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},u,g,y,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,k],storageKey:null},b,S],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:r,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"64916c7696b304920074bd5ab383b8a0",id:null,metadata:{},name:"ProjectPageQueriesTracesQuery",operationKind:"query",text:`query ProjectPageQueriesTracesQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              cumulativeTokenCountPrompt: tokenCountPrompt
              cumulativeTokenCountCompletion: tokenCountCompletion
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
              }
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();to.hash="115733d83356cd8ac9fd611fe725d41a";const lo=to,io=ao,ro=no,so=eo,oo=m.createContext({spansQueryReference:null,sessionsQueryReference:null,tracesQueryReference:null,projectConfigQueryReference:null}),el=()=>{const n=m.useContext(oo);if(!n)throw new Error("ProjectPageQueryReferenceContext not found");return n},zf=F`
  overflow-y: auto;
`,Nf=F`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,$f=F`
  width: 75px;
  height: 75px;
  flex: none;
  border-radius: 50%;
  margin-top: var(--ac-global-dimension-size-100);
`,a2=()=>{const{projectConfigQueryReference:n}=el();return n?e("main",{css:zf,children:e("div",{css:Nf,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Of,{project:n})})})}):null},Of=({project:n})=>{const a=x.usePreloadedQuery(so,n);return e(h,{direction:"column",gap:"size-200",children:e(Qf,{project:a.project})})},Qf=({project:n})=>{const[a]=x.useRefetchableFragment(Xs,n),{defaultTab:t,setDefaultTab:l}=rt(i=>({defaultTab:i.defaultTab,setDefaultTab:i.setDefaultTab}));return e(q,{title:"Project Settings",variant:"compact",children:s(h,{direction:"row",gap:"size-200",children:[e("div",{css:[$f,{background:`linear-gradient(136.27deg, ${a.gradientStartColor} 14.03%, ${a.gradientEndColor} 84.38%)`}]}),e("div",{css:F`
            width: 100%;
            .ac-dropdown,
            .ac-dropdown-button {
              width: 100%;
            }
          `,children:s(h,{direction:"column",gap:"size-100",width:"100%",children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[s(Y,{value:a.name,isReadOnly:!0,css:F`
                  width: 100%;
                `,children:[e(J,{children:"Project Name"}),e(se,{})]}),e(ce,{text:a.name,size:"M"})]}),s(Lt,{label:"Default Project Tab",selectedKey:t,onSelectionChange:i=>{typeof i=="string"&&Ys(i)&&l(i)},size:"default",placeholder:"Select a default tab",children:[e(ie,{children:"Spans"},"spans"),e(ie,{children:"Traces"},"traces"),e(ie,{children:"Sessions"},"sessions")]})]})})]})})};function t2(){const{projectId:n}=Be();return Je(n),e(Cp,{projectId:n,children:e(Ke,{})})}const co=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"3b99248824fdc64b0a16632d83801a44",id:null,metadata:{},name:"promptConfigLoaderQuery",operationKind:"query",text:`query promptConfigLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      ...PromptVersionTagsConfigCard_data
    }
    __isNode: __typename
    id
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();co.hash="2dcab1077c1d7e48736d23d95ce22331";const l2=async({params:n})=>{const a=n.promptId;if(!a)throw new Error("Prompt ID is required");return await x.fetchQuery(Fe,co,{id:a}).toPromise()},uo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__aside",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLatestVersionsListFragment"},{args:null,kind:"FragmentSpread",name:"EditPromptButton_data"}],type:"Prompt",abstractKey:null};uo.hash="a77263d84d9add47173ed2e3d0243952";const mo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptIndexPage__aside"}],type:"Prompt",abstractKey:null};mo.hash="a883b83f574448623a2b02a60d899d41";const po={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptModelConfigurationCard__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLLM__main"},{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptTools__main"},{args:null,kind:"FragmentSpread",name:"PromptResponseFormatFragment"}],type:"PromptVersion",abstractKey:null};po.hash="1c4202299f1f881250b17b75244fac54";const go={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptInvocationParameters__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null}],type:"PromptVersion",abstractKey:null};go.hash="4f00ab4f0396fffb81a1b068e544cfcf";function jf({keyName:n,value:a}){const{json:t,stringifyError:l}=Cn(a);return l?null:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:t})]})})}function qf({promptVersion:n}){const{invocationParameters:a}=x.useFragment(go,n),t=m.useMemo(()=>km(a)?Object.entries(a).map(([l,i])=>({key:l,value:i})):[],[a]);return t.length===0?e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No parameters saved for this prompt"})})}):e(Et,{listSize:"small",children:t.map(({key:l,value:i},r)=>e(wt,{children:e(jf,{keyName:l,value:i})},`${l}-${r}`))})}const yo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLLM__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null}],type:"PromptVersion",abstractKey:null};yo.hash="acc90da43126218472d2fc19cd8d0512";const qi=({keyName:n,children:a})=>e(wt,{listSize:"small",children:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:a})]})})});function Bf({promptVersion:n}){const a=x.useFragment(yo,n);return s(fe,{id:"llm",children:[e(ge,{children:"LLM"}),e(ye,{children:s(Et,{listSize:"small",children:[e(qi,{keyName:"Model",children:a.model}),e(qi,{keyName:"Provider",children:Kl[a.provider]??a.provider})]})})]})}const fo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptResponseFormatFragment",selections:[{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};fo.hash="154d745ec5e978e0dfc811ebfb9faa8c";function Uf({promptVersion:n}){const{responseFormat:a}=x.useFragment(fo,n),t=m.useMemo(()=>typeof(a==null?void 0:a.definition)=="string"?Cn(Ve(a==null?void 0:a.definition).json||"",null,2).json||"":Cn(a==null?void 0:a.definition,null,2).json||"",[a==null?void 0:a.definition]);return t?s(fe,{id:"response-format",children:[e(ge,{children:"Response Format"}),e(ye,{children:e(nn,{value:t})})]}):s(fe,{id:"response-format",children:[e(ge,{children:"Response Format"}),e(ye,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No response format specified for this prompt"})})})})]})}const ho={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptTools__main",selections:[{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};ho.hash="aa512d962d83a58b70ae0e17f01242b3";function Hf({promptVersion:n}){const{tools:a}=x.useFragment(ho,n),t=m.useMemo(()=>a.map((l,i)=>{const r=l.definition;return{name:Kp(r)||`Tool ${i+1}`,description:Fp(r)||void 0,definition:Cn(r,null,2).json||"{}"}}),[a]);return t.length===0?s(fe,{id:"tools",children:[e(ge,{children:"Tools"}),e(ye,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No tools specified for this prompt"})})})})]}):s(h,{direction:"column",children:[e(Tp,{bordered:!1,children:"Tools"}),e(gn,{css:F`
          & {
            > .ac-disclosure:last-child {
              &[data-expanded="true"] {
                border-bottom: 1px solid var(--ac-global-border-color-default);
              }
            }
          }
        `,children:t.map((l,i)=>s(fe,{id:`tool-${i}`,children:[s(ge,{arrowPosition:"start",justifyContent:"space-between",children:[e(v,{children:l.name}),e(v,{children:l.description})]}),e(ye,{children:e(nn,{value:l.definition})})]},`${l.name}-${i}`))})]})}function ko({promptVersion:n}){const a=x.useFragment(po,n);return e(q,{title:"Model Configuration",variant:"compact",bodyStyle:{padding:0},collapsible:!0,children:s(gn,{defaultExpandedKeys:["llm","invocation-parameters","tools","response-format"],children:[e(Bf,{promptVersion:a}),s(fe,{id:"invocation-parameters",children:[e(ge,{children:"Invocation Parameters"}),e(ye,{children:e(qf,{promptVersion:a})})]}),e(Hf,{promptVersion:a}),e(Uf,{promptVersion:a})]})})}const bo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[r,d,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[r,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},r],storageKey:null}]},params:{cacheID:"a0e00e13cb2441248615b9d8966a918f",id:null,metadata:{},name:"EditPromptButtonPatchPromptMutation",operationKind:"mutation",text:`mutation EditPromptButtonPatchPromptMutation(
  $input: PatchPromptInput!
) {
  patchPrompt(input: $input) {
    ...PromptIndexPage__main
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();bo.hash="3ce25c8fbe5598ec1ee037a9778a6957";const So={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditPromptButton_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],type:"Prompt",abstractKey:null};So.hash="24788aacf7830c0e5037befe576f4968";function Gf(n){const[a,t]=m.useState(!1),l=he(),i=Pe(),r=x.useFragment(So,n.prompt),[o,d]=x.useMutation(bo),{control:c,handleSubmit:p}=Oe({defaultValues:{description:r.description??""}}),f=m.useCallback(u=>{o({variables:{input:{promptId:r.id,description:u.description}},onCompleted:()=>{t(!1),l({title:"Prompt updated",message:"The prompt has been updated successfully"})},onError:g=>{var y;i({title:"Error updating prompt",message:(y=De(g))==null?void 0:y[0]})}})},[r.id,o,i,l]);return s(_t,{isOpen:a,onOpenChange:t,children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(xr,{})}),variant:"quiet","aria-label":"configure prompt",onPress:()=>t(!0)}),e(Dr,{size:"S",isDismissable:!0,children:s(Dt,{children:[e(oe,{slot:"title",children:"Edit Prompt Details"}),s(tn,{children:[e(C,{padding:"size-200",children:e(W,{name:"description",control:c,render:({field:u})=>s(Y,{value:u.value,onChange:u.onChange,children:[e(J,{children:"Prompt Description"}),e(Ca,{placeholder:"Enter a description for the prompt"}),e(v,{slot:"description",children:"A description of the prompt"})]})})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(M,{slot:"close",size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",isDisabled:d,onPress:()=>p(f)(),children:d?"Saving...":"Save"})]})})]})]})})]})}const vo=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptChatMessagesCard__main",selections:[{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[a,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null}],type:"PromptVersion",abstractKey:null}}();vo.hash="e0d9c12926330e5e774cbc64de158a82";const li=E.object({text:E.object({text:E.string()})}),ii=E.object({toolCall:E.object({toolCallId:E.string(),toolCall:E.object({name:E.string(),arguments:E.string()})})}),ri=E.object({toolResult:E.object({toolCallId:E.string(),result:Rl})}),nl=n=>{const a=li.safeParse(n);return a.success?a.data:null},Co=n=>{const a={text:{text:n}},t=li.safeParse(a);return t.success?t.data:null},si=n=>{const a=ii.safeParse(n);return a.success?a.data:null},Fo=n=>{const a=Pp(n),t=Ip(n),l=xp(n);if(!a)return null;const i=Cn(l).json||"",r={toolCall:{toolCallId:a,toolCall:{name:t||a,arguments:i}}},o=ii.safeParse(r);return o.success?o.data:null},oi=n=>{const a=ri.safeParse(n);return a.success?a.data:null},Ko=(n,a)=>{const t={toolResult:{toolCallId:n,result:a}},l=ri.safeParse(t);return l.success?l.data:null};function ht(n){return m.useMemo(()=>{const a=n.toLowerCase();return a==="user"||a==="human"?{backgroundColor:"grey-200",borderColor:"grey-500"}:a==="assistant"||a==="ai"?{backgroundColor:"blue-100",borderColor:"blue-700"}:a==="system"||a==="developer"?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(a)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"}},[n])}const al={text:"Text",toolCall:"Tool Call",toolResult:"Tool Result"},Wf=Object.values(al);function Jf({toolResult:n,isOnlyChild:a}){const t=m.useMemo(()=>{const l=n.toolResult.result;return ai(l)},[n]);return e(di,{title:al.toolResult,isOnlyChild:a,children:s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:s(h,{direction:"column",justifyContent:"start",gap:"size-100",children:[e(v,{weight:"heavy",size:"XS",children:"Tool ID"}),e(C,{paddingX:"size-300",children:e(v,{size:"XS",children:n.toolResult.toolCallId})})]})}),s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:e(v,{weight:"heavy",size:"XS",children:"Tool Result"})}),e(Nt,{readOnly:!0,children:e($t,{readOnly:!0,height:"100%",defaultValue:t,templateFormat:en.NONE})})]})]})})}function Zf({provider:n,toolCall:a,isOnlyChild:t}){const l=m.useMemo(()=>{const i=_r(a,n);return Cn(i,null,2).json||""},[n,a]);return e(di,{title:al.toolCall,isOnlyChild:t,children:e(Nt,{readOnly:!0,children:e($t,{readOnly:!0,height:"100%",defaultValue:l,templateFormat:en.NONE})})})}function Xf(n){const{text:a,templateFormat:t,isOnlyChild:l}=n;return e(di,{title:al.text,isOnlyChild:l,children:e(Nt,{readOnly:!0,children:e($t,{readOnly:!0,height:"100%",defaultValue:a,templateFormat:t})})})}function di({title:n,children:a,isOnlyChild:t}){return t?e(U,{children:a}):s(fe,{id:n,children:[e(ge,{children:e(v,{weight:"heavy",size:"S",children:n})}),e(ye,{children:a})]})}function Yf(n){const{role:a,children:t}=n,l=ht(a);return e(q,{title:a,variant:"compact",...l,bodyStyle:{padding:0},collapsible:!0,children:e(gn,{defaultExpandedKeys:Wf,children:t})})}function eh({promptVersion:n}){const{template:a,templateFormat:t,provider:l}=x.useFragment(vo,n);if(a.__typename==="PromptStringTemplate")return e(v,{children:a.template});if(a.__typename==="PromptChatTemplate")return e(ah,{template:a,templateFormat:t,provider:Fs(l)||Cr});if(a.__typename==="%other")throw new Error("Unknown template type"+a.__typename)}function nh({part:n,templateFormat:a,provider:t,isOnlyChild:l}){let i=nl(n);return i?e(Xf,{text:i.text.text,templateFormat:a,isOnlyChild:l}):(i=si(n),i?e(Zf,{toolCall:i,provider:t,isOnlyChild:l}):(i=oi(n),i?e(Jf,{toolResult:i,isOnlyChild:l}):null))}function ah({template:n,templateFormat:a,provider:t}){const{messages:l}=n;return e(h,{direction:"column",gap:"size-100","data-testid":"chat-messages",children:l.map((i,r)=>{const o=i.content.length===1&&i.content.find(nl)!=null;return e(Yf,{role:i.role,children:i.content.map((d,c)=>e(nh,{part:d,templateFormat:a,provider:t,isOnlyChild:o},`${c}-${d.__typename}`))},r)})})}function To({title:n="Prompt",promptVersion:a}){return e(q,{title:n,variant:"compact",collapsible:!0,"data-testid":"prompt-chat-messages-card",children:e(eh,{promptVersion:a})})}const Po=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptCodeExportCard__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:n,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null}],type:"PromptVersion",abstractKey:null}}();Po.hash="3fa95713c234bb0cfa4c36e8e4f9cea0";const th=E.enum(["system","user","assistant","developer","tool","function"]),tl=E.object({role:th,content:E.string().nullable(),name:E.string().optional(),tool_call_id:E.string().optional(),tool_calls:E.array(Dp).optional()}).passthrough(),lh=E.array(tl);xt(lh,{removeAdditionalStrategy:"passthrough"});const ih=E.enum(["user","assistant","tool"]),rh=_p.extend({type:E.string(),text:E.string().optional(),id:E.string().optional(),tool_use_id:E.string().optional(),name:E.string().optional(),input:E.record(E.unknown()).optional(),source:E.object({type:E.string(),media_type:E.string().optional(),data:E.string().optional()}).optional()}),Io=E.object({role:ih,content:E.union([E.string(),E.array(rh)])}),sh=E.array(Io);xt(sh,{removeAdditionalStrategy:"passthrough"});const oh=E.enum(["SYSTEM","USER","AI","TOOL"]),dh=E.object({image:E.object({url:E.string()})}),ch=E.discriminatedUnion("__typename",[li.extend({__typename:E.literal("TextContentPart")}),dh.extend({__typename:E.literal("ImageContentPart")}),ii.extend({__typename:E.literal("ToolCallContentPart")}),ri.extend({__typename:E.literal("ToolResultContentPart")})]),ll=E.object({role:oh,content:E.array(ch)}).passthrough(),uh=E.array(ll);xt(uh,{removeAdditionalStrategy:"passthrough"});const xo=tl.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{...a,content:[...a.content,...n.tool_calls.map(t=>Lp.parse(t))]}:n.tool_call_id?{...a,content:[{type:"tool_result",tool_use_id:n.tool_call_id,content:n.content}]}:a}),Do=ll.transform(n=>{if(n.role==="TOOL"){const l=n.content.map(i=>oi(i)).find(i=>!!i);if(!l)throw new Error("TOOL role message must have a ToolResultContentPart");return{role:"tool",content:ai(l.toolResult.result),tool_call_id:l.toolResult.toolCallId}}const a={role:{SYSTEM:"system",USER:"user",AI:"assistant",TOOL:"tool"}[n.role],content:n.content.map(l=>nl(l)).filter(l=>!!l).map(l=>l.text.text).join(`
`)},t=n.content.map(l=>si(l)).filter(l=>!!l).map(l=>({id:l.toolCall.toolCallId,type:"function",function:{name:l.toolCall.toolCall.name,arguments:typeof l.toolCall.toolCall.arguments=="string"?JSON.parse(l.toolCall.toolCall.arguments):l.toolCall.toolCall.arguments}}));return t.length>0?{...a,tool_calls:t}:a});tl.transform(n=>{const a=[];if(n.role==="tool"&&n.tool_call_id){const l=Ko(n.tool_call_id,n.content);return l&&a.push({__typename:"ToolResultContentPart",...l}),{role:"TOOL",content:a}}if(n.content){const l=Co(n.content);l&&a.push({__typename:"TextContentPart",...l})}return n.tool_calls&&n.tool_calls.forEach(l=>{const i=Fo({id:l.id,name:l.function.name,arguments:l.function.arguments});i&&a.push({__typename:"ToolCallContentPart",...i})}),{role:{system:"SYSTEM",user:"USER",assistant:"AI",tool:"TOOL",developer:"SYSTEM",function:"TOOL"}[n.role],content:a}});const mh=({message:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":return n;case"ANTHROPIC":return xo.parse(n);case"GOOGLE":return n;default:return ve()}};E.union([tl,Io,ll,Rl]);ll.transform(n=>xo.parse(Do.parse(n)));const bn="  ",vt=({json:n,level:a,removeKeyQuotes:t=!1})=>{const l=bn.repeat(a);let i=JSON.stringify(n,null,bn);return i=i.split(`
`).map((r,o)=>o>0?l+r:r).join(`
`),t&&(i=i.replace(/"([a-zA-Z_$][a-zA-Z0-9_$]*)"\s*:/g,"$1:")),i},ph=mn.template(`
from openai import OpenAI

client = OpenAI()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.chat.completions.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.choices[0].message)
`.trim()),gh=mn.template(`
import OpenAI from "openai";

const openai = new OpenAI();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = openai.chat.completions.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

response.then((completion) => console.log(completion.choices[0].message));
`.trim()),yh=mn.template(`
from openai import OpenAI
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")

# Format the prompt template with the appropriate variables
response = OpenAI().chat.completions.create(**prompt.format(variables={ "variable": "value" }))
print(response.choices[0].message.content)
  `.trim()),fh=mn.template(`
from openai import OpenAI;
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const openai = new OpenAI();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const openAIParams = toSDK({
  prompt,
  sdk: "openai",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await openai.chat.completions.create({
  ...openAIParams,
});

console.log(response.choices[0]?.message.content);
`.trim()),hh=mn.template(`
from anthropic import Anthropic

client = Anthropic()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.messages.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.content)
`.trim()),kh=mn.template(`
import Anthropic from "@anthropic-ai/sdk";

const client = new Anthropic();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = await client.messages.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

console.log(response.content);
`.trim()),bh=mn.template(`
from anthropic import Anthropic
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")
# Format the prompt template with the appropriate variables
resp = Anthropic().messages.create(**prompt.format(variables={ "variable": "value" }))
  `.trim()),Sh=mn.template(`
import Anthropic from "@anthropic-ai/sdk";
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const anthropic = new Anthropic();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const anthropicParams = toSDK({
  prompt,
  sdk: "anthropic",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await anthropic.messages.create({
  ...anthropicParams,
});

console.log(response.content);
`.trim()),Jn={python:{openai:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:ph,clientTemplate:yh},anthropic:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:hh,clientTemplate:bh}},typescript:{openai:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:gh,clientTemplate:fh},anthropic:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:kh,clientTemplate:Sh}}},Ct=(n,a)=>{if(!("messages"in n.template))throw new Error("Prompt template does not contain messages");const t=[],{assignmentOperator:l,removeKeyQuotes:i,stringQuote:r}=a;if(n.modelName&&t.push(`model${l}${r}${n.modelName}${r}`),n.invocationParameters){const d=Object.entries(n.invocationParameters).map(([c,p])=>typeof p=="string"?`${c}${l}${r}${p}${r}`:Ml(p)?`${c}${l}${vt({json:p,level:1,removeKeyQuotes:i})}`:`${c}${l}${p}`);t.push(...d)}let o="";if(n.template.messages.length>0&&(o=vt({json:n.template.messages,level:0,removeKeyQuotes:i}),t.push(l==="="?"messages=messages":"messages")),n.tools&&n.tools.length>0){const d=vt({json:n.tools.map(c=>c.definition),level:1,removeKeyQuotes:i});t.push(`tools${l}${d}`)}if(n.responseFormat&&"definition"in n.responseFormat){const d=vt({json:n.responseFormat.definition,level:1,removeKeyQuotes:i});t.push(`response_format${l}${d}`)}return{args:t,messages:o}},Bi=n=>"tool_calls"in n&&n.tool_calls?{...n,tool_calls:n.tool_calls.map(a=>({...a,function:{...a.function,arguments:JSON.stringify(a.function.arguments)}}))}:n,vh={python:{openai:n=>{const a=Jn.python.openai,t={...n,template:{...n.template,messages:n.template.messages.map(r=>Bi(r))}},{args:l,messages:i}=Ct(t,a);return a.sdkTemplate({tab:bn,args:l,messages:i})},anthropic:n=>{const a=Jn.python.anthropic,{args:t,messages:l}=Ct(n,a);return a.sdkTemplate({tab:bn,args:t,messages:l})}},typescript:{openai:n=>{const a=Jn.typescript.openai,t={...n,template:{...n.template,messages:n.template.messages.map(r=>Bi(r))}},{args:l,messages:i}=Ct(t,a);return a.sdkTemplate({tab:bn,args:l,messages:i})},anthropic:n=>{const a=Jn.typescript.anthropic,{args:t,messages:l}=Ct(n,a);return a.sdkTemplate({tab:bn,args:t,messages:l})}}},Ch={python:{openai:n=>Jn.python.openai.clientTemplate({tab:bn,versionId:n.versionId}),anthropic:n=>Jn.python.openai.clientTemplate({tab:bn,versionId:n.versionId})},typescript:{openai:n=>Jn.typescript.openai.clientTemplate({tab:bn,versionId:n.versionId}),anthropic:n=>Jn.typescript.anthropic.clientTemplate({tab:bn,versionId:n.versionId})}},Fh=({promptVersion:n,language:a})=>{var i;const t=vh[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!t||!("messages"in n.template))return null;const l={...n,template:{...n.template,messages:n.template.messages.map(r=>{try{return mh({message:Do.parse(r),targetProvider:n.modelProvider})}catch(o){return console.warn("Cannot convert message"),console.error(o),null}}).filter(Boolean)}};return t(l)};function Kh({promptVersion:n,language:a}){var i;const t=Ch[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!t)return null;const l={versionId:n.id};return t(l)}function _o({promptVersion:n}){const[a,t]=m.useState("Python"),l=x.useFragment(Po,n),i=m.useMemo(()=>Fh({promptVersion:l,language:a}),[l,a]),r=m.useMemo(()=>Kh({promptVersion:l,language:a}),[l,a]);return e(q,{title:"Code",variant:"compact",bodyStyle:{padding:0},extra:e(h,{gap:"size-100",alignItems:"center",children:e(Ot,{language:a,onChange:t,size:"S"})}),children:s(gn,{defaultExpandedKeys:["sdk-inline","client"],children:[s(fe,{id:"sdk-inline",children:[e(ge,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",width:"100%",children:[e(v,{children:"SDK Inline"}),i?e(ce,{text:i}):null]})}),e(ye,{children:i==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No code snippet available for this prompt"})}):e(Ui,{language:a,value:i})})]}),s(fe,{id:"client",children:[e(ge,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"size-100",children:[e(v,{children:"Using the Client"}),r?e(ce,{text:r}):null]})}),e(ye,{children:r==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No client code snippet available for this prompt"})}):e(Ui,{language:a,value:r})})]})]})})}function Ui({language:n,value:a}){switch(n){case"Python":return e(Lr,{value:a,basicSetup:{lineNumbers:!0}});case"TypeScript":return e(wp,{value:a,basicSetup:{lineNumbers:!0}});default:ve()}}const Lo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLatestVersionsListFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"}],type:"Prompt",abstractKey:null};Lo.hash="a473a6f0d927379542694312449a4c63";const wo=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionSummaryFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],type:"PromptVersion",abstractKey:null}}();wo.hash="80901eff49852a413f643ee876638174";const Eo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsList_data",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};Eo.hash="25265fbc7ea915534615a56b4331236e";function Ro({promptVersion:n}){const a=x.useFragment(Eo,n);return e(h,{direction:"row",gap:"size-50",alignItems:"center",wrap:"wrap",children:a.tags.map(t=>e(Th,{children:t.name},t.id))})}function Th({children:n}){const a=m.useMemo(()=>{switch(n){case"production":return"var(--ac-global-color-green-1000)";case"staging":return"var(--ac-global-color-yellow-1000)";case"development":return"var(--ac-global-color-blue-1000)";default:return"var(--ac-global-color-grey-900)"}},[n]);return e(La,{color:a,children:n})}function Mo(n){const a=x.useFragment(wo,n.promptVersion);return s(h,{direction:"column",gap:"size-50",children:[e(C,{width:"100%",children:e(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(La,{color:"var(--ac-global-color-blue-900)",children:a.sequenceNumber}),e("span",{children:`${a.id}`})]})})}),e(C,{"data-testid":"prompt-version-item-description",paddingStart:"size-400",children:s(h,{direction:"column",gap:"size-100",children:[e(st,{maxWidth:"100%",children:e(v,{color:"text-700",size:"XS",children:a.description||"No Description"})}),s(h,{justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(Ro,{promptVersion:a}),s(h,{direction:"row",gap:"size-100",alignItems:"center",flex:"none",children:[a.user&&s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(zl,{size:14,name:a.user.username,profilePictureUrl:a.user.profilePictureUrl}),e(v,{size:"XS",children:a.user.username})]}),e(v,{color:"text-300",size:"XS",children:bm(a.createdAt,Date.now())})]})]})]})})]})}const Ph=5,Ih=F`
  padding-bottom: var(--ac-global-dimension-size-200);
  position: relative;
`;function xh(n){const{prompt:a}=n,t=x.useFragment(Lo,a),l=m.useMemo(()=>{var i,r;return(r=(i=t==null?void 0:t.latestVersions)==null?void 0:i.edges)==null?void 0:r.map(o=>o.version)},[t]);if(!l)throw new Error("Expected prompt versions to be defined");return s("div",{children:[e("ul",{children:l.map((i,r)=>{const o=r===Ph-1;return s("li",{css:Ih,children:[e(Mo,{promptVersion:i}),i.sequenceNumber!=1?e(_h,{isLastConnector:o}):null]},i.id)})}),e(h,{direction:"row",justifyContent:"end",children:e(Ze,{to:"versions",children:"View all versions"})})]})}const Dh=F`
  position: absolute;
  top: 25px;
  left: 11px;
  height: calc(100% - 32px);
  width: 2px;
  --connector-color: var(--ac-global-color-grey-400);
  background: repeating-linear-gradient(
      to bottom,
      transparent 0 4px,
      var(--ac-global-color-grey-50) 4px 8px
    ),
    var(--connector-color);
  background-size: 4px 100%;
  background-position: 80%;
  background-repeat: no-repeat;
  &[data-last="true"] {
    background: repeating-linear-gradient(
        to bottom,
        transparent 0 4px,
        var(--ac-global-color-grey-50) 4px 8px
      ),
      linear-gradient(to bottom, var(--connector-color), transparent);
  }
`;function _h({isLastConnector:n}){return e("div",{css:Dh,"data-last":n})}const ci=()=>{const a=Sm().find(t=>t.pathname.split("/prompts/").length===2);if(!a)throw new Error("usePromptIdLoader must be used within a /prompts/:promptId route");return vm(a.id)};function i2(){const n=ci();return e(Lh,{prompt:n.prompt})}function Lh({prompt:n}){var l,i,r;const a=x.useFragment(mo,n),t=(r=(i=(l=a==null?void 0:a.promptVersions)==null?void 0:l.edges)==null?void 0:i[0])==null?void 0:r.node;return s(h,{direction:"row",height:"100%",children:[e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:[e(To,{title:"Prompt Template",promptVersion:t}),e(ko,{promptVersion:t}),e(_o,{promptVersion:t})]})})}),e(wh,{prompt:a})]})}function wh({prompt:n}){const a=x.useFragment(uo,n),t=!!(a!=null&&a.description);return e(C,{flex:"none",width:400,borderStartColor:"dark",borderStartWidth:"thin",children:s(C,{paddingStart:"size-200",paddingEnd:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(Fi,{level:3,children:"Description"}),e(Gf,{prompt:a})]}),e(v,{color:t?"text-900":"text-700",children:a.description||"No Description"}),s("section",{children:[e(Fi,{level:3,children:"Latest Versions"}),e(xh,{prompt:a})]})]})})}const Vo=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLayout__main",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:[n,a],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Vo.hash="3f2a7eb87a4a433362def455a9151d45";const Ao=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"clonePrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ClonePromptDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ClonePromptDialogMutation",selections:a},params:{cacheID:"6ad0382f6acd0f00125307c887c0f4f2",id:null,metadata:{},name:"ClonePromptDialogMutation",operationKind:"mutation",text:`mutation ClonePromptDialogMutation(
  $input: ClonePromptInput!
) {
  clonePrompt(input: $input) {
    id
  }
}
`}}}();Ao.hash="081b8cf05c35b46579fe5cbb85f7a761";const Eh=({promptId:n,promptName:a,promptDescription:t,setDialog:l})=>{var b;const i=he(),r=ue(),[o,d]=x.useMutation(Ao),c=Oe({disabled:d,reValidateMode:"onBlur",mode:"onChange",defaultValues:{name:`${a}-clone`,description:t}}),{control:p,handleSubmit:f,formState:{isValid:u,errors:g},setError:y}=c,k=f(S=>{o({variables:{input:{promptId:n,name:S.name,description:S.description}},onCompleted:K=>{l(null),i({title:"Prompt cloned successfully",action:{text:"View Prompt",onClick:()=>{r(`/prompts/${K.clonePrompt.id}`)}}})},onError:K=>{var D;const T=De(K);(D=T==null?void 0:T[0])!=null&&D.includes("already exists")?y("name",{message:T==null?void 0:T[0]}):y("root",{message:T==null?void 0:T[0]})}})});return e(X,{title:"Clone Prompt",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(C,{padding:"size-200",children:s("form",{onSubmit:k,children:[e(W,{control:p,name:"name",rules:{required:{message:"Name is required",value:!0},validate:{unique:S=>S.trim()===a.trim()?"Name must be different from the original prompt name":!0}},render:({field:{onChange:S,onBlur:K,value:T,disabled:D},fieldState:{error:w}})=>s(Y,{isInvalid:!!(w!=null&&w.message),children:[e(J,{children:"Name"}),e(se,{name:"name",type:"text",onChange:S,onBlur:K,value:T,disabled:D}),!w&&e(v,{slot:"description",children:"A name for the cloned prompt."}),e(xe,{children:w==null?void 0:w.message})]})}),e(W,{control:p,name:"description",render:({field:{onChange:S,onBlur:K,value:T,disabled:D},fieldState:{error:w}})=>s(Y,{isInvalid:!!(w!=null&&w.message),isDisabled:D,value:T,onChange:S,onBlur:K,children:[e(J,{children:"Description"}),e(Ca,{name:"description"}),!w&&e(v,{slot:"description",children:"A description for the cloned prompt."}),e(xe,{children:w==null?void 0:w.message})]})}),(g==null?void 0:g.root)&&e(v,{color:"danger",children:(b=g==null?void 0:g.root)==null?void 0:b.message}),s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:()=>l(null),isDisabled:d,children:"Cancel"}),e(M,{type:"submit",variant:"primary",isDisabled:!u,isPending:d,children:"Clone"})]})]})})})})},Rh=F`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function r2(){const[n,a]=m.useState(null),t=ci(),l=ue(),{pathname:i}=mt();let r="prompt";i.includes("versions")?r="versions":i.includes("config")&&(r="config");const o=x.useFragment(Vo,t.prompt);return s("main",{css:Rh,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[s(h,{direction:"column",children:[e(oe,{level:1,children:t.prompt.name}),o.sourcePrompt&&s(v,{color:"text-700",children:["cloned from"," ",e(Ze,{to:`/prompts/${o.sourcePrompt.id}`,children:o.sourcePrompt.name})]})]}),s(h,{direction:"row",gap:"size-100",children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(Ep,{})}),onPress:()=>{a(e(Eh,{promptId:o.id,promptName:o.name,promptDescription:o.description??void 0,setDialog:a}))},children:"Clone"}),e(M,{size:"S",leadingVisual:e(L,{svg:e(Ol,{})}),onPress:()=>{l(`/prompts/${t.prompt.id}/playground`)},children:"Edit in Playground"})]})]})}),s(Ge,{defaultSelectedKey:r,onSelectionChange:d=>{let c;d==="versions"?c=`/prompts/${t.prompt.id}/versions`:d==="config"?c=`/prompts/${t.prompt.id}/config`:c=`/prompts/${t.prompt.id}`,l(c)},children:[s(He,{children:[e(ne,{id:"prompt",children:"Prompt"}),s(ne,{id:"versions",children:["Versions ",e(yn,{children:o.promptVersions.edges.length})]}),e(ne,{id:"config",children:"Config"})]}),e(de,{id:"prompt",children:e(Ke,{})}),e(de,{id:"versions",children:e(Ke,{})}),e(de,{id:"config",children:e(Ke,{})})]}),e(ae,{onDismiss:()=>a(null),children:n})]})}const zo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"modelsInput"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},t={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"modelsInput"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:l},params:{cacheID:"530366c9a8cc3b47d685ca0600a39bb5",id:null,metadata:{},name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",operationKind:"query",text:`query fetchPlaygroundPromptSupportedInvocationParametersQuery(
  $modelsInput: ModelsInput!
) {
  modelInvocationParameters(input: $modelsInput) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();zo.hash="1138fb98386e86196eaa52c12a6bb27c";const No=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},p={alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[c,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"9beefbb59de3e9b98d785c3fd78b15d5",id:null,metadata:{},name:"fetchPlaygroundPromptQuery",operationKind:"query",text:`query fetchPlaygroundPromptQuery(
  $promptId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      id
      name
      createdAt
      description
      version {
        id
        description
        modelName
        modelProvider
        invocationParameters
        templateType
        templateFormat
        responseFormat {
          definition
        }
        template {
          __typename
          ... on PromptChatTemplate {
            messages {
              role
              content {
                __typename
                ... on TextContentPart {
                  text {
                    text
                  }
                }
                ... on ToolCallContentPart {
                  toolCall {
                    toolCallId
                    toolCall {
                      name
                      arguments
                    }
                  }
                }
                ... on ToolResultContentPart {
                  toolResult {
                    toolCallId
                    result
                  }
                }
              }
            }
          }
        }
        tools {
          definition
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();No.hash="84755f12352e245574192de304d654d5";const Mh=n=>{switch(n){case"user":return"USER";case"ai":return"AI";case"system":return"SYSTEM";case"tool":return"TOOL";default:return"USER"}},Vh=(n,a)=>{const t=a.length>0?a.reduce((l,i)=>(i.invocationName&&(l[i.invocationName]=i),l),{}):{};return Object.entries(n).map(([l,i])=>{const r=t[l];return!r||!r.invocationInputField?{invocationName:l,valueJson:i}:{invocationName:l,canonicalName:r.canonicalName,[Ba(r.invocationInputField)]:i}})},Ah=({promptId:n,promptName:a,promptVersion:t,supportedInvocationParameters:l})=>{var c,p;const i={...Rp(),prompt:{id:n,name:a}},r=t.modelName,o=t.modelProvider,d=Vl({toolChoice:(c=t.invocationParameters)==null?void 0:c.tool_choice,targetProvider:o})??void 0;return{...i,model:{...i.model,modelName:r,provider:o,supportedInvocationParameters:l||[],invocationParameters:Vh({...t.invocationParameters,...(p=t.responseFormat)!=null&&p.definition?{response_format:t.responseFormat.definition}:{}},l||[])},template:{__type:"chat",messages:"messages"in t.template?t.template.messages.map(f=>{const u=f.content.map(nl).filter(Boolean).map(S=>S.text.text).join(""),g=f.content.filter(si).filter(Boolean),k=f.content.filter(oi).filter(Boolean).at(0),b=Wn(f.role);return b==="tool"&&k?{id:Zn(),role:Wn(f.role),content:typeof k.toolResult.result=="string"?k.toolResult.result:Cn(k.toolResult.result,null,2).json||"",toolCallId:k.toolResult.toolCallId}:b==="ai"&&g.length>0?{id:Zn(),role:Wn(f.role),toolCalls:g.map(S=>_r(S,o))}:{id:Zn(),role:Wn(f.role),content:u}}):[]},tools:t.tools.map(f=>({id:tt(),definition:f.definition})),toolChoice:d}},zh=(n,a)=>{const t=a.length>0?a.reduce((l,i)=>((i.canonicalName||i.invocationName)&&(l[i.canonicalName||i.invocationName]=i),l),{}):{};return n.reduce((l,i)=>{const r=t[i.canonicalName||i.invocationName];return r&&(l[i.invocationName]=i[Ba(r.invocationInputField)]),l},{})},Nh=[{invocationName:Ea,canonicalName:Yn},{invocationName:kn,canonicalName:Sn}],$h=n=>{if(n.template.__type==="text_completion")return console.warn("Instance to prompt version conversion not supported for text completion"),null;const a=n.template.messages.map(l=>{var d;let i=[l.content?Co(l.content):null];const r=((d=l.toolCalls)==null?void 0:d.map(Fo))||[],o=l.toolCallId?[Ko(l.toolCallId,l.content)]:[];return(r.length>0||o.length>0)&&(i=[]),{content:[...i,...r,...o].filter(c=>c!==null),role:Mh(l.role)}});return{modelName:n.model.modelName||Mp,modelProvider:n.model.provider,template:{messages:a},tools:n.tools.map(l=>({definition:l.definition})),responseFormat:n.model.invocationParameters.filter(l=>l.canonicalName===Sn||l.invocationName===kn).map(l=>({definition:l.valueJson})).at(0)||void 0,invocationParameters:zh(Ds(n.model.invocationParameters.filter(l=>!Nh.some(i=>aa(i,l))).concat(n.toolChoice?[{invocationName:Ea,valueJson:n.toolChoice,canonicalName:Yn}]:[]),n.model.provider,n.model.modelName),n.model.supportedInvocationParameters)}},Oh=No,Qh=zo,jh=async({modelName:n,providerKey:a})=>{const t=await x.fetchQuery(Fe,Qh,{modelsInput:{modelName:n,providerKey:a}}).toPromise();return t==null?void 0:t.modelInvocationParameters},qh=async n=>x.fetchQuery(Fe,Oh,{promptId:n}).toPromise(),Bh=n=>n?n==null?void 0:n.version:null,$o=async n=>{var l;if(!n)return null;const a=await qh(n),t=Bh(a==null?void 0:a.prompt);if(t&&t.templateType==="CHAT"){const i=await jh({modelName:t.modelName,providerKey:t.modelProvider}),r=(l=a==null?void 0:a.prompt)==null?void 0:l.name;if(!r)throw new Error("Prompt name is required");return{instance:Ah({promptId:n,promptName:r,promptVersion:t,supportedInvocationParameters:i}),promptVersion:t}}return null},s2=async({params:n})=>{const{promptId:a}=n;if(!a)throw new Error("Prompt ID is required");const t=await $o(a);if(!t)throw new Error("Prompt not found");return{instanceWithPrompt:t.instance,templateFormat:t.promptVersion.templateFormat}},Oo=function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Oo.hash="9802d9d44657ca300abc1be4d0938560";const ui=m.createContext(null);function Uh({children:n,...a}){const[t]=m.useState(()=>Vp(a));return e(ui.Provider,{value:t,children:n})}function O(n,a){const t=pe.useContext(ui);if(!t)throw new Error("Missing PlaygroundContext.Provider in the tree");return ut(t,n,a)}function Ua(){const n=pe.useContext(ui);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const Qo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"exampleId"}],a=[{kind:"Variable",name:"id",variableName:"exampleId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},i={alias:"latestRevision",args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},o={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,r,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c=[{kind:"Literal",name:"first",value:100}],p={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,i,o],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,o,{alias:null,args:c,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},l,p,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},p],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:c,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"ae7779e6fb1148a472e58fff0f5e0f66",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: GlobalID!
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      latestRevision: revision {
        input
        output
        metadata
      }
      span {
        id
        trace {
          id
          traceId
          project {
            id
          }
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Qo.hash="5c65343f3fa6361ad93f3e548a8f8c75";const jo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}}();jo.hash="a5e0e601ed24ffaa37a99ba358f960d3";const ml={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Hh(n){const{exampleId:a,onCompleted:t}=n,[l,i]=m.useState(null),[r,o]=x.useMutation(jo),{control:d,setError:c,handleSubmit:p,formState:{isValid:f}}=Oe({defaultValues:n.currentRevision}),u=m.useCallback(g=>{if(i(null),!Rn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Rn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Rn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],versionDescription:g.description}},onCompleted:()=>{t()},onError:y=>{i(y.message)}})},[r,a,c,t]);return e(X,{size:"fullscreen",title:`Edit Example: ${a}`,extra:e(M,{variant:"primary",size:"S",isDisabled:!f||o,leadingVisual:e(L,{svg:o?e(We,{}):e(wr,{})}),onPress:()=>p(u)(),children:"Save Changes"}),children:e("div",{css:F`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[l?e(be,{variant:"danger",children:l}):null,e(W,{control:d,name:"input",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ml,children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"output",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ml,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ml,children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"description",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Y,{value:k,onChange:g,onBlur:y,isInvalid:b,children:[e(J,{children:"Revision Description"}),e(Ca,{}),S?e(xe,{children:S==null?void 0:S.message}):e(v,{slot:"description",children:"A description of the changes made in this revision. Will be displayed in the version history."})]})})]})})})})})}function Gh(n){const{onCompleted:a,...t}=n,[l,i]=m.useState(null);return s(U,{children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(gt,{})}),onPress:()=>i(e(Hh,{...t,onCompleted:()=>{i(null),a()}})),children:"Edit Example"}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l})]})}const qo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"2cfc5c04c7f88f6bbd464f6a09f87521",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();qo.hash="73457524533365ed047cb575ee6c93ab";const Bo=function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:qo,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}}();Bo.hash="73457524533365ed047cb575ee6c93ab";const Wh=100;function Jh(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:F`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:"No experiments have been run for this example."})})})}const Zh=F`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function Xh({example:n}){const a=m.useRef(null),t=ue(),{data:l,loadNext:i,hasNext:r,isLoadingNext:o}=x.usePaginationFragment(Bo,n),d=m.useMemo(()=>l.experimentRuns.edges.map(y=>{let k=null;return y.run.startTime&&y.run.endTime&&(k=new Date(y.run.endTime).getTime()-new Date(y.run.startTime).getTime()),{...y.run,output:JSON.stringify(y.run.output),latencyMs:k}}),[l]),p=Le({columns:[{header:"start time",accessorKey:"startTime",cell:Re},{header:"output",accessorKey:"output",cell:y=>{var b;const k=(b=y.row.original)==null?void 0:b.error;return k!==null?e(v,{color:"danger",children:k}):e(Ee,{...y})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:y})=>{const k=y();return k===null||typeof k!="number"?"--":e(Me,{latencyMs:k})}},{header:"evaluations",accessorKey:"annotations",cell:({row:y})=>e(h,{direction:"row",gap:"size-50",wrap:"wrap",children:y.original.annotations.edges.map((k,b)=>{const S=k.annotation;return e(za,{annotation:S,extra:S.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:Zh,children:[e(L,{svg:e(Mn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(zn,{annotation:S,onClick:()=>{S.trace&&t(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},b)},b)})})},{id:"actions",cell:({row:y})=>{const k=y.original.trace;if(k)return e(M,{size:"S",leadingVisual:e(L,{svg:e(Qt,{})}),onPress:()=>{t(`/projects/${k.projectId}/traces/${k.traceId}`)},"aria-label":"view trace"})}}],data:d,getCoreRowModel:we()}),f=p.getRowModel().rows,u=f.length===0,g=m.useCallback(y=>{if(y){const{scrollHeight:k,scrollTop:b,clientHeight:S}=y;k-b-S<300&&!o&&r&&i(Wh)}},[r,o,i]);return e("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:y=>g(y.target),children:s("table",{css:sa,children:[e("thead",{children:p.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(k=>e("th",{children:e("div",{children:Z(k.column.columnDef.header,k.getContext())})},k.id))},y.id))}),u?e(Jh,{}):e("tbody",{children:f.map(y=>e("tr",{children:y.getVisibleCells().map(k=>e("td",{children:Z(k.column.columnDef.cell,k.getContext())},k.id))},y.id))})]})})}function mi({exampleId:n,onDismiss:a}){const[t,l]=m.useState(0),i=x.useLazyLoadQuery(Qo,{exampleId:n},{fetchKey:t,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{const u=i.example.latestRevision;return{input:JSON.stringify(u==null?void 0:u.input,null,2),output:JSON.stringify(u==null?void 0:u.output,null,2),metadata:JSON.stringify(u==null?void 0:u.metadata,null,2)}},[i]),o=m.useMemo(()=>{const u=i.example.span;return u?{id:u.id,traceId:u.trace.traceId,projectId:u.trace.project.id}:null},[i]),{input:d,output:c,metadata:p}=r,f=he();return e(ae,{type:"slideOver",isDismissable:!0,onDismiss:a,children:e(X,{size:"XL",title:`Example: ${n}`,extra:s(h,{direction:"row",gap:"size-100",children:[o?e(Ta,{size:"S",to:`/projects/${o.projectId}/traces/${o.traceId}?selectedSpanNodeId=${o.id}`,children:"View Source Span"}):null,e(Gh,{exampleId:n,currentRevision:r,onCompleted:()=>{f({title:"Example updated",message:`Example ${n} has been updated.`}),l(u=>u+1)}})]}),children:s(pn,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(_e,{defaultSize:65,children:e("div",{css:F`
                overflow-y: auto;
                height: 100%;
              `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",paddingTop:"size-200",paddingBottom:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[e(q,{title:"Input",...pl,extra:e(ce,{text:d}),children:e(nn,{value:d})}),e(q,{title:"Output",...pl,extra:e(ce,{text:c}),children:e(nn,{value:c})}),e(q,{title:"Metadata",...pl,extra:e(ce,{text:p}),children:e(nn,{value:p})})]})})})})}),e(vn,{css:Na}),e(_e,{defaultSize:35,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(oe,{level:3,children:"Experiment Runs"})}),e(Xh,{example:i.example})]})})]})})})}const pl={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function Yh(){const[n,a]=In(),t=n.get("exampleId"),l=n.get("datasetId");return!t||!l?null:e(mi,{exampleId:t,onDismiss:()=>{a(i=>(i.delete("exampleId"),i))}})}const e0=`
The playground is not available until an LLM provider client is installed on the server.
`,n0=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,t)=>(t.dependencies.forEach(l=>a.add(l)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,a0=n=>e(C,{height:"100%",width:"100%",children:s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(Er,{message:e0,graphicKey:"not found",size:"L"}),e(v,{children:"The following clients are supported:"}),e(Lr,{value:n0(n.availableProviders)})]})}),t0={OPENAI:"OPENAI_API_KEY",ANTHROPIC:"ANTHROPIC_API_KEY",AZURE_OPENAI:"AZURE_OPENAI_API_KEY",GOOGLE:"GEMINI_API_KEY"};function l0(){const n=O(o=>Array.from(new Set(o.instances.map(d=>d.model.provider)))),a=O(o=>o.instances.some(d=>d.activeRunId!=null)),t=Ma(o=>o.setCredential),l=Ma(o=>o),[i,r]=m.useState(!1);return e("div",{css:F`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:s(Va,{placement:"bottom",isOpen:i,onOpenChange:o=>{r(o)},children:[e(Sr,{size:"compact",isDisabled:a,children:"API Keys"}),e(Ll,{children:e(C,{padding:"size-200",children:s(tn,{onSubmit:o=>{o.preventDefault(),r(!1)},children:[e(oe,{level:2,weight:"heavy",children:"API Keys"}),e(C,{paddingY:"size-50",children:e(v,{color:"text-700",size:"XS",children:"API keys are stored in your browser and used to communicate with their respective API's."})}),e(h,{direction:"column",gap:"size-100",children:n.map(o=>{const d=t0[o];return s(Y,{size:"S",type:"password",isRequired:!0,onChange:c=>{t({provider:o,value:c})},value:l[o],children:[e(J,{children:d}),e(se,{}),e(v,{slot:"description",children:`Alternatively, you can set the "${d}" environment variable on the phoenix server.`})]},o)})}),e(C,{paddingTop:"size-100",children:e(h,{direction:"row",gap:"size-100",width:"100%",justifyContent:"end",children:e(ln,{href:"/settings/providers",children:"View all AI provider configurations"})})})]})})})]})})}const Hi=30,i0=F`
  display: flex;
  direction: row;
  align-items: center;
  .ac-dropdown > button {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    height: ${Hi}px;
  }
  & > button {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
    height: ${Hi}px;
  }
`;function r0(){const[n,a]=In(),t=n.get("datasetId")??"";return s("div",{css:i0,children:[e(Rr,{size:"compact",placeholder:"Test over a dataset",selectedKey:t,onSelectionChange:l=>{if(t!==null&&l===t){a(i=>(i.delete("datasetId"),i));return}a(i=>(i.set("datasetId",String(l)),i))}}),e(M,{size:"S",leadingVisual:e(L,{svg:e(Ap,{})}),onPress:()=>{a(l=>(l.delete("datasetId"),l))}})]})}const Uo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"c36833ac260163836d9810cf8e137380",id:null,metadata:{},name:"PlaygroundDatasetSectionQuery",operationKind:"query",text:`query PlaygroundDatasetSectionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      name
      exampleCount
    }
    __isNode: __typename
    id
  }
}
`}}}();Uo.hash="38aaf5a39c06500e51a82c91a9e27408";const Ho=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionMutationError",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[t,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ChatCompletionMutationPayload",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:l},params:{cacheID:"4697f7aaa22729dbf83970ce9ae6475b",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      result {
        __typename
        ... on ChatCompletionMutationError {
          message
        }
        ... on ChatCompletionMutationPayload {
          content
          errorMessage
          span {
            id
            tokenCountCompletion
            tokenCountPrompt
            tokenCountTotal
            latencyMs
            project {
              id
            }
            context {
              traceId
            }
          }
          toolCalls {
            id
            function {
              name
              arguments
            }
          }
        }
      }
    }
  }
}
`}}}();Ho.hash="c15f93fe1380986536971620c3bf3a11";const Go=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[t],i=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:i,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:i},params:{cacheID:"3759bfb17a93aa0cf227c4ef7fa6cd30",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      span {
        id
        tokenCountCompletion
        tokenCountPrompt
        tokenCountTotal
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      message
    }
  }
}
`}}}();Go.hash="f1df5c75f1a62acde69f3f5d676f9213";const Wo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"fc176d05790f6c690eead96a6ece1c50",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 20
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Wo.hash="ae68770500a29b14f7108d56c146fb99";const Jo=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Wo,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Jo.hash="ae68770500a29b14f7108d56c146fb99";const Zo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:20}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:20)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"795ea41682593e1fedd5ced3252f7602",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment on Dataset {
  examples(first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Zo.hash="f809b3d539d0032d9681a4a4450b1d6f";const s0=()=>{const n=(a,t)=>({exampleResponsesMap:{},updateExampleData:({instanceId:l,exampleId:i,patch:r})=>{const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{};a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,...r}}}})},appendExampleDataTextChunk:({instanceId:l,exampleId:i,textChunk:r})=>{const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{},p=c.content??"";a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,content:p+r}}}})},appendExampleDataToolCallChunk:({instanceId:l,exampleId:i,toolCallChunk:r})=>{var k;const o=t().exampleResponsesMap,d=o[l]??{},c=d[i]??{},p=c.toolCalls??{},{id:f,function:u}=r,g=p[f],y={...g,id:f,function:{name:((k=g==null?void 0:g.function)==null?void 0:k.name)??u.name,arguments:(g==null?void 0:g.function.arguments)!=null?g.function.arguments+u.arguments:u.arguments}};a({exampleResponsesMap:{...o,[l]:{...d,[i]:{...c,toolCalls:{...p,[f]:y}}}}})},setExampleDataForInstance:({instanceId:l,data:i})=>{const r=t().exampleResponsesMap;a({exampleResponsesMap:{...r,[l]:i}})},resetExampleData:()=>{a({exampleResponsesMap:{}})}});return gr()(n)},Xo=pe.createContext(null);function o0({children:n}){const[a]=m.useState(()=>s0());return e(Xo.Provider,{value:a,children:n})}function xa(n,a){const t=pe.useContext(Xo);if(!t)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return ut(t,n,a)}function pi({children:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(Ql,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const Yo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"runId"}],a=[{kind:"Variable",name:"id",variableName:"runId"}],t={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRun",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"1e3277995e47da369d84557def1a62bf",id:null,metadata:{},name:"PlaygroundExperimentRunDetailsDialogQuery",operationKind:"query",text:`query PlaygroundExperimentRunDetailsDialogQuery(
  $runId: GlobalID!
) {
  run: node(id: $runId) {
    __typename
    ... on ExperimentRun {
      output
      startTime
      endTime
      error
      example {
        id
        revision {
          input
          output
        }
      }
      annotations {
        edges {
          annotation: node {
            id
            name
            label
            score
            explanation
            annotatorKind
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Yo.hash="2eee337b0f8c4e738dd6580efa1e3c96";function d0({runId:n}){var d,c,p;const t=x.useLazyLoadQuery(Yo,{runId:n}).run,l=(d=t.example)==null?void 0:d.id,i=(c=t.example)==null?void 0:c.revision,r=i==null?void 0:i.input,o=i==null?void 0:i.output;return e(X,{title:`Experiment Run for Example: ${l}`,size:"fullscreen",children:s(pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(_e,{defaultSize:33,children:e(C,{overflow:"auto",height:"100%",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(q,{title:"Input",...Gi,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(ce,{text:JSON.stringify(r)}),children:e(nn,{value:JSON.stringify(r,null,2)})})}),e(C,{width:"50%",children:e(q,{title:"Reference Output",...Gi,extra:e(ce,{text:JSON.stringify(o)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(nn,{value:JSON.stringify(o,null,2)})})})]})})}),e(vn,{css:Na}),e(_e,{defaultSize:67,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(oe,{level:2,children:"Experiment Run Output"})}),e("div",{css:F`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:s(h,{direction:"row",children:[e(C,{flex:!0,children:t.error?e(C,{padding:"size-200",children:e(u0,{error:t.error})}):e(nn,{value:JSON.stringify(t.output,null,2)})}),s(ha,{width:"size-3000",children:[t.startTime&&t.endTime&&e(c0,{startTime:t.startTime,endTime:t.endTime}),e("ul",{css:F`
                      margin-top: var(--ac-global-dimension-static-size-100);
                      display: flex;
                      flex-direction: column;
                      justify-content: flex-start;
                      align-items: flex-end;
                      gap: var(--ac-global-dimension-static-size-100);
                    `,children:(p=t.annotations)==null?void 0:p.edges.map(f=>e("li",{children:e(zn,{annotation:f.annotation})},f.annotation.id))})]})]})})]})})]})})}function c0({startTime:n,endTime:a}){const t=m.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Me,{latencyMs:t})}function u0({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(Ql,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const Gi={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},ed=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"traceId",variableName:"traceId"}],concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:1e3}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"},i],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"9434c8c6e07d5ca4dd3a19286644f369",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        spans(first: 1000) {
          edges {
            span: node {
              id
              spanId
              name
              spanKind
              statusCode
              startTime
              parentId
              latencyMs
              tokenCountTotal
              tokenCountPrompt
              tokenCountCompletion
            }
          }
        }
        latencyMs
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();ed.hash="e4165ac98e972c7c7491e1573a1aec1a";const nd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},K=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],T={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:K,storageKey:null},D={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:K,storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},P={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},_={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},V={alias:null,args:null,concreteType:"DocumentEvaluation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},o,z,R,Q],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,o,d,c,p,f,u,g,y,k,b,S,T,D,w,{kind:"RequiredField",field:P,action:"THROW"},_,V,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,o],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanHeader_span"},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,o,d,c,p,f,u,g,y,k,b,S,T,D,w,P,_,V,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,o,z,R,Q,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"5c3846067ae228d13a34f9ee3e533b43",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $id: GlobalID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      id
      spanId
      trace {
        id
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      tokenCountPrompt
      tokenCountCompletion
      endTime
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
      }
      spanAnnotations {
        id
        name
      }
      ...SpanHeader_span
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  project {
    id
  }
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}

fragment SpanFeedback_annotations on Span {
  id
  spanAnnotations {
    id
    name
    label
    score
    explanation
    metadata
    annotatorKind
  }
}

fragment SpanHeader_span on Span {
  name
  spanKind
  code: statusCode
  latencyMs
  startTime
  tokenCountPrompt
  tokenCountCompletion
  tokenCountTotal
}
`}}}();nd.hash="7cbd32bca298fe80e84fff1dfb6444e8";function m0(n,a){const t=m.useRef(null);m.useEffect(()=>{t.current=n},[n]),m.useEffect(()=>{function l(){t.current&&t.current()}{const i=setInterval(l,a);return()=>clearInterval(i)}},[a])}function p0(){const{locale:n}=Cm();return m.useMemo(()=>zp(n),[n])}const g0=n=>{const[a,t]=m.useState(null);return m.useEffect(()=>{if(!n.current)return;const l=new ResizeObserver(i=>{if(!i||i.length===0)return;const{width:r,height:o}=i[0].contentRect;t({width:r,height:o})});return l.observe(n.current),()=>{l.disconnect()}},[n]),a};function Wi(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&me.message in a&&y0(a[me.message]))}function y0(n){return typeof n=="object"&&n!==null&&Qe.role in n}function ad(n){return n==="OPENAI"||n==="AZURE_OPENAI"||n==="ANTHROPIC"||n==="GOOGLE"}const gl=F`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function an(n){const{name:a,metric:t,k:l,score:i}=n,r=typeof l=="number"?`${t}@${l}`:t,o=m.useMemo(()=>t==="hit"?i?"true":"false":typeof i=="number"&&Gn(i)||"--",[i,t]);return s(Se,{delay:500,offset:3,children:[e($e,{children:e("div",{css:Np,children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e($p,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:gl,children:e(v,{weight:"heavy",size:"XS",color:"inherit",children:a})}):null,e("div",{css:gl,children:e(v,{size:"XS",color:"inherit",children:r})}),e("div",{css:gl,children:e(v,{size:"XS",children:o})})]})})}),e(la,{children:s(h,{direction:"row",gap:"size-100",children:[s(v,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(v,{color:"inherit",children:o})]})})]})}const td={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanHeader_span",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],type:"Span",abstractKey:null};td.hash="0f8977d600d3ec53dac56592f9dc91ad";function f0(n){const a=x.useFragment(td,n.span),t=m.useMemo(()=>new Date(a.startTime),[a.startTime]);return e(h,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(jl,{spanKind:a.spanKind}),e(v,{size:"L",children:a.name}),e(jt,{statusCode:a.code,css:F`
              font-size: var(--ac-global-font-size-m);
            `})]}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[typeof a.latencyMs=="number"?e(Me,{latencyMs:a.latencyMs,size:"S"}):null,s(v,{color:"text-500",size:"S",children:["at ",Nn(t)]}),a.tokenCountTotal?e(oa,{tokenCountTotal:a.tokenCountTotal,tokenCountPrompt:a.tokenCountPrompt??0,tokenCountCompletion:a.tokenCountCompletion??0,size:"S"}):null]})]})})}function h0(n){const{spanId:a,traceId:t}=n,l=he();return s(xn,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"COPY_SPAN_ID":{Ki(a),l({title:"Span ID Copied",message:`The Span ID ${a} has been copied to your clipboard`});return}case"COPY_TRACE_ID":{Ki(t),l({title:"Trace ID Copied",message:`The Trace ID ${t} has been copied to your clipboard`});return}default:ve()}},children:[e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(xi,{})}),e(v,{children:"Copy Span ID"})]})},"COPY_SPAN_ID"),e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(xi,{})}),e(v,{children:"Copy Trace ID"})]})},"COPY_TRACE_ID")]})}const ld=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"1a86b74a3488b1d784333546762802fa",id:null,metadata:{},name:"SpanAsideSpanQuery",operationKind:"query",text:`query SpanAsideSpanQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpanAside_span
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  project {
    id
  }
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}
`}}}();ld.hash="40874c824cdcd1a4790f1960b840457c";const id=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:ld,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpanAside_span",selections:[n,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[n],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();id.hash="40874c824cdcd1a4790f1960b840457c";const k0=F`
  display: flex;
  width: 100%;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  align-items: flex-start;
`;function b0(n){const[a]=x.useRefetchableFragment(id,n.span),t=a.spanAnnotations,l=t.length>0;return s(pn,{direction:"vertical",autoSaveId:"span-aside-layout",children:[l&&e(Di,{title:"Annotations",panelProps:{order:1,defaultSize:65},children:e(C,{paddingY:"size-100",paddingX:"size-100",children:e("ul",{css:k0,children:t.map(i=>e("li",{children:e(zn,{annotation:i,annotationDisplayPreference:"label"})},i.id))})})}),e(Di,{resizable:!0,title:"Edit annotations",panelProps:{order:2},children:e(C,{height:"100%",maxHeight:"100%",children:e(Op,{projectId:a.project.id,spanNodeId:a.id})})})]})}const rd=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[n,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();rd.hash="8ed7e3ac3c8cc4b5934f6f269116d159";function S0(){const[n,a]=m.useState(null);return s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",alignItems:"center",children:[e(Rt,{graphicKey:"documents"}),e(v,{children:"No annotations for this span"}),e(M,{variant:"default",size:"S",onPress:()=>{a(e(X,{title:"Span Annotations",isDismissable:!0,children:s(C,{padding:"size-200",children:[e("p",{css:F`
              margin: 0 0 var(--ac-global-dimension-size-100) 0;
            `,children:"Annotations are pivotal for tracking and improving the performance of your application. Phoenix allows for both LLM and HUMAN annotations."}),e(ln,{href:"https://docs.arize.com/phoenix/tracing/concepts-tracing/how-to-evaluate-traces",children:"View annotation documentation"})]})}))},leadingVisual:e(L,{svg:e(Ol,{})}),children:"How to Annotate"})]}),e(ae,{onDismiss:()=>a(null),isDismissable:!0,children:n})]})}const v0=F`
  overflow: auto;
`;function C0({annotations:n,spanNodeId:a}){const t=m.useMemo(()=>n.map(p=>({...p,spanNodeId:a})),[n,a]),l=he(),i=Pe(),r=m.useMemo(()=>[{header:"name",accessorKey:"name",size:100},{header:"annotator kind",accessorKey:"annotatorKind",size:100,cell:({row:p})=>{const f=p.original.annotatorKind;return e(jp,{kind:f})}},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:Qp,size:400},{header:"metadata",accessorKey:"metadata",minSize:100,cell:({row:p})=>{const f=p.original.metadata;return f?e($a,{json:f,collapseSingleKey:!1}):"--"}},{header:"",accessorKey:"actions",size:100,cell:({row:p})=>e(qp,{buttonVariant:"default",buttonSize:"compact",annotationId:p.original.id,spanNodeId:p.original.spanNodeId,annotationName:p.original.name,onSpanAnnotationActionSuccess:l,onSpanAnnotationActionError:f=>{i({title:"Failed to update span annotation",message:f.message})}})}],[i,l]),o=Le({columns:r,data:t,getCoreRowModel:we()}),c=o.getRowModel().rows.length===0;return e("div",{css:v0,children:s("table",{css:sn,"data-testid":"span-annotations-table",children:[e("thead",{children:o.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:e(U,{children:Z(f.column.columnDef.header,f.getContext())})},f.id))},p.id))}),c?e(cn,{}):e("tbody",{children:o.getRowModel().rows.map(p=>e("tr",{children:p.getVisibleCells().map(f=>e("td",{style:{width:f.column.getSize()},children:Z(f.column.columnDef.cell,f.getContext())},f.id))},p.id))})]})})}function F0({span:n}){const a=x.useFragment(rd,n),t=a.spanAnnotations;return a.spanAnnotations.length>0?e(C0,{annotations:t,spanNodeId:a.id}):e(S0,{})}function K0(n){return n==="__REDACTED__"}const T0=F`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function P0(n){const[a,t]=m.useState(!1);let l;const i=K0(n.url);return i?l=e(I0,{}):l=e("img",{src:n.url}),s("div",{className:Fm({"is-expanded":a}),css:T0,children:[!i&&e(M,{variant:"default",size:"S",onPress:()=>t(!a),leadingVisual:e(L,{svg:a?e(Bp,{}):e(ot,{})}),"aria-label":"Expand / Collapse Image"}),l]})}const I0=()=>s("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),sd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();sd.hash="75120065d239f28304e9dd91fc34bec9";const od=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"68887dda2ffa7793e66ff83d472c72f8",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();od.hash="647a1865dacf40ce9bbb255b572a9a68";const yl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function x0({spanId:n,onCompleted:a}){const[t,l]=m.useState(null),i=x.useLazyLoadQuery(od,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[o,d]=x.useMutation(sd),{control:c,setError:p,handleSubmit:f,formState:{isValid:u}}=Oe({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),g=m.useCallback(y=>{if(l(null),!Rn(y==null?void 0:y.input))return p("input",{message:"Input must be a valid JSON object"});if(!Rn(y==null?void 0:y.output))return p("output",{message:"Output must be a valid JSON object"});if(!Rn(y==null?void 0:y.metadata))return p("metadata",{message:"Metadata must be a valid JSON object"});if(!(y!=null&&y.datasetId))return p("datasetId",{message:"Dataset is required"});o({variables:{input:{datasetId:y.datasetId,examples:[{input:JSON.parse(y.input),output:JSON.parse(y.output),metadata:JSON.parse(y.metadata),spanId:n}]}},onCompleted:()=>{a(y.datasetId)},onError:k=>{const b=De(k);l((b==null?void 0:b[0])??k.message)}})},[o,p,n,a]);return e(X,{size:"fullscreen",title:"Add Example to Dataset",extra:e(M,{variant:"primary",size:"S",isDisabled:!u||d,onPress:()=>f(g)(),leadingVisual:e(L,{svg:d?e(We,{}):e(lt,{})}),children:"Add Example"}),children:e("div",{css:F`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[t?e(be,{variant:"danger",children:t}):null,e(W,{control:c,name:"datasetId",render:({field:{onChange:y,onBlur:k},fieldState:{invalid:b,error:S}})=>s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(Rr,{onSelectionChange:y,onBlur:k,validationState:b?"invalid":"valid",errorMessage:S==null?void 0:S.message,label:"Dataset"}),e(Up,{})]})}),e(W,{control:c,name:"input",render:({field:{onChange:y,onBlur:k,value:b},fieldState:{invalid:S,error:K}})=>s(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...yl,children:[S?e(be,{variant:"danger",banner:!0,children:K==null?void 0:K.message}):null,e(Ue,{value:b,onChange:y,onBlur:k})]})}),e(W,{control:c,name:"output",render:({field:{onChange:y,onBlur:k,value:b},fieldState:{invalid:S,error:K}})=>s(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...yl,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(be,{variant:"danger",banner:!0,children:K==null?void 0:K.message}):null,e(Ue,{value:b,onChange:y,onBlur:k})]})}),e(W,{control:c,name:"metadata",render:({field:{onChange:y,onBlur:k,value:b},fieldState:{invalid:S,error:K}})=>s(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...yl,children:[S?e(be,{variant:"danger",banner:!0,children:K==null?void 0:K.message}):null,e(Ue,{value:b,onChange:y,onBlur:k})]})})]})})})})})}const D0=n=>m.useMemo(()=>Ve(n),[n]),_0=n=>n.events.some(a=>a.name==="exception"),Te={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},L0=900,fl=33;function w0({spanNodeId:n}){const a=Fn(p=>p.isAnnotatingSpans),t=Fn(p=>p.setIsAnnotatingSpans),l=m.useRef(null),i=m.useRef(null),r=g0(i),o=(r==null?void 0:r.width)&&r.width<L0,{span:d}=x.useLazyLoadQuery(nd,{id:n});if(d.__typename!=="Span")throw new Error("Expected a span, but got a different type"+d.__typename);const c=m.useMemo(()=>_0(d),[d]);return s(pn,{direction:"horizontal",autoSaveId:"span-details-layout",children:[e(_e,{order:1,children:s(h,{direction:"column",flex:"1 1 auto",height:"100%",ref:i,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-50",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:s(h,{direction:"row",alignItems:"center","data-testid":"span-header-row",children:[e(f0,{span:d}),s(h,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(Ta,{variant:d.spanKind!=="llm"?"default":"primary",leadingVisual:e(L,{svg:e(Ka,{})}),isDisabled:d.spanKind!=="llm",to:`/playground/spans/${d.id}`,size:"S","aria-label":"Prompt Playground",children:o?null:"Playground"}),e(M0,{span:d,buttonText:o?null:"Add to Dataset"}),e(Xn,{size:"S",isSelected:a,onPress:()=>{t(!a);const p=l.current;p&&p.getSize()<fl&&p.resize(fl)},leadingVisual:e(L,{svg:e(gt,{})}),children:o?null:"Annotate"}),e(h0,{traceId:d.trace.traceId,spanId:d.spanId})]})]})}),s(Ge,{children:[s(He,{children:[e(ne,{id:"info",children:"Info"}),s(ne,{id:"feedback",children:["Feedback ",e(yn,{children:d.spanAnnotations.length})]}),e(ne,{id:"attributes",children:"Attributes"}),s(ne,{id:"events",children:["Events"," ",e(yn,{variant:c?"danger":"default",children:d.events.length})]})]}),e(de,{id:"info",children:e(h,{direction:"row",height:"100%",children:e(R0,{children:e(qt,{children:e(V0,{span:d})})})})}),e(de,{id:"feedback",children:e(F0,{span:d})}),e(de,{id:"attributes",children:e(C,{padding:"size-200",height:"100%",maxHeight:"100%",overflow:"auto",children:e(q,{title:"All Attributes",...Te,titleExtra:ud,extra:e(ce,{text:d.attributes}),children:e(ta,{children:d.attributes})})})}),e(de,{id:"events",children:e(Y0,{events:d.events})})]})]})}),a&&e(vn,{css:Bt}),a&&e(_e,{order:2,ref:l,defaultSize:fl,onCollapse:()=>{t(!1)},children:e(b0,{span:d})})]})}const E0=F`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function R0({children:n}){return e("div",{css:E0,"data-testid":"span-info-wrap",children:n})}function M0({span:n,buttonText:a}){const[t,l]=m.useState(null),i=he(),r=ue(),o=m.useCallback(()=>{l(e(x0,{spanId:n.id,onCompleted:d=>{l(null),i({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{r(`/datasets/${d}/examples`)}}})}}))},[n.id,i,r]);return s(U,{children:[e(M,{variant:"default",size:"S",leadingVisual:e(L,{svg:e(zt,{})}),onPress:o,children:a}),e(m.Suspense,{children:e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(null),children:t})})]})}function V0({span:n}){const{spanKind:a,attributes:t}=n,{json:l,parseError:i}=D0(t),r=m.useMemo(()=>n.statusMessage?e(be,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!l)return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,e(be,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(q,{...Te,title:"Attributes",children:e(C,{padding:"size-100",children:t})})]})});let o;switch(a){case"llm":{o=e(A0,{span:n,spanAttributes:l});break}case"retriever":{o=e(z0,{span:n,spanAttributes:l});break}case"reranker":{o=e(N0,{span:n,spanAttributes:l});break}case"embedding":{o=e($0,{span:n,spanAttributes:l});break}case"tool":{o=e(O0,{span:n,spanAttributes:l});break}default:o=e(dd,{span:n})}return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,o,l!=null&&l.metadata?e(q,{...Te,title:"Metadata",children:e(ta,{children:JSON.stringify(l.metadata)})}):null]})})}function A0(n){const{spanAttributes:a,span:t}=n,{input:l,output:i}=t,r=m.useMemo(()=>a[me.llm]||null,[a]),o=r==null?void 0:r[Ae.provider],d=m.useMemo(()=>{if(r==null)return null;const R=r[Ae.model_name];return typeof R=="string"?R:null},[r]),c=m.useMemo(()=>{if(r==null)return[];const R=r[Ae.input_messages];return Wi(R)?(R==null?void 0:R.map(Q=>Q[me.message]).filter(Boolean))||[]:[]},[r]),p=m.useMemo(()=>{if(r==null)return[];const R=r[Ae.tools];return Array.isArray(R)?R==null?void 0:R.map(V=>V[me.tool]).filter(Boolean):[]},[r]),f=m.useMemo(()=>p.reduce((R,Q)=>(Q!=null&&Q.json_schema&&R.push(Q.json_schema),R),[]),[p]),u=m.useMemo(()=>{if(r==null)return[];const R=r[Ae.output_messages];return Wi(R)?R.map(Q=>Q[me.message]).filter(Boolean)||[]:[]},[r]),g=m.useMemo(()=>{if(r==null)return[];const R=r[Ae.prompts];return Gp(R)?R:[]},[r]),y=m.useMemo(()=>{if(r==null)return null;const R=r[Ae.prompt_template];return R??null},[r]),k=m.useMemo(()=>r==null?"{}":r[Ae.invocation_parameters]||"{}",[r]),b=m.useMemo(()=>{if(d==null)return null;let R=e(Bl,{spanKind:"llm"});const Q=o==null?void 0:o.toUpperCase();return typeof Q=="string"&&ad(Q)&&(R=e(At,{provider:Q})),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[R,e(v,{size:"M",weight:"heavy",children:d})]})},[d,o]),S=l!=null&&l.value!=null,K=c.length>0,T=f.length>0,D=i!=null&&i.value!=null,w=u.length>0,P=g.length>0,_=Object.keys(Ve(k).json||{}).length>0,z=y!=null;return s(h,{direction:"column",gap:"size-200",children:[e(q,{collapsible:!0,backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},titleSeparator:!1,variant:"compact",title:b,children:s(Ge,{children:[s(He,{children:[K&&e(ne,{id:"input-messages",children:"Input Messages"}),T&&e(ne,{id:"tools",children:"Tools"}),S&&e(ne,{id:"input",children:"Input"}),z&&e(ne,{id:"prompt-template",children:"Prompt Template"}),P&&e(ne,{id:"prompts",children:"Prompts"}),_&&e(ne,{id:"invocation-params",children:"Invocation Params"})]}),K&&e(de,{id:"input-messages",children:e(Ji,{messages:c})}),T&&e(de,{id:"tools",children:e(B0,{toolSchemas:f})}),S&&e(de,{id:"input",children:e(C,{padding:"size-200",children:e(rn,{children:e(q,{...Te,title:"LLM Input",extra:s(h,{direction:"row",gap:"size-100",children:[e(Kn,{}),e(ce,{text:l.value})]}),children:e(Vn,{...l})})})})}),z&&e(de,{id:"prompt-template",children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(Tt,{text:y.template,children:[e(v,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(cd,{children:y.template})]})}),e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(Tt,{text:JSON.stringify(y.variables),children:[e(v,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(ta,{children:JSON.stringify(y.variables)})]})})]})})}),P&&e(de,{id:"prompts",children:e(U0,{prompts:g})}),_&&e(de,{id:"invocation-params",children:e(Tt,{text:k,padding:"size-100",children:e(ta,{children:k})})})]})}),D||w?e(_l,{...Te,children:s(Ge,{children:[s(He,{children:[w&&e(ne,{id:"output-messages",children:"Output Messages"}),D&&e(ne,{id:"output",children:"Output"})]}),w&&e(de,{id:"output-messages",children:e(Ji,{messages:u})}),D&&e(de,{id:"output",children:e(C,{padding:"size-200",children:e(rn,{children:e(q,{...Te,title:"LLM Output",extra:s(h,{direction:"row",gap:"size-100",children:[e(Kn,{}),e(ce,{text:i.value})]}),children:e(Vn,{...i})})})})})]})}):null]})}function z0(n){const{spanAttributes:a,span:t}=n,{input:l}=t,i=m.useMemo(()=>a[me.retrieval]||null,[a]),r=m.useMemo(()=>{var u;return i==null?[]:((u=i[Km.documents])==null?void 0:u.map(g=>g[me.document]).filter(Boolean))||[]},[i]),o=m.useMemo(()=>t.documentEvaluations.reduce((g,y)=>{const k=y.documentPosition,b=g[k]||[];return{...g,[k]:[...b,y]}},{}),[t.documentEvaluations]),d=l!=null&&l.value!=null,c=d&&l.mimeType==="text",p=r.length>0,f=t.documentRetrievalMetrics.length>0;return s(h,{direction:"column",gap:"size-200",children:[d?e(rn,{children:e(q,{title:"Input",...Te,extra:e(h,{direction:"row",gap:"size-100",alignItems:"center",children:c?e(Kn,{}):e(ce,{text:l.value})}),children:e(Vn,{...l})})}):null,p?e(rn,{children:e(q,{title:"Documents",...Te,titleExtra:f&&e(h,{direction:"row",alignItems:"center",gap:"size-100",children:t.documentRetrievalMetrics.map(u=>s(U,{children:[e(an,{name:u.evaluationName,metric:"ndcg",score:u.ndcg},"ndcg"),e(an,{name:u.evaluationName,metric:"precision",score:u.precision},"precision"),e(an,{name:u.evaluationName,metric:"hit",score:u.hit},"hit")]}))}),extra:e(Kn,{}),children:e("ul",{css:F`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:r.map((u,g)=>e("li",{children:e(Pl,{document:u,documentEvaluations:o[g],borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},g))})})}):null]})}function N0(n){const{spanAttributes:a}=n,t=m.useMemo(()=>a[me.reranker]||null,[a]),l=m.useMemo(()=>t==null?null:t[ol.query]||null,[t]),i=m.useMemo(()=>{var c;return t==null?[]:((c=t[ol.input_documents])==null?void 0:c.map(p=>p[me.document]).filter(Boolean))||[]},[t]),r=m.useMemo(()=>{var c;return t==null?[]:((c=t[ol.output_documents])==null?void 0:c.map(p=>p[me.document]).filter(Boolean))||[]},[t]),o=i.length,d=r.length;return s(h,{direction:"column",gap:"size-200",children:[e(rn,{children:l&&e(q,{title:"Query",...Te,children:e(C,{padding:"size-200",children:e(Oa,{children:l})})})}),e(q,{title:"Input Documents",titleExtra:e(yn,{children:o}),...Te,defaultOpen:!1,bodyStyle:{padding:0},children:e("ul",{css:F`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((c,p)=>e("li",{children:e(Pl,{document:c,borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},p))})}),e(q,{title:"Output Documents",titleExtra:e(yn,{children:d}),...Te,bodyStyle:{padding:0},children:e("ul",{css:F`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((c,p)=>e("li",{children:e(Pl,{document:c,borderColor:"celery-700",backgroundColor:"celery-100",tokenColor:"var(--ac-global-color-celery-1000)"})},p))})})]})}function $0(n){const{spanAttributes:a}=n,t=m.useMemo(()=>a[me.embedding]||null,[a]),l=m.useMemo(()=>{var o;return t==null?[]:((o=t[dl.embeddings])==null?void 0:o.map(d=>d[me.embedding]).filter(Boolean))||[]},[t]),i=l.length>0,r=t==null?void 0:t[dl.model_name];return e(h,{direction:"column",gap:"size-200",children:i?e(q,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...Te,children:e("ul",{css:F`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:l.map((o,d)=>e("li",{children:e(rn,{children:e(q,{...Te,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(C,{padding:"size-200",children:e(Oa,{children:o[dl.text]||""})})})})},d))})}):e(dd,{span:n.span})})}function O0(n){const{span:a,spanAttributes:t}=n,{input:l,output:i}=a,r=typeof(l==null?void 0:l.value)=="string",o=typeof(i==null?void 0:i.value)=="string",d=(l==null?void 0:l.mimeType)==="text",c=(i==null?void 0:i.mimeType)==="text",p=m.useMemo(()=>t[me.tool]||{},[t]),f=Object.keys(p).length>0,u=p[Kt.name],g=p[Kt.description],y=p[Kt.parameters];return!r&&!o&&!f?null:s(h,{direction:"column",gap:"size-200",children:[r?e(rn,{children:e(q,{title:"Input",...Te,extra:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(Kn,{}):null,e(ce,{text:l.value})]}),children:e(Vn,{...l})})}):null,o?e(rn,{children:e(q,{title:"Output",...Te,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[c?e(Kn,{}):null,e(ce,{text:i.value})]}),children:e(Vn,{...i})})}):null,f?e(q,{title:"Tool"+(typeof u=="string"?`: ${u}`:""),...Te,children:s(h,{direction:"column",children:[g!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:s(h,{direction:"column",alignItems:"start",gap:"size-50",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Description"}),e(v,{children:g})]})}):null,y!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",alignItems:"start",width:"100%",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e(ta,{children:JSON.stringify(y)})]})}):null]})}):null]})}const Q0=["irrelevant","unrelated"];function Pl({document:n,documentEvaluations:a,backgroundColor:t,borderColor:l,tokenColor:i}){const r=n[Ga.metadata],o=a&&a.length,d=n[Ga.content];return e(q,{...Te,backgroundColor:t,borderColor:l,bodyStyle:{padding:0},title:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(Mr,{})}),s(oe,{level:4,children:["document ",n[Ga.id]]})]}),extra:typeof n[Ga.score]=="number"&&e(La,{color:i,children:`score ${ql(n[Ga.score])}`}),children:s(h,{direction:"column",children:[d&&e(C,{padding:"size-200",children:e(Oa,{children:d})}),r&&e(U,{children:s(C,{borderColor:l,borderTopWidth:"thin",children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:l,borderBottomWidth:"thin",children:e(oe,{level:4,children:"Document Metadata"})}),e(ta,{basicSetup:{lineNumbers:!1},children:JSON.stringify(r)})]})}),o&&e(C,{borderColor:l,borderTopWidth:"thin",padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(oe,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((c,p)=>{const f=c.label&&Q0.includes(c.label)?"var(--ac-global-color-danger)":i;return e("li",{children:e(C,{padding:"size-200",borderWidth:"thin",borderColor:l,borderRadius:"medium",children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(v,{weight:"heavy",elementType:"h5",children:c.name}),c.label&&e(La,{color:f,children:c.label}),typeof c.score=="number"&&e(La,{color:f,children:s(h,{direction:"row",gap:"size-50",children:[e(v,{size:"XS",weight:"heavy",color:"inherit",children:"score"}),e(v,{size:"XS",children:Gn(c.score)})]})})]}),typeof c.explanation&&e("p",{css:F`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:c.explanation})]})})},p)})})]})})]})})}function j0({message:n}){var d;const a=n[Qe.content],t=n[Qe.contents],l=((d=n[Qe.tool_calls])==null?void 0:d.map(c=>c[me.tool_call]).filter(Boolean))||[],i=n[Qe.function_call_arguments_json]&&n[Qe.function_call_name],r=n[Qe.role]||"unknown",o=ht(r);return e(rn,{children:s(q,{...Te,...o,title:r+(n[Qe.name]?`: ${n[Qe.name]}`:""),extra:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Kn,{}),e(ce,{text:a||JSON.stringify(n)})]}),children:[e(qt,{children:t?e(C,{padding:"size-200",children:e(G0,{messageContents:t})}):null}),s(h,{direction:"column",alignItems:"start",children:[a?e(C,{padding:"size-200",children:e(Oa,{children:a})}):null,l.length>0?l.map((c,p)=>{var u,g,y;const f=Ve((u=c==null?void 0:c.function)==null?void 0:u.arguments);return s("pre",{css:F`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                      padding: var(--ac-global-dimension-static-size-200);
                    `,children:[(g=c==null?void 0:c.function)==null?void 0:g.name,"(",f.json?JSON.stringify(f.json,null,2):`${(y=c==null?void 0:c.function)==null?void 0:y.arguments}`,")"]},p)}):null,i?s("pre",{css:F`
                text-wrap: wrap;
                margin: var(--ac-global-dimension-static-size-100) 0;
              `,children:[n[Qe.function_call_name],"(",JSON.stringify(JSON.parse(n[Qe.function_call_arguments_json]),null,2),")"]}):null]})]})})}function q0({toolSchema:n,index:a}){return e(q,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Bl,{spanKind:"tool"}),e(v,{weight:"heavy",children:"Tool"})]}),titleExtra:s(yn,{children:["#",a+1]}),...Te,backgroundColor:"yellow-100",borderColor:"yellow-700",bodyStyle:{padding:0},extra:e(ce,{text:n}),children:e(Vn,{value:n,mimeType:"json"})})}function Ji({messages:n}){return e("ul",{css:F`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e(j0,{message:a})},t))})}function B0({toolSchemas:n}){return e("ul",{css:F`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e(q0,{toolSchema:a,index:t})},t))})}function U0({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:F`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,t)=>e("li",{children:e(C,{backgroundColor:"grey-100",borderColor:"grey-500",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(Tt,{text:a,children:e(Vn,{value:a,mimeType:"text"})})})},t))})}const H0=F`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function G0({messageContents:n}){return e("ul",{css:H0,"data-testid":"message-content-list",children:n.map((a,t)=>e(J0,{messageContentAttribute:a},t))})}const W0=F`
  flex: 1 1 100%;
`;function J0({messageContentAttribute:n}){var r;const{message_content:a}=n,t=a==null?void 0:a.text,l=a==null?void 0:a.image,i=(r=l==null?void 0:l.image)==null?void 0:r.url;return s("li",{css:t?W0:null,children:[t?e("pre",{css:F`
            white-space: pre-wrap;
            padding: 0;
            margin: 0;
          `,children:t}):null,i?e(P0,{url:i}):null]})}function dd({span:n}){const{input:a,output:t}=n,l=a==null&&t==null,i=(a==null?void 0:a.mimeType)==="text",r=(t==null?void 0:t.mimeType)==="text";return s(h,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(rn,{children:e(q,{title:"Input",...Te,extra:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[i?e(Kn,{}):null,e(ce,{text:a.value})]}),children:e(Vn,{...a})})}):null,t&&t.value!=null?e(rn,{children:e(q,{title:"Output",...Te,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[r?e(Kn,{}):null,e(ce,{text:t.value})]}),children:e(Vn,{...t})})}):null,l?e(q,{title:"All Attributes",titleExtra:ud,...Te,extra:e(ce,{text:n.attributes}),children:e(ta,{children:n.attributes})}):null]})}const Z0=F`
  width: 100%;
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function Tt({text:n,children:a,padding:t}){const l=t?`var(--ac-global-dimension-${t})`:"0";return s("div",{css:F`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${l};
          top: ${l};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(ce,{text:n}),a]})}function ta({children:n,basicSetup:a={}}){const{theme:t}=$n(),l=t==="light"?da:ca,{value:i,mimeType:r}=m.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return r==="json"?e(ua,{value:i,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,...a},extensions:[oy.json(),ds.lineWrapping],editable:!1,theme:l,css:Z0}):e(cd,{children:i})}function cd({children:n}){return e("pre",{"data-testid":"pre-block",css:F`
        white-space: pre-wrap;
        padding: var(--ac-global-dimension-static-size-200);
        font-size: var(--ac-global-font-size-s);
      `,children:n})}function Vn({value:n,mimeType:a}){let t;switch(a){case"json":t=e(ta,{children:n});break;case"text":t=e(C,{margin:"size-200",children:e(Oa,{children:n})});break;default:ve()}return t}function X0({text:n}){return s(h,{direction:"column",alignItems:"center",flex:"1 1 auto",height:"size-2400",justifyContent:"center",gap:"size-100",children:[e(Rt,{graphicKey:"documents"}),e(v,{children:n})]})}function Y0({events:n}){return n.length===0?e(X0,{text:"No events"}):e(Et,{children:n.map((a,t)=>{const l=a.name==="exception";return e(wt,{children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(C,{flex:"none",children:e("div",{"data-event-type":l?"exception":"info",css:F`
                    &[data-event-type="exception"] {
                      --px-event-icon-color: var(--ac-global-color-danger);
                    }
                    &[data-event-type="info"] {
                      --px-event-icon-color: var(--ac-global-color-info);
                    }
                    .ac-icon-wrap {
                      color: var(--px-event-icon-color);
                    }
                  `,children:e(L,{svg:l?e(Hp,{}):e(Mn,{})})})}),s(h,{direction:"column",gap:"size-25",flex:"1 1 auto",children:[e(v,{weight:"heavy",children:a.name}),e(v,{color:"text-700",children:a.message})]}),e(C,{children:e(v,{color:"text-700",children:new Date(a.timestamp).toLocaleString()})})]})},t)})})}const ud=e(h,{alignItems:"center",justifyContent:"center",children:e(C,{marginStart:"size-100",children:s(Aa,{children:[e(oe,{weight:"heavy",level:4,children:"Span Attributes"}),e(ia,{children:e(v,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."})}),e("footer",{children:e(ln,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]})})}),md=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"660fcce54b17ff01056ef96c4dcb3c35",id:null,metadata:{},name:"TraceHeaderRootSpanAnnotationsQuery",operationKind:"query",text:`query TraceHeaderRootSpanAnnotationsQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      spanAnnotations {
        name
        label
        score
        annotatorKind
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();md.hash="d506d0235a1602f740af082698950c65";function ek({spanId:n}){const t=x.useLazyLoadQuery(md,{spanId:n},{fetchPolicy:"store-and-network"}).span.spanAnnotations??[];return t.length>0?s(h,{direction:"column",gap:"size-50",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Feedback"}),e(h,{direction:"row",gap:"size-50",children:t.map(i=>e(za,{annotation:i,children:e(zn,{annotation:i,annotationDisplayPreference:"label"})},i.name))})]}):null}const hl="selectedSpanNodeId";function nk(n){const a=n.find(i=>i.parentId==null);if(a)return a;const t=new Set(n.map(i=>i.spanId)),l=n.filter(i=>i.parentId!=null&&!t.has(i.parentId));return l.length===1?l[0]:null}function gi(n){var u,g;const{traceId:a,projectId:t}=n,[l,i]=In(),r=x.useLazyLoadQuery(ed,{traceId:a,id:t},{fetchPolicy:"store-and-network"}),o=((u=r.project.trace)==null?void 0:u.latencyMs)!=null?r.project.trace.latencyMs:null,d=m.useMemo(()=>{var k;return(((k=r.project.trace)==null?void 0:k.spans.edges)||[]).map(b=>b.span)},[r]),p=l.get(hl)??d[0].id,f=m.useMemo(()=>nk(d),[d]);return m.useEffect(()=>()=>{i(y=>(y.delete(hl),y),{replace:!0})},[]),s("main",{css:F`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(ak,{rootSpan:f,latencyMs:o,sessionId:(g=r.project.trace)==null?void 0:g.projectSessionId}),s(pn,{direction:"horizontal",autoSaveId:"trace-panel-group",css:F`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(_e,{defaultSize:30,minSize:5,children:e(lk,{children:e(Wp,{spans:d,selectedSpanNodeId:p,onSpanClick:y=>{i(k=>(k.set(hl,y.id),k),{replace:!0})}})})}),e(vn,{css:Bt}),e(_e,{children:e(tk,{children:p?e(m.Suspense,{fallback:e(Ce,{}),children:e(w0,{spanNodeId:p})}):null})})]})]})}function ak({rootSpan:n,latencyMs:a,sessionId:t}){const{projectId:l}=Be(),{statusCode:i}=n??{statusCode:"UNSET"},r=Jp(i);return e(C,{paddingTop:"size-100",paddingBottom:"size-150",paddingX:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",alignItems:"center",css:F`
          box-sizing: content-box;
        `,children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Trace Status"}),e(v,{size:"XL",children:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(jt,{statusCode:i}),e(v,{size:"L",color:r,children:i})]})})]}),s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency"}),e(v,{size:"XL",children:typeof a=="number"?e(Me,{latencyMs:a,size:"L"}):"--"})]}),n?e(ek,{spanId:n.id}):null,t&&e("span",{css:F`
              margin-left: auto;
            `,children:e(Ta,{size:"S",variant:"primary",to:`/projects/${l}/sessions/${t}`,children:"View Session"})})]})})}function tk({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:F`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function lk({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:F`
        height: 100%;
        overflow-y: auto;
      `,children:n})}const il=()=>{const{projectId:n}=Be();if(!n)throw new Error("projectId is required");const t=mt().pathname.split("/"),l=t.indexOf(n);if(l===-1)throw new Error("projectId not found in path");const i=t.slice(0,l+1).join("/"),r=t[l+1];return{rootPath:i,tab:r}};function o2(){const{traceId:n,projectId:a}=Be(),t=ue(),{rootPath:l,tab:i}=il();return e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`${l}/${i}`),children:e(X,{size:"fullscreen",title:"Trace Details",children:e(gi,{traceId:n,projectId:a})})})}function pd({traceId:n,projectId:a,title:t}){return e(X,{title:t,size:"fullscreen",extra:e(Ta,{size:"S",to:`/projects/${a}/traces/${n}`,children:"View Trace in Project"}),children:e(gi,{traceId:n,projectId:a})})}const ik=n=>{const a=n;return ea(a.function)?typeof a.function.arguments=="string":!1};function gd({toolCall:n}){const a=m.useMemo(()=>{const{provider:t,validatedToolCall:l}=Zp(n);switch(t){case"OPENAI":case"AZURE_OPENAI":return{name:l.function.name,input:l.function.arguments};case"ANTHROPIC":return{name:l.name,input:l.input};case"UNKNOWN":{if(!ik(n))return null;const{json:i}=Ve(n.function.arguments);return{name:n.function.name??"",input:ea(i)?i:n.function.arguments}}default:return ve()}},[n]);return a==null?s(v,{children:["Invalid tool call format: ",JSON.stringify(n)]}):s("pre",{css:F`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const rk=10,sk=n=>n.examples.reduce((a,t)=>{const{datasetExampleId:l,result:i,experimentRunId:r}=t,o={experimentRunId:r};switch(i.__typename){case"ChatCompletionMutationError":return{...a,[l]:{...o,errorMessage:i.message}};case"ChatCompletionMutationPayload":{const{errorMessage:d,content:c,span:p,toolCalls:f}=i;return{...a,[l]:{...o,span:p,content:c,errorMessage:d,toolCalls:f.reduce((u,g)=>(u[g.id]=g,u),{})}}}case"%other":return a;default:ve()}},{}),ok=F`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  min-height: 75px;
  padding: var(--ac-global-dimension-static-size-200);
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    button {
      border-color: var(--ac-global-color-primary);
    }
  }
`,dk=F`
  position: absolute;
  top: -4px;
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function yd(n){return s("div",{css:ok,children:[n.children,e("div",{css:dk,className:"controls",children:n.controls})]})}function fd({children:n}){return e("div",{css:F`
        max-height: 300px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-200);
      `,children:n})}function ck({getValue:n,collapseSingleKey:a}){const t=n();return e(fd,{children:e($a,{json:t,space:2,collapseSingleKey:a})})}function uk({isRunning:n,instanceVariables:a,datasetExampleInput:t}){const l=m.useMemo(()=>{const i=ea(t)?t:{};return a.filter(r=>i[r]==null)},[t,a]);return n?e(Ce,{}):l.length===0?null:e(pi,{children:`Missing input for variable${l.length>1?"s":""}: ${l.join(", ")}`})}function mk({exampleData:n,setDialog:a}){const{span:t,content:l,toolCalls:i,errorMessage:r,experimentRunId:o}=n,d=t!=null,c=o!=null,p=m.useMemo(()=>{if(d||c)return s(U,{children:[c&&s(Se,{children:[e(M,{size:"S","aria-label":"View experiment run details",leadingVisual:e(L,{svg:e(ot,{})}),onPress:()=>{m.startTransition(()=>{a(e(d0,{runId:o}))})}}),e(Ne,{children:"View run details"})]}),d&&e(U,{children:s(Se,{children:[e(M,{size:"S","aria-label":"View run trace",leadingVisual:e(L,{svg:e(Qt,{})}),onPress:()=>{m.startTransition(()=>{a(e(pd,{traceId:t.context.traceId,projectId:t.project.id,title:"Experiment Run Trace"}))})}}),e(Ne,{children:"View Trace"})]})})]})},[o,c,d,a,t]);return e(yd,{controls:p,children:s(h,{direction:"column",gap:"size-200",children:[r!=null?e(pi,{children:r}):null,e(v,{children:l}),i!=null?Object.values(i).map(f=>f==null?null:e(gd,{toolCall:f},f.id)):null,d?e(gk,{span:t}):null]})})}const pk=m.memo(function({isRunning:a,instanceId:t,exampleId:l,setDialog:i,instanceVariables:r,datasetExampleInput:o}){const d=xa(c=>{var p;return(p=c.exampleResponsesMap[t])==null?void 0:p[l]});return d==null?e(uk,{isRunning:a,instanceVariables:r,datasetExampleInput:o}):e(mk,{exampleData:d,setDialog:i})});function gk({span:n}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(oa,{tokenCountTotal:n.tokenCountTotal||0,tokenCountPrompt:n.tokenCountPrompt||0,tokenCountCompletion:n.tokenCountCompletion||0}),e(Me,{latencyMs:n.latencyMs||0})]})}function hd({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{padding:0,height:1,width:`calc(var(--col-${t.column.id}-size) * 1px)`,wordBreak:"break-all"},children:Z(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const yk=pe.memo(hd,(n,a)=>n.table.options.data===a.table.options.data);function fk({datasetId:n}){const a=x.useRelayEnvironment(),t=O(j=>j.instances),l=O(j=>j.allInstanceMessages),i=O(j=>j.templateFormat),r=O(j=>j.updateInstance),o=xa(j=>j.updateExampleData),d=xa(j=>j.setExampleDataForInstance),c=xa(j=>j.resetExampleData),p=xa(j=>j.appendExampleDataToolCallChunk),f=xa(j=>j.appendExampleDataTextChunk),[u,g]=m.useState(null),[,y]=In(),k=t.some(j=>j.activeRunId!==null),b=Ma(j=>j),S=O(j=>j.markPlaygroundInstanceComplete),K=Ua(),T=Pe(),D=m.useCallback(j=>ee=>{var Ie;if(ee==null)return;const te=ee.chatCompletionOverDataset;switch(te.__typename){case"ChatCompletionSubscriptionExperiment":r({instanceId:j,patch:{experimentId:te.experiment.id},dirty:null});break;case"ChatCompletionSubscriptionResult":if(te.datasetExampleId==null)return;o({instanceId:j,exampleId:te.datasetExampleId,patch:{span:te.span,experimentRunId:(Ie=te.experimentRun)==null?void 0:Ie.id}});break;case"ChatCompletionSubscriptionError":if(te.datasetExampleId==null)return;o({instanceId:j,exampleId:te.datasetExampleId,patch:{errorMessage:te.message}});break;case"TextChunk":if(te.datasetExampleId==null)return;f({instanceId:j,exampleId:te.datasetExampleId,textChunk:te.content});break;case"ToolCallChunk":{if(te.datasetExampleId==null)return;p({instanceId:j,exampleId:te.datasetExampleId,toolCallChunk:te});break}case"%other":return;default:return ve()}},[f,p,o,r]),[w]=x.useMutation(Ho),P=m.useCallback(j=>(ee,te)=>{if(S(j),te){T({title:"Chat completion failed",message:te[0].message});return}r({instanceId:j,patch:{experimentId:ee.chatCompletionOverDataset.experimentId},dirty:null}),d({instanceId:j,data:sk(ee.chatCompletionOverDataset)})},[S,T,d,r]);m.useEffect(()=>{if(!k)return;const{instances:j,streaming:ee,updateInstance:te}=K.getState();if(c(),ee){const Ie=[];for(const I of j){const{activeRunId:A}=I;if(te({instanceId:I.id,patch:{experimentId:null},dirty:null}),A===null)continue;const B={input:Ni({credentials:b,instanceId:I.id,playgroundStore:K,datasetId:n})},G={subscription:Go,variables:B,onNext:D(I.id),onCompleted:()=>{S(I.id)},onError:Un=>{S(I.id);const Ha=Ar(Un);Ha!=null&&Ha.length>0?T({title:"Failed to get output",message:Ha.join(`
`),expireMs:1e4}):T({title:"Failed to get output",message:Un.message,expireMs:1e4})}},fn=pt.requestSubscription(a,G);Ie.push(fn)}return()=>{for(const I of Ie)I.dispose()}}else{const Ie=[];for(const I of j){const{activeRunId:A}=I;if(A===null)continue;te({instanceId:I.id,patch:{experimentId:null},dirty:null});const B={input:Ni({credentials:b,instanceId:I.id,playgroundStore:K,datasetId:n})},G=w({variables:B,onCompleted:P(I.id),onError(fn){S(I.id);const Un=De(fn);Un!=null&&Un.length>0?T({title:"Failed to get output",message:Un.join(`
`),expireMs:1e4}):T({title:"Failed to get output",message:fn.message,expireMs:1e4})}});Ie.push(G)}return()=>{for(const I of Ie)I.dispose()}}},[b,n,a,w,k,S,T,P,D,K,c]);const{dataset:_}=x.useLazyLoadQuery(Zo,{datasetId:n}),z=m.useRef(null),{data:R,loadNext:Q,hasNext:V,isLoadingNext:$}=x.usePaginationFragment(Jo,_),N=m.useMemo(()=>R.examples.edges.map(j=>{const ee=j.example,te=ee.revision;return{id:ee.id,input:te.input,output:te.output}}),[R]),le=m.useMemo(()=>t.map((j,ee)=>{const te=Yt(j,l),Ie=Ks({instance:te,templateFormat:i});return{id:`instance-${j.id}`,header:()=>s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ul,{index:ee}),e("span",{children:"Output"})]}),cell:({row:I})=>e(pk,{instanceId:j.id,exampleId:I.original.id,isRunning:k,setDialog:g,instanceVariables:Ie,datasetExampleInput:I.original.input}),size:500}}),[k,t,i,l]),re=[{header:"input",accessorKey:"input",cell:({row:j})=>e(yd,{controls:s(Se,{children:[e(M,{size:"S","aria-label":"View example details",leadingVisual:e(L,{svg:e(ot,{})}),onPress:()=>{y(ee=>(ee.set("exampleId",j.original.id),ee))}}),e(Ne,{children:"View Example"})]}),children:e(fd,{children:e($a,{json:j.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})}),size:200},{header:"reference output",accessorKey:"output",cell:j=>ck({...j,collapseSingleKey:!0}),size:200},...le],ke=Le({columns:re,data:N,getCoreRowModel:we(),columnResizeMode:"onChange"}),Bn=ke.getRowModel().rows.length===0,ga=m.useCallback(j=>{if(j){const{scrollHeight:ee,scrollTop:te,clientHeight:Ie}=j;ee-te-Ie<300&&!$&&V&&Q(rk)}},[V,$,Q]),ya=pe.useMemo(()=>{const j=ke.getFlatHeaders(),ee={};for(let te=0;te<j.length;te++){const Ie=j[te];ee[`--header-${Ie.id}-size`]=Ie.getSize(),ee[`--col-${Ie.column.id}-size`]=Ie.column.getSize()}return ee},[ke.getState().columnSizingInfo,ke.getState().columnSizing,re.length]);return s("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:z,onScroll:j=>ga(j.target),children:[s("table",{css:F(sn,Vr),style:{...ya,width:ke.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:ke.getHeaderGroups().map(j=>e("tr",{children:j.headers.map(ee=>s("th",{style:{width:`calc(var(--header-${ee==null?void 0:ee.id}-size) * 1px)`},children:[e("div",{children:Z(ee.column.columnDef.header,ee.getContext())}),e("div",{onMouseDown:ee.getResizeHandler(),onTouchStart:ee.getResizeHandler(),className:`resizer ${ee.column.getIsResizing()?"isResizing":""}`})]},ee.id))},j.id))}),Bn?e(cn,{}):ke.getState().columnSizingInfo.isResizingColumn?e(yk,{table:ke}):e(hd,{table:ke})]}),e(ae,{isDismissable:!0,type:"slideOver",onDismiss:()=>{g(null)},children:u})]})}function hk({datasetId:n}){const a=O(o=>o.instances),t=a.some(o=>o.activeRunId!=null),l=m.useMemo(()=>a.map(o=>o.experimentId).filter(o=>o!=null),[a]),i=ue(),r=x.useLazyLoadQuery(Uo,{datasetId:n});return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",height:50,children:s(h,{justifyContent:"space-between",alignItems:"center",height:"100%",children:[s(h,{gap:"size-100",children:[s(v,{children:[r.dataset.name??"Dataset"," results"]}),r.dataset.exampleCount!=null?s(v,{fontStyle:"italic",color:"text-700",children:[r.dataset.exampleCount," examples"]}):null]}),l.length>0&&s(M,{size:"S",isDisabled:t,leadingVisual:e(L,{svg:t?e(We,{}):e(zr,{})}),onPress:()=>{i(`/datasets/${n}/compare?experimentId=${l.join("&experimentId=")}`)},children:["View Experiment",a.length>1?"s":""]})]})}),e(o0,{children:e(fk,{datasetId:n})})]})}const kk=()=>{const n=O(d=>d.input),a=O(d=>d.instances),t=O(d=>d.allInstanceMessages),l=O(d=>d.templateFormat),i=m.useMemo(()=>a.map(d=>Yt(d,t)),[a,t]),{variableKeys:r,variablesMap:o}=m.useMemo(()=>Ts({instances:i,templateFormat:l,input:n}),[n,i,l]);return{variableKeys:r,variablesMap:o}},bk={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,defaultKeymap:!1},Sk=[ds.lineWrapping,ei.of([...dy.filter(n=>n.key!=="Mod-Enter")])],vk=({label:n,defaultValue:a,onChange:t})=>{const{theme:l}=$n(),i=m.useRef(a),[r,o]=m.useState(0),[d,c]=m.useState(()=>a);return m.useEffect(()=>{a==null&&(c(""),o(f=>f+1)),i.current=a},[a]),m.useEffect(()=>{c(i.current),o(f=>f+1)},[n]),e(ra,{label:n,children:e(Xe,{width:"100%",children:e(ua,{theme:l==="light"?da:ca,basicSetup:bk,value:d,extensions:Sk,onChange:t},r)})})};function Ck(){const{variableKeys:n,variablesMap:a}=kk(),t=O(i=>i.setVariableValue),l=O(i=>i.templateFormat);if(n.length===0){let i="";switch(l){case en.FString:{i="{input name}";break}case en.Mustache:{i="{{input name}}";break}case en.NONE:return null;default:ve()}return e(C,{padding:"size-100",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",children:s(v,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(v,{color:"text-900",children:i})," within your prompt template."]})})})}return e(h,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(vk,{label:i,defaultValue:a[i]??"",onChange:o=>t(i,o)},r))})}const kd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:t},params:{cacheID:"9dc63d3e40081b276c1cbd5f21405c6f",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    content
    errorMessage
    span {
      id
    }
    toolCalls {
      id
      function {
        name
        arguments
      }
    }
  }
}
`}}}();kd.hash="085e7cb2bebd2c6c6e44b511364c6dd9";const bd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:t,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:t},params:{cacheID:"aca7bf342ad2dc5db66b07e236a68268",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}}();bd.hash="bb5936a61a0e99dbb4a298a6e552a01c";const Fk=({instance:n,outputContent:a,toolCalls:t,cleanupOutput:l})=>{const i=n.id,r=O(o=>o.addMessage);return s(Se,{delay:500,offset:10,children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(Dn,{})}),"aria-label":"Move the output message to the end of the prompt",onPress:()=>{if(n.template.__type!=="chat")return;const o=Array.isArray(a)?a:a?[{id:Zn(),role:Wn("ai"),content:a}]:[];t.length>0&&o.push({id:Zn(),role:Wn("ai"),toolCalls:Nr({provider:n.model.provider,toolCalls:t.map(d=>{var c;return{...d,function:{...d.function,arguments:((c=Ve(d.function.arguments))==null?void 0:c.json)??d.function.arguments}}})})}),r({playgroundInstanceId:i,messages:o}),l()},children:"Prompt"}),e(Ne,{children:"Move the output message to the end of the prompt"})]})},Sd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"447ee90c4f55ded6a8a64e73fc30c065",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      spanId
      trace {
        id
        traceId
        project {
          id
        }
      }
      tokenCountCompletion
      tokenCountPrompt
      tokenCountTotal
      latencyMs
    }
  }
}
`}}}();Sd.hash="d8025b7f870ac81e2d1e3249bb818186";function Kk({spanId:n}){const[a,t]=m.useState(null),l=x.useLazyLoadQuery(Sd,{spanId:n},{fetchPolicy:"store-and-network"});if(!l.span||!l.span.trace||!l.span.trace.project)return null;const{trace:i}=l.span;return s(C,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:[s(h,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(oa,{tokenCountTotal:l.span.tokenCountTotal||0,tokenCountPrompt:l.span.tokenCountPrompt||0,tokenCountCompletion:l.span.tokenCountCompletion||0}),e(Me,{latencyMs:l.span.latencyMs||0})]}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(gt,{})}),onPress:()=>t(e($r,{spanNodeId:n,projectId:i.project.id})),children:"Annotate"}),e(M,{size:"S",leadingVisual:e(L,{svg:e(Qt,{})}),onPress:()=>{m.startTransition(()=>{t(e(m.Suspense,{children:e(pd,{traceId:i.traceId,projectId:i.project.id,title:"Playground Trace"})}))})},children:"View Trace"})]})]}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(null),children:a})]})}function Tk({index:n,title:a}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ul,{index:n}),e("span",{children:a})]})}const Pk=n=>ea(n)&&(typeof n.id=="string"||typeof n.id=="number")?n.id:JSON.stringify(n);function Zi({message:n}){const{role:a,content:t,toolCalls:l}=n,i=ht(a);return s(q,{title:a,...i,variant:"compact",extra:e(Kn,{}),children:[t!=null&&!Array.isArray(t)&&e(Oa,{children:t}),l&&l.length>0?l.map(r=>e(gd,{toolCall:r},Pk(r))):null]})}function Ik({content:n,partialToolCalls:a}){return Zy(n)?n.map((t,l)=>e(Zi,{message:t},l)):typeof n=="string"||a.length>0?e(Zi,{message:{id:Zn(),content:n,role:"ai",toolCalls:a}}):"click run to see output"}function xk(n){const a=n.playgroundInstanceId,t=O(V=>V.instances),l=O(V=>V.streaming),i=Ma(V=>V),r=O(V=>V.instances.findIndex($=>$.id===a)),o=t.find(V=>V.id===a),d=O(V=>V.updateInstance),[c,p]=m.useState(null),f=O(V=>V.markPlaygroundInstanceComplete),u=x.useRelayEnvironment(),g=Ua();if(!o)throw new Error(`No instance found for id ${a}`);if(o.template.__type!=="chat")throw new Error("We only support chat templates for now");const[y,k]=m.useState(!1),[b]=x.useMutation(kd),S=(o==null?void 0:o.activeRunId)!=null,K=Pe(),T=m.useCallback(({title:V,message:$,...N})=>{p({title:V,message:$}),K({title:V,message:$,...N})},[K]),[D,w]=m.useState(o.output),[P,_]=m.useState([]),z=m.useCallback(({chatCompletion:V})=>{if(k(!1),V.__typename==="TextChunk"){const $=V.content;w(N=>N!=null?N+$:$);return}else if(V.__typename==="ToolCallChunk"){_($=>{let N=!1;const le=$.map(re=>re.id===V.id?(N=!0,{...re,function:{...re.function,arguments:re.function.arguments+V.function.arguments}}):re);return N||le.push({id:V.id,function:{name:V.function.name,arguments:V.function.arguments}}),le});return}if(V.__typename==="ChatCompletionSubscriptionResult"&&V.span!=null){d({instanceId:a,patch:{spanId:V.span.id},dirty:null});return}V.__typename==="ChatCompletionSubscriptionError"&&(f(n.playgroundInstanceId),V.message!=null&&T({title:"Chat completion failed",message:V.message}))},[a,f,T,n.playgroundInstanceId,d]),R=m.useCallback((V,$)=>{if(k(!1),f(n.playgroundInstanceId),d({instanceId:a,patch:{spanId:V.chatCompletion.span.id},dirty:null}),$){T({title:"Chat completion failed",message:$[0].message});return}if(V.chatCompletion.errorMessage!=null){T({title:"Chat completion failed",message:V.chatCompletion.errorMessage});return}w(V.chatCompletion.content??void 0),_(V.chatCompletion.toolCalls)},[a,f,T,n.playgroundInstanceId,d]),Q=m.useCallback(()=>{w(void 0),_([]),p(null),d({instanceId:a,patch:{spanId:null},dirty:null})},[a,d]);return m.useEffect(()=>{if(!S){k(!1);return}k(!0),Q();const V=rf({playgroundStore:g,instanceId:a,credentials:i});if(l){const N={subscription:bd,variables:{input:V},onNext:re=>{re&&z(re)},onCompleted:()=>{k(!1),f(n.playgroundInstanceId)},onError:re=>{k(!1),f(n.playgroundInstanceId);const ke=Ar(re);ke!=null&&ke.length>0?T({title:"Failed to get output",message:ke.join(`
`)}):T({title:"Failed to get output",message:re.message})}};return pt.requestSubscription(u,N).dispose}return b({variables:{input:V},onCompleted:R,onError(N){k(!1),f(n.playgroundInstanceId);const le=De(N);le!=null&&le.length>0?T({title:"Failed to get output",message:le.join(`
`)}):T({title:"Failed to get output",message:N.message})}}).dispose},[Q,i,u,b,S,a,f,T,R,z,g,n.playgroundInstanceId,l,d]),e(q,{title:e(Tk,{index:r,title:"Output"}),extra:D!=null||(P==null?void 0:P.length)>0?e(Fk,{outputContent:D,toolCalls:P,instance:o,cleanupOutput:Q}):null,titleSeparator:!0,collapsible:!0,variant:"compact",bodyStyle:{padding:0},children:y?e(C,{padding:"size-200",children:e(Ce,{message:"Running..."})}):c?e(C,{padding:"size-200",children:e(pi,{children:c.message})}):s(U,{children:[e(C,{padding:"size-200",children:e(rn,{children:e(Ik,{content:D,partialToolCalls:P})})}),e(m.Suspense,{children:o.spanId?e(Kk,{spanId:o.spanId}):null})]})})}function Dk(){return m.useMemo(()=>window.navigator.userAgent.toLowerCase().includes("mac")?"Cmd":"Ctrl",[])}function _k(){const n=Dk(),a=O(r=>r.runPlaygroundInstances),t=O(r=>r.cancelPlaygroundInstances),l=O(r=>r.instances.some(o=>o.activeRunId!=null)),i=m.useCallback(()=>{l?t():a()},[l,t,a]);return Tm("mod+enter",r=>{r.preventDefault(),r.stopPropagation(),i()},{enableOnFormTags:!0,enableOnContentEditable:!0,preventDefault:!0}),e(M,{variant:"primary",leadingVisual:e(L,{svg:l?e(We,{}):e(Ka,{})}),size:"S",onPress:()=>{i()},trailingVisual:s(Xp,{children:[e(Tl,{children:n}),e("span",{"aria-hidden":"true",children:n==="Cmd"?"":"Ctrl"}),e(Tl,{children:"enter"}),e("span",{"aria-hidden":"true",children:""})]}),children:l?"Cancel":"Run"})}function Lk(){const n=O(i=>i.streaming),a=O(i=>i.setStreaming),t=Fn(i=>i.setPlaygroundStreamingEnabled),l=O(i=>i.instances.some(r=>r.activeRunId!=null));return window.Config.websocketsEnabled===!1?null:e(Fa,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n),t(!n)},isDisabled:l,children:"Stream"})}const vd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPromptVersion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a},params:{cacheID:"5560d38314208ef482b716e9817358fe",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogUpdateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogUpdateMutation(
  $input: CreateChatPromptVersionInput!
) {
  createChatPromptVersion(input: $input) {
    id
    name
  }
}
`}}}();vd.hash="96205130072396cb213f4fa790a7a6b1";const Cd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a},params:{cacheID:"73d9d27e0df3bc27e4af4dd3d77f41fb",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogCreateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogCreateMutation(
  $input: CreateChatPromptInput!
) {
  createChatPrompt(input: $input) {
    id
    name
  }
}
`}}}();Cd.hash="fa52cba6c2bfaa6298a5360253dc9bc5";const Fd=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SavePromptFormQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SavePromptFormQuery",selections:n},params:{cacheID:"654725a48bf8fb568b8e05fd37696920",id:null,metadata:{},name:"SavePromptFormQuery",operationKind:"query",text:`query SavePromptFormQuery {
  prompts {
    edges {
      prompt: node {
        id
        name
      }
    }
  }
}
`}}}();Fd.hash="a9d184ea6bad7c7ff3b15460ce72b9fd";const Kd=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptComboBoxQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptComboBoxQuery",selections:n},params:{cacheID:"72f4804265380881fdc62b5d8e66bb8b",id:null,metadata:{},name:"PromptComboBoxQuery",operationKind:"query",text:`query PromptComboBoxQuery {
  prompts {
    edges {
      prompt: node {
        __typename
        id
        name
      }
    }
  }
}
`}}}();Kd.hash="1acc413e40da1ea527fb431f10b46cf2";function Td({onChange:n,container:a,promptId:t,...l}){const r=x.useLazyLoadQuery(Kd,{},{fetchPolicy:"store-and-network",fetchKey:t??void 0}).prompts.edges,o=m.useMemo(()=>r.map(d=>d.prompt),[r]);return e(Gl,{size:"M","data-testid":"prompt-picker",selectedKey:t??null,"aria-label":"prompt picker",width:"100%",menuTrigger:"focus",stopPropagation:!0,container:a,defaultItems:o,placeholder:"Select a prompt...",renderEmptyState:()=>e("div",{children:"No prompts found"}),onSelectionChange:d=>{if(!(typeof d!="string"&&d!=null)){if(d===t){n(null);return}n(d)}},...l,children:d=>e(Hl,{textValue:d.name,id:d.id,children:d.name},d.id)})}const wk=/^[a-z0-9]([_a-z0-9-]*[a-z0-9])?$/,Pd={value:wk,message:"Invalid identifier. Must be alphanumeric and with dashes or underscores"};function Ek({onCreate:n,onUpdate:a,isSubmitting:t=!1,defaultSelectedPromptId:l}){var D,w,P,_;const i=m.useRef(null),r=x.useLazyLoadQuery(Fd,{},{fetchPolicy:"network-only"}),[o,d]=m.useState(l??null),c=(w=(D=r==null?void 0:r.prompts)==null?void 0:D.edges)==null?void 0:w.find(z=>{var R;return((R=z==null?void 0:z.prompt)==null?void 0:R.id)===o}),[p,f]=m.useState(((P=c==null?void 0:c.prompt)==null?void 0:P.name)??""),u=c?"update":"create",g=u==="create"?"Create Prompt":"Update Prompt",{control:y,handleSubmit:k,formState:{isDirty:b,isValid:S},trigger:K}=Oe({values:{promptId:o??void 0,name:u==="update"&&c?(_=c==null?void 0:c.prompt)==null?void 0:_.name:p},defaultValues:{description:""},reValidateMode:"onChange",resetOptions:{keepDefaultValues:!0}}),T=m.useCallback(z=>{u==="create"?n(z):a(z)},[n,a,u]);return s(h,{direction:"column",gap:"size-100",ref:i,children:[e(C,{paddingX:"size-200",paddingTop:"size-200",children:e(W,{name:"name",control:y,rules:{required:{message:"Prompt is required",value:!0},pattern:Pd},render:({field:{onBlur:z,onChange:R},fieldState:Q})=>{var V;return e(Td,{label:"Prompt",description:"The prompt to update, or prompt name to create",placeholder:"Select or enter new prompt name",isRequired:!0,onBlur:z,defaultInputValue:p,onInputChange:$=>{f($),R($),K("name")},container:i.current??void 0,errorMessage:(V=Q.error)==null?void 0:V.message,allowsCustomValue:!0,onChange:$=>{R($),d($)},promptId:o})}})}),s(tn,{onSubmit:k(T),children:[e(C,{paddingX:"size-200",paddingBottom:"size-200",children:e(W,{name:"description",control:y,render:({field:{onChange:z,onBlur:R,value:Q},fieldState:{invalid:V,error:$}})=>s(Y,{isInvalid:V,onChange:z,onBlur:R,value:Q,size:"S",children:[e(J,{children:u==="create"?"Prompt Description":"Change Description"}),e(Ca,{}),$?e(xe,{children:$.message}):e(v,{slot:"description",children:u==="create"?"A description of your prompt (optional)":"A description of your changes to the prompt (optional)"})]})})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:b?"primary":"default",size:"S",isDisabled:t||!S,type:"submit",children:g})})})]})]})}const Xi=(n,a)=>{const t=a.getState(),l=t.allInstanceMessages,i=t.instances.find(c=>c.id===n);if(!i)throw new Error(`Instance ${n} not found`);const r=Yt(i,l),o=$h(r);if(!o)throw new Error(`Could not convert instance ${n} to prompt`);const d=t.templateFormat;return{promptInput:o,templateFormat:d}},Rk=({instanceId:n,setDialog:a,selectedPromptId:t})=>{const l=ue(),i=he(),r=Pe(),o=Ua(),[d,c]=x.useMutation(Cd),[p,f]=x.useMutation(vd),u=m.useCallback((k,b)=>{const S=o.getState();S.instances.find(T=>T.id===n)&&S.updateInstance({instanceId:n,patch:{prompt:{id:k,name:b}},dirty:!1})},[o,n]),g=m.useCallback(k=>{const{promptInput:b,templateFormat:S}=Xi(n,o);d({variables:{input:{name:k.name,description:k.description,promptVersion:{...b,templateFormat:S}}},onCompleted:K=>{i({title:"Prompt successfully created",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${K.createChatPrompt.id}`)}}}),u(K.createChatPrompt.id,K.createChatPrompt.name),a(null)},onError:K=>{const T=De(K);r({title:"Error creating prompt",message:T==null?void 0:T[0]}),a(null)}})},[d,n,l,r,i,u,a,o]),y=m.useCallback(k=>{if(!k.promptId)throw new Error("Prompt ID is required");const{promptInput:b,templateFormat:S}=Xi(n,o);p({variables:{input:{promptId:k.promptId,promptVersion:{...b,templateFormat:S,description:k.description}}},onCompleted:K=>{i({title:"Prompt successfully updated",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${K.createChatPromptVersion.id}`)}}}),u(K.createChatPromptVersion.id,K.createChatPromptVersion.name),a(null)},onError:K=>{const T=De(K);r({title:"Error updating prompt",message:T==null?void 0:T[0]}),a(null)}})},[n,l,r,i,a,o,p,u]);return e(X,{title:"Create Prompt from Template",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Ek,{onCreate:g,onUpdate:y,isSubmitting:c||f,defaultSelectedPromptId:t})})})},Id={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderPickerFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}]},params:{cacheID:"64ad561d3ca07bdded6af274c73eb18a",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery {
  ...ModelProviderPickerFragment
}

fragment ModelProviderPickerFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}};Id.hash="4b1b96842c19ea5721b7fcf1cdb86426";const at=1024,Mk=E.object({type:E.literal("enabled"),budget_tokens:E.number().min(at)}),Vk=({onChange:n,value:a})=>{const[t,l]=m.useState(0),r=Mk.safeParse(a).data,o=m.useRef(r==null?void 0:r.budget_tokens),d=p=>{n(p?{type:"enabled",budget_tokens:o.current||at}:null)},c=p=>{const f=p!=null&&!isNaN(p);o.current=f?p:at,n({type:"enabled",budget_tokens:o.current}),f||l(u=>u+1)};return s(U,{children:[e(Fa,{onChange:d,isSelected:(r==null?void 0:r.type)==="enabled",children:"Thinking Enabled"}),(r==null?void 0:r.type)==="enabled"&&s(Or,{value:r==null?void 0:r.budget_tokens,onChange:c,isDisabled:(r==null?void 0:r.type)!=="enabled",isRequired:!0,defaultValue:at,minValue:at,children:[e(J,{children:"Budget Tokens"}),e(se,{}),e(v,{slot:"description",children:"Determines how many tokens Claude can use for its internal reasoning process. Must be 1024 and less than max_tokens."})]},t)]})};function Ak({defaultValue:n,onChange:a,label:t,errorMessage:l}){const[i,r]=m.useState(n==null?"":Cn(n).json??""),o=m.useCallback(d=>{r(d);const{json:c}=Ve(d);c==null&&d!==""||a(c)},[a]);return e("div",{css:F`
        & .ac-view {
          width: 100%;
        }
      `,children:e(ra,{label:t,errorMessage:l,validationState:l?"invalid":void 0,children:e(Xe,{children:e(Ue,{value:i,onChange:o,optionalLint:!0})})})})}const zk=({field:n,value:a,onChange:t,errors:l,control:i})=>{var u;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const o=(u=l[r])==null?void 0:u.message,d=n.required?`${n.label||r} is required`:void 0,c=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,p=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0;if(n.canonicalName==="ANTHROPIC_EXTENDED_THINKING")return e(Vk,{onChange:t,value:a});const{__typename:f}=n;switch(f){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":return typeof a!="number"&&a!==void 0?null:e(eg,{label:n.label,defaultValue:a,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:g=>t(g),children:e(Yp,{})});case"FloatInvocationParameter":case"IntInvocationParameter":return e(W,{control:i,name:r,rules:{required:d,min:c,max:p},render:({field:{onBlur:g}})=>s(Or,{isRequired:n.required,value:Number(a),onBlur:g,onChange:y=>{t(y)},children:[e(J,{children:n.label}),e(se,{}),o?e(xe,{children:o}):null]})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(W,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(Y,{isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:g,onChange:y=>{if(y===""){t(void 0);return}t(y.split(/, */g))},children:[e(J,{children:n.label}),e(se,{}),o?e(xe,{children:o}):e(v,{slot:"description",children:"A comma separated list of strings"})]})});case"StringInvocationParameter":return e(W,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(Y,{isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:g,onChange:y=>{if(y===""){t(void 0);return}t(y)},children:[e(J,{children:n.label}),e(se,{}),o?e(xe,{children:o}):null]})});case"BooleanInvocationParameter":return e(Fa,{onChange:t,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(W,{control:i,name:r,rules:{required:d},render:()=>e(Ak,{defaultValue:a,onChange:t,label:n.label??n.invocationName??"",errorMessage:o})});default:return null}},Nk=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[Ba(n.invocationInputField)]},$k=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,[Ba(n.invocationInputField)]:a}},Ok=({instanceId:n})=>{const a=O(y=>y.instances.find(k=>k.id===n));if(!a)throw new Error("Instance not found");const{model:t}=a,l=O(y=>y.upsertInvocationParameterInput),i=O(y=>y.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,o=a.model.invocationParameters,d=m.useCallback((y,k)=>{if(!y.invocationName)throw new Error("Invocation name is required");k===void 0?i({instanceId:n,invocationParameterInputInvocationName:y.invocationName}):l({instanceId:n,invocationParameterInput:$k(y,k)})},[n,l,i]),c=m.useMemo(()=>r.filter(y=>!(y.canonicalName!=null&&Cy.includes(y.canonicalName))).reduce((y,k)=>{const b=o.find(K=>aa(K,k)),S=b?Nk(k,b):void 0;return{...y,[k.invocationName]:S??null}},{}),[o,r]),p=Oe({values:c,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),f=p.trigger,u=m.useMemo(()=>mn.debounce(f,250),[f]);return m.useEffect(()=>{u()},[c,u]),t.provider!=="AZURE_OPENAI"&&t.modelName===null?null:Object.entries(c).map(([y,k])=>{const b=r.find(K=>K.invocationName===y);if(!b)return null;const S=`${t.provider??"model"}-${b.invocationName}`;return e(zk,{field:b,value:k,onChange:K=>d(b,K),control:p.control,errors:p.formState.errors},S)})},yi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelComboBoxQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelComboBoxQuery",selections:a},params:{cacheID:"a3417a3b2ae9ad193a5fd68335cfd660",id:null,metadata:{},name:"ModelComboBoxQuery",operationKind:"query",text:`query ModelComboBoxQuery(
  $providerKey: GenerativeProviderKey!
) {
  models(input: {providerKey: $providerKey}) {
    name
  }
}
`}}}();yi.hash="fc5563c6dca10fdeda807cd7061e275a";function Qk({onChange:n,container:a,modelName:t,queryReference:l,...i}){const r=x.usePreloadedQuery(yi,l),o=m.useMemo(()=>r.models.map(u=>({name:u.name,id:u.name})),[r.models]),[d,c]=m.useState({selectedKey:t??null,inputValue:t??""}),p=u=>{if(typeof u=="string"){const g=o.find(y=>y.id===u);(g==null?void 0:g.name)!=null&&n(g.name)}},f=u=>{c(g=>({inputValue:u,selectedKey:g.selectedKey}))};return m.useEffect(()=>{c({selectedKey:t??null,inputValue:t??""})},[t]),e(Gl,{size:"L",label:"Model",isRequired:!0,"data-testid":"model-picker",selectedKey:d.selectedKey,"aria-label":"model picker",onInputChange:f,inputValue:d.inputValue,onSelectionChange:p,width:"100%",allowsCustomValue:!0,onBlur:()=>{d.inputValue!==""&&n(d.inputValue)},onKeyUp:u=>{u.key==="Enter"&&n(d.inputValue)},menuTrigger:"focus",container:a,description:"Choose a model from the list, or enter a custom model name",defaultItems:o,...i,children:u=>e(Hl,{textValue:u.name,id:u.id,children:u.name},u.id)})}function xd(n){const[a,t,l]=x.useQueryLoader(yi);return m.useEffect(()=>(t({providerKey:n.provider}),()=>l()),[l,t,n.provider]),a!=null?e(Qk,{queryReference:a,...n}):null}const Dd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderPickerFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Dd.hash="1d4ba7f81a958c9a17bd45dce0456ddb";function jk({onChange:n,query:a,...t}){var d,c;const l=x.useFragment(Dd,a),i=l.modelProviders.filter(p=>p.dependenciesInstalled),r=i.length!==l.modelProviders.length,o=t.provider&&!i.some(p=>p.key===t.provider);return s(h,{direction:"row",gap:"size-100",children:[e(Lt,{label:"Provider","data-testid":"model-provider-picker",selectedKey:t.provider??void 0,"aria-label":"Model Provider",placeholder:"Select a provider",onSelectionChange:p=>{const f=p;ad(f)&&n(f)},width:"100%",...t,children:l.modelProviders.map(p=>e(ie,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(At,{provider:p.key,height:16}),p.name]})},p.key))}),o?s(Se,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{color:"red-700",svg:e(Mn,{})})})}),s(Ne,{children:["The selected provider is not installed. Install"," ",((c=(d=l.modelProviders.find(p=>p.key===t.provider))==null?void 0:d.dependencies)==null?void 0:c.join(", "))??"the dependencies"," ","to use its models in Playground."]})]}):r?s(Se,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{svg:e(Mn,{})})})}),s(Ne,{children:["Some providers are missing dependencies. Install them to use their models in Playground.",e("br",{}),e("br",{}),"Missing providers:",e("br",{}),l.modelProviders.filter(p=>!p.dependenciesInstalled).map(p=>{var f;return s(U,{children:[((f=p.dependencies)==null?void 0:f.join(", "))??p.name,e("br",{})]})})]})]}):null]})}const qk=150,Bk=F`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  // Makes the filled slider track blue
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function Uk({instance:n,container:a}){const t=O(r=>r.updateModel),l=m.useCallback(({configKey:r,value:o})=>{t({instanceId:n.id,patch:{...n.model,[r]:o}})},[n.id,n.model,t]),i=m.useMemo(()=>yr(r=>{l({configKey:"modelName",value:r})},250),[l]);return s(U,{children:[e(xd,{modelName:n.model.modelName,provider:n.model.provider,onChange:r=>{i(r)},container:a??void 0}),s(Y,{defaultValue:n.model.baseUrl??"",onChange:r=>{l({configKey:"baseUrl",value:r})},children:[e(J,{children:"Base URL"}),e(se,{placeholder:"e.x. https://my-llm.com/v1"})]})]})}function Hk({instance:n,container:a}){const t=O(r=>r.updateModel),l=m.useCallback(({configKey:r,value:o})=>{t({instanceId:n.id,patch:{...n.model,[r]:o}})},[n.id,n.model,t]),i=m.useMemo(()=>yr(r=>{l({configKey:"modelName",value:r})},250),[l]);return s(U,{children:[s(Y,{defaultValue:n.model.modelName??"",onChange:r=>{i(r)},children:[e(J,{children:"Deployment Name"}),e(se,{placeholder:"e.x. azure-openai-deployment-name"})]}),s(Y,{defaultValue:n.model.endpoint??"",onChange:r=>{l({configKey:"endpoint",value:r})},children:[e(J,{children:"Endpoint"}),e(se,{placeholder:"e.x. https://my.openai.azure.com"})]}),e(Gl,{container:a??void 0,size:"L",label:"API Version","data-testid":"azure-api-version-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",inputValue:n.model.apiVersion??"",onInputChange:r=>{l({configKey:"apiVersion",value:r})},onSelectionChange:r=>{typeof r=="string"&&l({configKey:"apiVersion",value:r})},allowsCustomValue:!0,children:ng.map(r=>e(Hl,{textValue:r,id:r,children:r},r))})]})}function Gk(n){const[a,t]=m.useState(null),l=O(d=>d.instances.find(c=>c.id===n.playgroundInstanceId));if(!l)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const i=l.model.supportedInvocationParameters,r=l.model.invocationParameters,o=xs(r,i);return s(m.Fragment,{children:[e(M,{size:"S",onPress:()=>{m.startTransition(()=>{t(e(Wk,{...n}))})},leadingVisual:e(At,{provider:l.model.provider,height:16}),children:s(h,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(st,{maxWidth:qk,children:e(v,{children:l.model.modelName||"--"})}),o?null:s(Se,{delay:0,offset:5,children:[e("span",{children:e($e,{children:e(L,{color:"danger",svg:e(Mn,{})})})}),e(Ne,{children:"Some required invocation parameters are not configured."})]})]})}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>{t(null)},children:a})]})}function Wk(n){const a=O(r=>r.instances.find(o=>o.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const t=Fn(r=>r.setModelConfigForProvider),l=he(),i=m.useCallback(()=>{const{supportedInvocationParameters:r,...o}=a.model;t({provider:a.model.provider,modelConfig:o}),l({title:"Model Configuration Saved",message:`${Kl[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,l,t]);return e(X,{title:"Model Configuration",size:"M",extra:s(Se,{delay:0,offset:5,children:[e(M,{size:"S",variant:"default",onPress:i,leadingVisual:e(L,{svg:e(wr,{})}),children:"Save as Default"}),s(Ne,{children:["Saves the current configuration as the default for"," ",Kl[a.model.provider]??"this provider","."]})]}),children:e(m.Suspense,{children:e(Jk,{...n})})})}function Jk(n){const{playgroundInstanceId:a}=n,t=O(y=>y.instances.find(k=>k.id===a));if(!t)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=Fn(y=>y.modelConfigByProvider),i=O(y=>y.updateProvider),r=O(y=>y.updateModel),o=t.model.supportedInvocationParameters,d=t.model.invocationParameters,c=xs(d,o),p=x.useLazyLoadQuery(Id,{}),f=m.useCallback(y=>{r({instanceId:a,patch:{modelName:y}})},[a,r]),[u,g]=m.useState();return s("form",{css:Bk,children:[c?null:s(h,{direction:"row",gap:"size-100",children:[e(L,{color:"danger",svg:e(Mn,{})}),e(v,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e(jk,{provider:t.model.provider,query:p,onChange:y=>{i({instanceId:a,provider:y,modelConfigByProvider:l})}}),t.model.provider==="OPENAI"?e(Uk,{instance:t,container:u??null}):t.model.provider==="AZURE_OPENAI"?e(Hk,{instance:t,container:u??null}):e(xd,{modelName:t.model.modelName,provider:t.model.provider,onChange:f,container:u??void 0}),e(m.Suspense,{children:e(Ok,{instanceId:a})}),e("div",{ref:g})]})}const _d=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},t={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:l},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();_d.hash="8bf1a32724929bdc4a02d32809ba59d7";const Zk=({instanceId:n})=>{var p;const t=O(f=>f.instances).find(f=>f.id===n);if(!t)throw new Error("Instance not found");const l=t.model.provider,i=t.model.modelName,r=Fn(f=>f.modelConfigByProvider),o=O(f=>f.updateModelSupportedInvocationParameters),{modelInvocationParameters:d}=x.useLazyLoadQuery(_d,{input:{providerKey:l,modelName:i}}),c=(p=t.prompt)==null?void 0:p.id;return m.useEffect(()=>{o({instanceId:n,supportedInvocationParameters:d,modelConfigByProvider:r})},[d,n,o,r,c]),null},Ld=n=>a=>a.instances.find(t=>t.id===n),Il=n=>a=>a.allInstanceMessages[n];function Xk({playgroundInstanceId:n,messageId:a}){const t=m.useMemo(()=>Ld(n),[n]),l=O(t);if(l==null)throw new Error(`Instance ${n} not found`);const i=l.model.provider,r=Ua(),o=m.useMemo(()=>Il(a),[a]),d=O(o);if(d==null)throw new Error(`Message ${a} not found`);const c=d.toolCalls,p=O(k=>k.updateMessage),[f,u]=m.useState(()=>JSON.stringify(c,null,2));m.useEffect(()=>{const k=r.getState();if(k.instances.find(D=>D.id===n)==null)return;const S=Il(a)(k);if(S==null)return;const K=S.toolCalls,T=JSON.stringify(K,null,2);Wl({str:T,excludeNull:!0})&&u(T)},[i,r,n,a]);const g=m.useCallback(k=>{const{json:b}=Ve(k);p({instanceId:n,messageId:a,patch:{toolCalls:b}})},[n,a,p]),y=m.useMemo(()=>{switch(l.model.provider){case"OPENAI":case"AZURE_OPENAI":return tg;case"ANTHROPIC":return ag;case"GOOGLE":return null}},[l.model.provider]);return e(Ue,{value:f,jsonSchema:y,onChange:g})}function Yk(n){return n==="text"||n==="toolCalls"}function e1({messageMode:n,onChange:a}){return s(Jl,{selectedKeys:[n],size:"S","aria-label":"Message Mode",onSelectionChange:t=>{if(t.size===0)return;const l=t.keys().next().value;Yk(l)&&a(l)},children:[s(Se,{placement:"top",delay:0,offset:10,children:[e(Xn,{"aria-label":"text input",id:"text",children:e(L,{svg:e(Nl,{})})}),e(Ne,{children:"Text input"})]}),s(Se,{placement:"top",delay:0,offset:10,children:[e(Xn,{"aria-label":"tool calling",id:"toolCalls",children:e(L,{svg:e($l,{})})}),e(Ne,{children:"Tool calling"})]})]})}const n1=F`
  .ac-field-label {
    display: none;
  }
`;function a1({role:n,includeLabel:a=!0,onChange:t}){return s(Lt,{selectedKey:n,css:a?void 0:n1,label:"Role","data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"compact",onSelectionChange:l=>{if(!vs(l))throw new Error(`Invalid chat message role: ${l}`);t(l)},children:[e(ie,{children:"System"},"system"),e(ie,{children:"User"},"user"),e(ie,{children:"AI"},"ai"),e(ie,{children:"Tool"},"tool")]})}const t1=32;function l1({instanceId:n,hasResponseFormat:a}){const t=O(u=>u.instances),l=O(u=>u.updateInstance),i=O(u=>u.addMessage),r=O(u=>u.upsertInvocationParameterInput),o=t.find(u=>u.id===n);if(!o)throw new Error(`Playground instance ${n} not found`);const{template:d}=o;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const c=o.model.supportedInvocationParameters,p=c==null?void 0:c.some(u=>aa(u,{canonicalName:Sn,invocationName:kn})),f=c==null?void 0:c.some(u=>aa(u,{canonicalName:Yn,invocationName:Ea}));return s(h,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:t1,children:[p?e(M,{size:"S","aria-label":"response format",leadingVisual:e(L,{svg:e(lt,{})}),isDisabled:a,onPress:()=>{r({instanceId:n,invocationParameterInput:{valueJson:lg(),invocationName:kn,canonicalName:Sn}})},children:"Response Format"}):null,f?e(M,{"aria-label":"add tool",size:"S",leadingVisual:e(L,{svg:e(lt,{})}),onPress:()=>{const u={tools:[...o.tools,nf({provider:o.model.provider,toolNumber:o.tools.length+1})]};if(o.tools.length===0){const g=Vl({toolChoice:"auto",targetProvider:o.model.provider});g&&(u.toolChoice=g)}l({instanceId:n,patch:u,dirty:!0})},children:"Tool"}):null,e(M,{"aria-label":"add message",size:"S",leadingVisual:e(L,{svg:e(lt,{})}),onPress:()=>{i({playgroundInstanceId:n,messages:[{id:Zn(),role:"user",content:""}]})},children:"Message"})]})}const i1=400;function r1({playgroundInstanceId:n}){const a=O(u=>u.deleteInvocationParameterInput),t=O(u=>u.instances.find(g=>g.id===n)),l=t==null?void 0:t.model.provider,i=O(u=>u.upsertInvocationParameterInput);if(!t)throw new Error(`Instance ${n} not found`);const r=t.model.invocationParameters.find(u=>u.invocationName===kn||u.canonicalName===Sn),[o,d]=m.useState(()=>JSON.stringify((r==null?void 0:r.valueJson)??{},null,2)),c=m.useRef(o),p=Ua();m.useEffect(()=>{const g=p.getState().instances.find(b=>b.id===n);if(g==null)return;const y=g.model.invocationParameters.find(b=>b.invocationName===kn||b.canonicalName===Sn);if(y==null)return;const k=JSON.stringify(y.valueJson,null,2);Wl({str:k,excludeNull:!0})&&d(k)},[l,p,n]);const f=m.useCallback(u=>{c.current=u;const{json:g}=Ve(u);i({instanceId:n,invocationParameterInput:{invocationName:kn,valueJson:g,canonicalName:Sn}})},[n,i]);return s(fe,{id:"response-format",children:[e(ge,{arrowPosition:"start",children:"Response Format"}),e(ye,{children:e(C,{padding:"size-200",children:e(q,{variant:"compact",title:"Schema",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(ce,{text:c}),e(M,{"aria-label":"Delete Response Format",leadingVisual:e(L,{svg:e(Ye,{})}),size:"S",onPress:()=>{a({instanceId:n,invocationParameterInputInvocationName:kn})}})]}),children:e(Qr,{preInitializationMinHeight:i1,children:e(Ue,{value:o,onChange:f,jsonSchema:Vy})})})})})]})}const s1=400;function o1({playgroundInstanceId:n,toolId:a}){const t=Ua(),l=O(k=>k.updateInstance),i=O(k=>k.instances.find(b=>b.id===n));if(i==null)throw new Error(`Playground instance ${n} not found`);const r=i.model.provider,o=i.tools,d=o.find(k=>k.id===a);if(d==null)throw new Error(`Tool ${a} not found`);const[c,p]=m.useState(()=>JSON.stringify(d.definition,null,2)),f=m.useRef(c);m.useEffect(()=>{const b=t.getState().instances.find(T=>T.id===n);if(b==null)return;const S=b.tools.find(T=>T.id===a);if(S==null)return;const K=JSON.stringify(S.definition,null,2);Wl({str:K,excludeNull:!0})&&p(K)},[r,t,n,a]);const u=m.useCallback(k=>{f.current=k;const{json:b}=Ve(k);l({instanceId:n,patch:{tools:o.map(S=>S.id===d.id?{...S,definition:b}:S)},dirty:!0})},[o,n,d.id,l]),g=m.useMemo(()=>Ps(d),[d]),y=m.useMemo(()=>{switch(i.model.provider){case"OPENAI":case"AZURE_OPENAI":return rg;case"ANTHROPIC":return ig;case"GOOGLE":return null}},[i.model.provider]);return e(q,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",variant:"compact",title:s(h,{direction:"row",gap:"size-100",children:[e(Bl,{spanKind:"tool"}),e(v,{children:g??"Tool"})]}),bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(ce,{text:f}),e(M,{"aria-label":"Delete tool",leadingVisual:e(L,{svg:e(Ye,{})}),size:"S",onPress:()=>{const k=o.filter(K=>K.id!==d.id),b=typeof i.toolChoice=="object"&&g!=null&&sg(i.toolChoice)===g;let S=i.toolChoice;k.length===0?S=void 0:b&&(S="auto"),l({instanceId:n,patch:{tools:k,toolChoice:S},dirty:!0})}})]}),children:e(Qr,{preInitializationMinHeight:s1,children:e(Ue,{value:c,onChange:u,jsonSchema:y})})})}function d1(n){const a=n.playgroundInstanceId,t=O(d=>d.instances.find(c=>c.id===n.playgroundInstanceId)),l=O(d=>d.updateInstance);if(t==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=t;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=m.useMemo(()=>i.map(d=>Ps(d)).filter(d=>d!=null),[i]),o=t.model.provider;return og(o)?s(fe,{id:"tools",children:[s(ge,{arrowPosition:"start",children:["Tools",e(yn,{children:i.length})]}),e(ye,{children:e(C,{padding:"size-200",children:s(h,{direction:"column",children:[e(Mt,{children:e(dg,{provider:o,choice:t.toolChoice,onChange:d=>{l({instanceId:a,patch:{toolChoice:d},dirty:!0})},toolNames:r})}),e(h,{direction:"column",gap:"size-200",children:i.map(d=>e(o1,{playgroundInstanceId:a,toolId:d.id},d.id))})]})})})]}):null}const wd=1,c1=wd+1;function u1(n){const a=n.playgroundInstanceId,t=O(u=>u.templateFormat),l=O(u=>u.updateInstance),i=m.useMemo(()=>Ld(a),[a]),r=O(i);if(!r)throw new Error(`Playground instance ${a} not found`);const o=r.tools.length>0,d=r.model.invocationParameters.find(u=>aa(u,{canonicalName:Sn,invocationName:kn}))!=null,{template:c}=r;if(c.__type!=="chat")throw new Error(`Invalid template type ${c.__type}`);const p=c.messageIds,f=Pm(Ti(wm),Ti(Lm,{coordinateGetter:_m}));return s(Dm,{sensors:f,onDragEnd:({active:u,over:g})=>{if(!g||u.id===g.id)return;const y=p.findIndex(S=>S===u.id),k=p.findIndex(S=>S===g.id),b=xm(p,y,k);l({instanceId:a,patch:{template:{__type:"chat",messageIds:b}},dirty:!0})},children:[e(Im,{items:p,children:e("ul",{css:F`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-200);
            padding: var(--ac-global-dimension-size-200);
          `,children:p.map(u=>e(p1,{playgroundInstanceId:a,templateFormat:t,messageId:u},u))})}),e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:o||d?"thin":void 0,children:e(l1,{instanceId:a,hasResponseFormat:d})}),o||d?s(gn,{defaultExpandedKeys:["tools","response-format"],children:[o?e(d1,{...n}):null,d?e(r1,{...n}):null]}):null]})}function m1({message:n,updateMessage:a,templateFormat:t,playgroundInstanceId:l,messageMode:i}){const r=m.useCallback(o=>{a({content:o})},[a]);return i==="toolCalls"?e(C,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:e(ra,{label:"Tool Calls",children:e(Xe,{width:"100%",children:e(Xk,{playgroundInstanceId:l,messageId:n.id})})})}):n.role==="tool"?s(Mt,{onSubmit:o=>{o.preventDefault()},children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(Y,{value:n.toolCallId,onChange:o=>a({toolCallId:o}),"aria-label":"Tool Call ID",size:"S",children:e(se,{placeholder:"Tool Call ID"})})}),e(Ue,{value:n.content??'""',"aria-label":"tool message content",height:"100%",onChange:o=>a({content:o})})]}):e(Nt,{children:e($t,{height:"100%",defaultValue:n.content||"","aria-label":"Message content",templateFormat:t,onChange:r})})}function p1({playgroundInstanceId:n,templateFormat:a,messageId:t}){const l=O(V=>V.updateMessage),i=O(V=>V.deleteMessage),{attributes:r,listeners:o,setNodeRef:d,transform:c,transition:p,setActivatorNodeRef:f,isDragging:u}=Em({id:t}),g=m.useMemo(()=>V=>{var $;return($=V.instances.find(N=>N.id===n))==null?void 0:$.model},[n]),y=O(g);if(!y)throw new Error(`Instance model not found for instance ${n}`);const k=m.useMemo(()=>Il(t),[t]),b=O(k),S=ht(b.role),K={transform:Rm.Translate.toString(c),transition:p,zIndex:u?c1:wd},T=b.toolCalls!=null&&b.toolCalls.length>0,[D,w]=m.useState(T?"toolCalls":"text"),[P,_]=m.useState(b.content),[z,R]=m.useState(b.toolCalls),Q=m.useCallback(V=>{l({instanceId:n,messageId:t,patch:V})},[n,t,l]);return e("li",{ref:d,style:K,children:e(q,{collapsible:!0,variant:"compact",bodyStyle:{padding:0},...S,title:e("div",{css:F`
              // Align the role picker with the prompt picker in PlaygroundTemplate header
              margin-left: var(--ac-global-dimension-size-150);
            `,children:e(a1,{includeLabel:!1,role:b.role,onChange:V=>{let $=b.content,N=b.toolCalls;V!=="ai"&&(N=void 0,w("text")),V==="tool"&&($='""'),l({instanceId:n,messageId:t,patch:{role:V,toolCalls:N,content:$}})}})}),extra:s(h,{direction:"row",gap:"size-100",children:[b.role==="ai"?e(e1,{messageMode:D,onChange:V=>{switch(w(V),V){case"text":R(b.toolCalls),l({instanceId:n,messageId:t,patch:{content:P,toolCalls:void 0}});break;case"toolCalls":_(b.content),l({instanceId:n,messageId:t,patch:{content:"",toolCalls:z!=null?Nr({toolCalls:z,provider:y.provider}):[af(y.provider)]}});break;default:ve()}}}):null,e(ce,{text:D==="toolCalls"?Cn(b.toolCalls).json??"":b.content??""}),e(M,{"aria-label":"Delete message",leadingVisual:e(L,{svg:e(Ye,{})}),size:"S",onPress:()=>{i({instanceId:n,messageId:t})}}),e(cg,{ref:f,listeners:o,attributes:r})]}),children:e("div",{children:e(m1,{message:b,messageMode:D,playgroundInstanceId:n,templateFormat:a,updateMessage:Q})})})})}function g1(n){const[a,t]=m.useState(null),l=n.playgroundInstanceId,i=O(b=>b.updateInstance),r=O(b=>b.addMessage),o=O(b=>b.setDirty),d=O(b=>b.instances),c=d.find(b=>b.id===l),p=d.findIndex(b=>b.id===l),f=c==null?void 0:c.prompt,u=f==null?void 0:f.id,g=O(b=>b.dirtyInstances[l]),y=m.useCallback(async b=>{if(!b){i({instanceId:l,patch:{prompt:null},dirty:!1});return}const S=await $o(b);S&&(i({instanceId:l,patch:{...S.instance,template:{__type:"chat",messageIds:[]}},dirty:!1}),r({playgroundInstanceId:l,messages:S.instance.template.messages}),o(l,!1))},[l,i,r,o]);if(!c)throw new Error(`Playground instance ${l} not found`);const{template:k}=c;return s(U,{children:[e(q,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",marginEnd:"size-100",children:[e(Ul,{index:p}),e(Td,{promptId:u,onChange:y})]}),collapsible:!0,variant:"compact",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(m.Suspense,{fallback:e("div",{children:e(Ce,{size:"S"})}),children:e(Zk,{instanceId:l})}),e(Gk,{...n}),e(f1,{instanceId:l,setDialog:t,dirty:g}),d.length>1?e(y1,{...n}):null]}),children:k.__type==="chat"?e(m.Suspense,{children:e(u1,{...n})}):"Completion Template"}),e(ae,{isDismissable:!0,onDismiss:()=>{t(null)},children:a})]})}function y1(n){const a=O(t=>t.deleteInstance);return s(Se,{children:[e($e,{children:e(M,{size:"S","aria-label":"Delete this instance of the playground",leadingVisual:e(L,{svg:e(Ye,{})}),onPress:()=>{a(n.playgroundInstanceId)}})}),e(Ne,{children:e(ia,{children:"Delete this instance of the playground"})})]})}function f1({instanceId:n,setDialog:a,dirty:t}){const l=O(r=>r.instances.find(o=>o.id===n));if(!l)throw new Error(`Instance ${n} not found`);return e(U,{children:s(Se,{delay:100,offset:5,placement:"top",children:[e($e,{children:e(M,{variant:t?"primary":void 0,size:"S",onPress:()=>{var r;a(e(Rk,{instanceId:n,setDialog:a,selectedPromptId:(r=l.prompt)==null?void 0:r.id}))},children:"Save"})}),e(Ne,{children:e(ia,{children:"Save this prompt"})})]})})}function h1({size:n}){const a=O(l=>l.templateFormat),t=O(l=>l.setTemplateFormat);return e("div",{css:F`
        & * {
          white-space: nowrap;
        }
      `,children:s(Jl,{size:n,defaultSelectedKeys:[a],"aria-label":"Template Format",onSelectionChange:l=>{if(l.size===0)return;const i=l.keys().next().value;typeof i=="string"&&ug(i)&&t(i)},children:[e(Xn,{"aria-label":"None",id:en.NONE,children:"None"}),e(Xn,{"aria-label":"Mustache",id:en.Mustache,children:"Mustache"}),e(Xn,{"aria-label":"F-String",id:en.FString,children:"F-String"})]})})}const k1=F`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function fi(n){const{modelProviders:a}=x.useLazyLoadQuery(Oo,{}),t=Fn(c=>c.modelConfigByProvider),l=Fn(c=>c.playgroundStreamingEnabled),[,i]=In(),r=a.some(c=>c.dependenciesInstalled);m.useEffect(()=>{i(c=>(c.delete("selectedSpanNodeId"),c),{replace:!0})},[i]);const o=window.Config.websocketsEnabled?l:!1,d=window.Config.websocketsEnabled;return r?s(Uh,{...n,streaming:o,modelConfigByProvider:t,children:[s("div",{css:k1,children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(oe,{level:1,children:"Playground"}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(Lk,{}):null,e(r0,{}),e(l0,{}),e(_k,{})]})]})}),e(P1,{})]}),e(m.Suspense,{children:e(Yh,{})})]}):e(a0,{availableProviders:a})}function b1(){const n=O(i=>i.addInstance),a=O(i=>i.instances),t=a.length,l=a.some(i=>i.activeRunId!=null);return e(M,{size:"S","aria-label":"add prompt",leadingVisual:e(L,{svg:e(Dn,{})}),isDisabled:t>=uy||l,onPress:()=>{n()},children:"Compare"})}const S1=F`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-disclosure-group {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-disclosure {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: auto;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-disclosure-panel {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,v1=F`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,C1=F`
  height: 100%;
  overflow: auto;
`,F1=632,K1=["prompts"],T1=["input","output"];function P1(){const n=O(u=>u.templateFormat),[a]=In(),t=a.get("datasetId"),l=t!=null,r=O(u=>u.instances.length)===1,o=O(u=>u.instances.some(g=>g.activeRunId!=null)),d=O(u=>Object.values(u.dirtyInstances).some(g=>g)),c=O(u=>u.instances.map(g=>g.id),(u,g)=>u.length===g.length&&u.every((y,k)=>y===g[k])),p=m.useCallback(({currentLocation:u,nextLocation:g})=>{const y=u.pathname!==g.pathname;return(o||d)&&y},[o,d]),f=Mm(p);return m.useEffect(()=>{const u=o,g=y=>{y.preventDefault(),y.returnValue=!0};if(u)return window.addEventListener("beforeunload",g),()=>{window.removeEventListener("beforeunload",g)}},[o]),s(m.Fragment,{children:[s(pn,{direction:r&&!l?"horizontal":"vertical",autoSaveId:r?"playground-horizontal":"playground-vertical",children:[e(_e,{children:e("div",{css:S1,children:e(gn,{defaultExpandedKeys:K1,children:s(fe,{id:"prompts",size:"L",children:[s(ge,{arrowPosition:"start",justifyContent:"space-between",children:["Prompts",e(Ut,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(h1,{size:"S"}),e(b1,{})]})})]}),e(ye,{children:e("div",{css:v1,children:e(h,{direction:"row",gap:"size-200",maxWidth:"100%",children:c.map(u=>e(C,{flex:"1 1 0px",minWidth:F1,children:e(g1,{playgroundInstanceId:u})},`${u}-prompt`))})})})]})})})}),e(vn,{css:Bt}),e(_e,{children:l?e(m.Suspense,{fallback:e(Ce,{}),children:e(hk,{datasetId:t})}):e("div",{css:C1,children:s(gn,{defaultExpandedKeys:T1,children:[n!==en.NONE?s(fe,{id:"input",size:"L",children:[e(ge,{arrowPosition:"start",children:"Inputs"}),e(ye,{children:e(C,{padding:"size-200",height:"100%",children:e(Ck,{})})})]}):null,s(fe,{id:"output",size:"L",children:[e(ge,{arrowPosition:"start",children:"Output"}),e(ye,{children:e(C,{padding:"size-200",height:"100%",children:e(h,{direction:"row",gap:"size-200",children:c.map(u=>e(C,{flex:"1 1 0px",children:e(xk,{playgroundInstanceId:u})},`${u}-output`))})})})]})]})})})]}),f!=null&&e(mg,{blocker:f,message:o?"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?":"You have unsaved changes. Are you sure you want to leave?"})]},"playground-content")}function d2(){const{instanceWithPrompt:n,templateFormat:a}=qe(),{instance:t}=m.useMemo(()=>{const{instance:l}=vr();return{instance:{...l,...n,template:n.template}}},[n]);return e(fi,{instances:[t],templateFormat:a})}const Ed=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"8fb2730b63a6d441fbac8e5f5a438c9b",id:null,metadata:{},name:"TagPromptVersionButtonSetTagMutation",operationKind:"mutation",text:`mutation TagPromptVersionButtonSetTagMutation(
  $input: SetPromptVersionTagInput!
  $promptId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      prompt: node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptVersionsList__main
        }
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}
`}}}();Ed.hash="6d6be37ba7956dbb351980e05b62cac1";const Rd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"versionId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:l,storageKey:null}],type:"Prompt",abstractKey:null},r=[{kind:"Variable",name:"id",variableName:"versionId"}],o={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:l,storageKey:null}],type:"PromptVersion",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={kind:"TypeDiscriminator",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,i,c,t],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,o,c,t],storageKey:null}]},params:{cacheID:"51965c86ef2f0e2192aed200cd90bef9",id:null,metadata:{},name:"TagPromptVersionButtonTagsQuery",operationKind:"query",text:`query TagPromptVersionButtonTagsQuery(
  $promptId: GlobalID!
  $versionId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      versionTags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
  promptVersion: node(id: $versionId) {
    __typename
    ... on PromptVersion {
      tags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Rd.hash="62f9ce0c869fb321ed64215c26ee5e56";const Md=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptVersionId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f649353c182b494e5d15015c95ecc083",id:null,metadata:{},name:"NewPromptVersionTagDialogMutation",operationKind:"mutation",text:`mutation NewPromptVersionTagDialogMutation(
  $input: SetPromptVersionTagInput!
  $promptVersionId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      node(id: $promptVersionId) {
        __typename
        ...PromptVersionTagsList_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Md.hash="c057a8cd7cddac787f887e505ff0f9e6";function I1({onNewTagCreated:n,promptVersionId:a,onDismiss:t}){const{control:l,handleSubmit:i,formState:{isDirty:r}}=Oe({defaultValues:{name:"",description:""}}),[o,d]=pe.useState(null),[c,p]=x.useMutation(Md);return e(ae,{onDismiss:t,isDismissable:!0,type:"modal",children:s(X,{title:"New Prompt Tag",children:[o?e(be,{variant:"danger",banner:!0,children:o}):null,s(tn,{onSubmit:i(u=>{d(null),c({variables:{input:{name:u.name,description:u.description,promptVersionId:a},promptVersionId:a},onCompleted:()=>{n(u),t()},onError:g=>{d(g.message)}})}),children:[s(C,{padding:"size-200",children:[e(W,{name:"name",control:l,rules:{required:"Name is required",pattern:Pd},render:({field:{name:u,onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Y,{isInvalid:b,onChange:g,onBlur:y,name:u,value:k.toString(),children:[e(J,{children:"Tag Name"}),e(se,{placeholder:"e.x. prod"}),S!=null&&S.message?e(xe,{children:S.message}):e(v,{slot:"description",children:"The identifier of the tag"})]})}),e(W,{name:"description",control:l,render:({field:{name:u,onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Y,{isInvalid:b,onChange:g,name:u,onBlur:y,value:k.toString(),children:[e(J,{children:"Description"}),e(Ca,{placeholder:"A description of the tag"}),S!=null&&S.message?e(xe,{children:S.message}):e(v,{slot:"description",children:"A description of the tag (optional)"})]})})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{gap:"size-100",justifyContent:"end",children:e(M,{variant:r?"primary":"default",size:"S",type:"submit",isDisabled:p,children:"Create Tag"})})})]})]})})}function x1(){const[n,a]=m.useState(!1),[t,l]=m.useState(0),i=he(),{promptId:r,versionId:o}=Be();if(!r)throw new Error("Expected promptId to be defined");if(!o)throw new Error("Expected versionId to be defined");return s("div",{children:[s(_t,{children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(pg,{})}),children:"Tag Version"}),s(jr,{placement:"bottom end",children:[e(qr,{}),s(Dt,{children:[e(m.Suspense,{fallback:e(C,{padding:"size-100",children:e(Ce,{size:"S"})}),children:e(D1,{promptId:r,versionId:o,fetchKey:t,onTagSet:d=>{l(c=>c+1),i({title:"Tag Set",message:`The tag ${d} has been set on the version`})}})}),e(C,{padding:"size-100",width:"250px",children:e(M,{leadingVisual:e(L,{svg:e(lt,{})}),size:"S",css:F`
                  width: 100%;
                `,onPress:()=>a(!0),children:"New Tag"})})]})]})]}),n&&e(I1,{promptVersionId:o,onDismiss:()=>a(!1),onNewTagCreated:d=>{l(c=>c+1),i({title:"Tag Created",message:`The tag ${d.name} has been created and been set on the version`})}})]})}function D1({promptId:n,versionId:a,fetchKey:t,onTagSet:l}){var f,u;const i=x.useLazyLoadQuery(Rd,{promptId:n,versionId:a},{fetchKey:t,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{var g,y;return((y=(g=i==null?void 0:i.prompt)==null?void 0:g.versionTags)==null?void 0:y.map(k=>k.name))||[]},[(f=i==null?void 0:i.prompt)==null?void 0:f.versionTags]),o=m.useMemo(()=>{var g,y;return((y=(g=i==null?void 0:i.promptVersion)==null?void 0:g.tags)==null?void 0:y.map(k=>k.name))||[]},[(u=i==null?void 0:i.promptVersion)==null?void 0:u.tags]),d=m.useMemo(()=>Array.from(new Set([..._i.map(g=>g.name),...r])),[r]),[c,p]=x.useMutation(Ed);return e("ul",{children:d.map(g=>{const y=o.includes(g);return e("li",{children:e(C,{paddingY:"size-100",paddingX:"size-200",borderBottomColor:"light",borderBottomWidth:"thin",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e("input",{type:"checkbox",name:g,checked:y,disabled:y||p,onChange:k=>{if(k.target.checked){const b=!o.includes(g);let S="";if(b){const K=_i.find(T=>T.name===g);S=(K==null?void 0:K.description)||""}c({variables:{input:{name:g,promptVersionId:a,description:S},promptId:n},onCompleted:()=>{l(g)}})}}}),e("span",{children:g})]})})},g)})})}function c2(){const n=qe();return Je(n),e(_1,{promptVersion:n.promptVersion})}function _1({promptVersion:n}){return e(C,{width:"100%",overflow:"auto",elementType:"section",children:e(C,{padding:"size-200",width:"100%",overflow:"auto",children:s(h,{direction:"column",gap:"size-200",maxWidth:900,marginStart:"auto",marginEnd:"auto",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",children:[e(oe,{level:2,children:`Version: ${n.id}`}),e(Ro,{promptVersion:n})]}),s(h,{direction:"row",gap:"size-100",children:[e(ce,{text:n.id,children:"Version ID"}),e(x1,{})]})]}),e(To,{promptVersion:n}),e(ko,{promptVersion:n}),e(_o,{promptVersion:n})]})})})}const Vd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],c={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:d,storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"},i,r,o,c,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[p],storageKey:null}],type:"PromptVersion",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[r,{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[f,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},p],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:d,storageKey:null},c,{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[l,p],storageKey:null},i],type:"PromptVersion",abstractKey:null}],storageKey:null}]},params:{cacheID:"619de31a7a111f736e33d8aad0e16f97",id:null,metadata:{},name:"promptVersionLoaderQuery",operationKind:"query",text:`query promptVersionLoaderQuery(
  $id: GlobalID!
) {
  promptVersion: node(id: $id) {
    __typename
    id
    ... on PromptVersion {
      ...PromptInvocationParameters__main
      ...PromptChatMessagesCard__main
      ...PromptCodeExportCard__main
      ...PromptModelConfigurationCard__main
      ...PromptVersionTagsList_data
      description
      invocationParameters
      modelName
      tools {
        definition
      }
      tags {
        name
      }
    }
  }
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Vd.hash="ab4959340d5259ba050f4d3ab7f4e261";async function u2(n){const{versionId:a}=n.params;return await x.fetchQuery(Fe,Vd,{id:a}).toPromise().catch(()=>{throw new Error("Prompt version not found")})}const Ad=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"promptVersion",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:1)"}],type:"Prompt",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"6b4dac4f67e74b03bfd1c4802b844fb0",id:null,metadata:{},name:"promptVersionsLoaderQuery",operationKind:"query",text:`query promptVersionsLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      promptVersions(first: 1) {
        edges {
          promptVersion: node {
            id
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Ad.hash="b5ea8ee71d6ce7848581a446f803c1aa";async function m2({params:n}){var r,o,d;if(n.versionId)return null;const t=n.promptId,l=await pt.fetchQuery(Fe,Ad,{id:t}).toPromise();if(!((d=(o=(r=l==null?void 0:l.prompt)==null?void 0:r.promptVersions)==null?void 0:o.edges)!=null&&d.length))throw new Error("Prompt does not have any versions");const i=l.prompt.promptVersions.edges[0].promptVersion;return it(`/prompts/${t}/versions/${i.id}`)}const zd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsPageContent__main",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null};zd.hash="994c1d93ccbab49fef121d5d73cd2b62";const Nd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsList__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};Nd.hash="30cac642c3466fa8405eb71f29d27be3";const L1=F`
  border-bottom: 1px solid var(--ac-global-color-grey-300);
  transition: background-color 0.1s ease-in;

  &[data-active="true"],
  &:hover {
    background-color: var(--ac-global-color-grey-200);
  }

  & > a {
    text-decoration: none;
    color: inherit;
  }
`,w1=({version:n,active:a})=>e("div",{css:L1,"data-active":a,children:e(Vm,{to:`${n.id}`,children:e(C,{width:"100%",paddingY:"size-100",paddingX:"size-200",children:e(Mo,{promptVersion:n})})})}),Yi=400,E1=({prompt:n,itemActive:a})=>{const{promptVersions:t}=x.useFragment(Nd,n);return e(C,{height:"100%",overflow:"auto",width:Yi,minWidth:Yi,borderRightWidth:"thin",borderColor:"grey-300",children:e(h,{direction:"column",children:t.edges.map(({version:l})=>e(w1,{version:l,active:a==null?void 0:a(l)},l.id))})})};function p2(){const{prompt:n}=ci(),{versionId:a}=Be();return e(R1,{prompt:n,promptVersionId:a})}function R1({prompt:n,promptVersionId:a}){const t=x.useFragment(zd,n),l=m.useCallback(i=>i.id===a,[a]);return e(C,{height:"100%",children:s(h,{direction:"row",height:"100%",children:[e(E1,{prompt:t,itemActive:l}),e(Ke,{})]})})}const $d=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"aa110794a0fd7ac02812e8e14196930b",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}}();$d.hash="26e5a5dbde9bd4ecfd7ae5fc1c078860";async function g2(n){const{sessionId:a}=n.params;return await x.fetchQuery(Fe,$d,{id:a}).toPromise()}const Od=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"537f0044aba3bca68c76ef30c43a810c",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
        completion
        prompt
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      traces {
        edges {
          trace: node {
            id
            traceId
            rootSpan {
              id
              attributes
              project {
                id
              }
              input {
                value
                mimeType
              }
              output {
                value
                mimeType
              }
              cumulativeTokenCountTotal
              cumulativeTokenCountCompletion
              cumulativeTokenCountPrompt
              latencyMs
              startTime
              spanAnnotations {
                name
                label
                score
                explanation
                annotatorKind
              }
              spanId
            }
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Od.hash="48d10974b52b961361ff750b74e21d8e";function M1({spanNodeId:n,projectId:a,size:t="M",buttonText:l="Annotate"}){const[i,r]=m.useState(null);return s(U,{children:[e(M,{size:t,"aria-label":"Edit Span Annotations",leadingVisual:e(L,{svg:e(gt,{})}),onPress:()=>r(e($r,{spanNodeId:n,projectId:a})),children:l}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const V1=n=>{const{json:a}=Ve(n);if(a==null||!ea(a))return null;const t=a[me.user];if(t==null||!ea(t))return null;const l=t[Am.id];return mn.isString(l)||mn.isNumber(l)?l:null};function er({role:n,value:a,mimeType:t}){const l=m.useMemo(()=>{if(t!=="json")return String(a);const r=Ve(a);return r.json==null?"--":JSON.stringify(r.json,null,2)},[a,t]),i=ht(n==="HUMAN"?"user":"assistant");return e(C,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...i,children:s(h,{direction:"column",gap:"size-50",children:[e(v,{color:"text-700",children:n}),t==="json"?e(nn,{value:l}):e(v,{children:l})]})})}function A1({traceId:n,rootSpan:a,index:t}){const l=m.useMemo(()=>new Date(a.startTime),[a.startTime]),i=m.useMemo(()=>V1(a.attributes),[a.attributes]);return e(C,{height:"100%",children:s(h,{direction:"column",justifyContent:"space-between",height:"100%",children:[s(h,{direction:"column",gap:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(v,{children:["Trace #",t+1]}),e(Ze,{to:`/projects/${a.project.id}/traces/${n}?selectedSpanNodeId=${a.id}`,children:s(h,{alignItems:"center",children:["View Trace",e(L,{svg:e(gg,{})})]})})]}),s(h,{direction:"row",justifyContent:"space-between",children:[i!=null?s(v,{color:"text-700",children:["user: ",i]}):null,e(v,{color:"text-700",flex:"end",marginStart:"auto",children:Nn(l)})]}),s(h,{direction:"row",gap:"size-100",children:[e(oa,{tokenCountTotal:a.cumulativeTokenCountTotal??0,tokenCountCompletion:a.cumulativeTokenCountCompletion??0,tokenCountPrompt:a.cumulativeTokenCountPrompt??0}),a.latencyMs!=null?e(Me,{latencyMs:a.latencyMs}):"--"]})]}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[s(h,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(v,{children:"Feedback"}),e(h,{gap:"size-50",direction:"column",children:a.spanAnnotations.length>0?a.spanAnnotations.map(r=>e(za,{annotation:r,children:e(zn,{annotation:r,annotationDisplayPreference:"label"})},r.name)):"--"})]}),e("span",{children:e(M1,{size:"S",spanNodeId:a.id,projectId:a.project.id,buttonText:"Annotate"})})]})]})})}function z1({rootSpan:n}){var a,t,l,i;return s(h,{direction:"column",gap:"size-100",children:[e(er,{role:"HUMAN",value:(a=n.input)==null?void 0:a.value,mimeType:(t=n.input)==null?void 0:t.mimeType}),e(er,{role:"AI",value:(l=n.output)==null?void 0:l.value,mimeType:(i=n.output)==null?void 0:i.mimeType})]})}function N1({traces:n}){const a=m.useMemo(()=>((n==null?void 0:n.edges)||[]).map(({trace:l})=>l).filter(l=>l.rootSpan!==null),[n]);return e(C,{height:"100%",flex:"1 1 auto",overflow:"auto",children:a.map(({traceId:t,rootSpan:l},i)=>e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"row",children:[e(C,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(z1,{rootSpan:l})}),e(C,{width:350,padding:"size-200",flex:"none",children:e(A1,{traceId:t,rootSpan:l,index:i})})]})},l.spanId))})}function $1({traceCount:n,tokenUsage:a,latencyP50:t}){return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Traces Count"}),e(v,{size:"L",children:n})]}),a!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Total Tokens"}),e(oa,{tokenCountTotal:a.total,tokenCountCompletion:a.completion,tokenCountPrompt:a.prompt,size:"L"})]}):null,t!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Latency P50"}),e(Me,{latencyMs:t,size:"L"})]}):null]})})}function O1(n){const{sessionId:a}=n,t=x.useLazyLoadQuery(Od,{id:a},{fetchPolicy:"store-and-network"});if(t.session==null)throw new Error("Session not found");return s("main",{css:F`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e($1,{traceCount:t.session.numTraces??0,tokenUsage:t.session.tokenUsage,latencyP50:t.session.latencyP50}),e(N1,{traces:t.session.traces})]})}function y2(){var i;const n=qe();Je(n);const{sessionId:a}=Be(),t=ue(),{rootPath:l}=il();return e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`${l}/sessions`),children:e(X,{size:"fullscreen",title:`Session ID: ${((i=n.session)==null?void 0:i.sessionId)??"--"}`,children:e(qt,{children:e(O1,{sessionId:a})})})})}const Qd=function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}}();Qd.hash="a248736e236c8d5348e0ecfbe9440ca2";async function f2(n){const a=await x.fetchQuery(Fe,Qd,{}).toPromise();return a!=null&&a.functionality.modelInferences?it("/model"):it("/projects")}const jd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},t=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],l=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},d={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],p={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelPageQuery",selections:[{args:t,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:t,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelPageQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:l,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"dimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:l,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"18059ac8df6b3c15d5e4bc04ca2c9877",id:null,metadata:{},name:"ModelPageQuery",operationKind:"query",text:`query ModelPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}}();jd.hash="b612239336c7638df42037315b00f635";function h2(n){const{referenceInferences:a}=_n(),{timeRange:t}=On(),l=x.useLazyLoadQuery(jd,{startTime:t.start.toISOString(),endTime:t.end.toISOString()});return s("main",{children:[s(Zl,{children:[e(Br,{}),a?e(Ur,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:F`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(_l,{title:"Model Schema",variant:"compact",bodyStyle:{padding:0},children:s(Ge,{children:[s(He,{children:[e(ne,{id:"all",children:"All"}),e(ne,{id:"embeddings",children:"Embeddings"}),e(ne,{id:"dimensions",children:"Dimensions"})]}),e(de,{id:"all",children:s(gn,{defaultExpandedKeys:["embeddings","dimensions"],children:[s(fe,{id:"embeddings",children:[e(ge,{children:"Embeddings"}),e(ye,{children:e(Li,{model:l})})]}),s(fe,{id:"dimensions",children:[e(ge,{children:"Dimensions"}),e(ye,{children:e(wi,{model:l})})]})]})}),e(de,{id:"embeddings",children:e(Li,{model:l})}),e(de,{id:"dimensions",children:e(wi,{model:l})})]})})}),e(Ke,{})]})}const qd={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"4ccf476dd862525b059197daccd0d4d9",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on Model {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};qd.hash="374499f7f8ce6919e4a0a4ecbe380c52";const Bd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},t={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},o={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},d={defaultValue:null,kind:"LocalArgument",name:"minDist"},c={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},p={defaultValue:null,kind:"LocalArgument",name:"nSamples"},f={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},u={defaultValue:null,kind:"LocalArgument",name:"timeRange"},g=[{kind:"Variable",name:"id",variableName:"id"}],y={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},K=[y,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[k,{kind:"InlineFragment",selections:[b,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[b,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],T=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],D={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:T,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:T,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o,d,c,p,f,u],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[D],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,u,d,c,p,o,n,a,l,t,i,f],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,D,{kind:"TypeDiscriminator",abstractKey:"__isNode"},y],storageKey:null}]},params:{cacheID:"d30210c52f86b9d9a7ac958f866aa93e",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Bd.hash="f1ee7ce02317f1c3fe96b77af405095f";function Q1(){const{theme:n}=$n();return m.useMemo(()=>n==="light"?yg:fg,[n])}function j1(){const{embeddingDimensionId:n}=Be();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const Ud={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function ka(n){const a=Ud[n];return a!=null?a.shortName:n}function kl(n){const a=Ud[n];return a&&a.definition!=null&&a.definition||null}function Ia(n){return`${n.column}:${n.dir}`}function q1(){const{referenceInferences:n}=_n(),a=!!n,t=H(c=>c.clusterSort),l=H(c=>c.setClusterSort),[i,r]=m.useState(!1),o=m.useMemo(()=>{const c=[];return a&&c.push({label:"Most drift",value:Ia({column:"driftRatio",dir:"desc"})}),[...c,{label:"Largest clusters",value:Ia({column:"size",dir:"desc"})},{label:"Smallest clusters",value:Ia({column:"size",dir:"asc"})},{label:"Highest metric value",value:Ia({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:Ia({column:"primaryMetricValue",dir:"asc"})}]},[a]),d=Ia(t);return e("div",{css:F`
        .ac-action-button {
          background: none;
          border: none;
          color: ${"var(--ac-global-text-color-700)"};
          font-size: var(--ac-global-font-size-xs);
          line-height: var(--ac-global-line-height-xs);
          cursor: pointer;
          outline: none;
          &:hover {
            color: var(--ac-global-text-color-900);
          }
        }
      `,children:s(Va,{placement:"bottom right","aria-label":"Sort clusters by",isOpen:i,onOpenChange:c=>r(c),children:[s(Um,{children:["Sort",e("span",{"aria-hidden":!0,"data-testid":"dropdown-caret",css:F`
              margin-left: var(--ac-global-dimension-static-size-50);
              border-bottom-color: #0000;
              border-left-color: #0000;
              border-right-color: #0000;
              border-style: solid;
              border-width: 3px 3px 0;
              content: "";
              display: inline-block;
              height: 0;
              vertical-align: middle;
              width: 0;
            `})]}),e(Ll,{children:e(Vt,{style:{width:200},selectedKeys:[d],selectionMode:"single",items:o,onSelectionChange:c=>{if(c instanceof Set&&c.size>0){const[p]=c.values(),[f,u]=p.split(":");l({column:f,dir:u})}r(!1)},children:c=>e(ie,{children:c.label},c.value)})})]})})}const Hd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"clusters"}],a=[{alias:null,args:[{kind:"Variable",name:"clusters",variableName:"clusters"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportClusters",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EmbeddingActionMenuExportClustersMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EmbeddingActionMenuExportClustersMutation",selections:a},params:{cacheID:"1bef6586fcb3d6eb7034204fbe49633c",id:null,metadata:{},name:"EmbeddingActionMenuExportClustersMutation",operationKind:"mutation",text:`mutation EmbeddingActionMenuExportClustersMutation(
  $clusters: [ClusterInput!]!
) {
  exportClusters(clusters: $clusters) {
    fileName
  }
}
`}}}();Hd.hash="b5ff2517dbb0d19a1b24dea1796a3576";function B1(){const n=H(r=>r.clusters),{notifyError:a,notifySuccess:t}=Hr(),[l,i]=x.useMutation(Hd);return e(xn,{align:"end",buttonSize:"compact",icon:i?e(L,{svg:e(We,{})}):null,onAction:r=>{switch(r){case"export_cluster":l({variables:{clusters:n.map(o=>({eventIds:o.eventIds,id:o.id}))},onCompleted:o=>{const{fileName:d}=o.exportClusters;t({title:"Clusters Exported",message:"dataframe is available via px.active_session().exports or can be downloaded by clicking below",action:{text:"Download",onClick:()=>{window.open(`/exports?filename=${d}`,"_self")}}})},onError:o=>{a({title:"Failed to export clusters",message:`Failed to export clusters: ${o.message}`})}});break}},children:s(ie,{children:[e(L,{svg:e(Ht,{})}),"Export clusters"]},"export_cluster")})}const Gd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"Model",abstractKey:null};Gd.hash="55d03de16503d7af254c17cef7d18ee0";const Da=":";function U1(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function Ja(n){const{type:a,metric:t}=n;switch(a){case"drift":return`${a}${Da}${t}`;case"retrieval":return`${a}${Da}${t}`;case"performance":return`${a}${Da}${t}`;case"dataQuality":{const{name:l}=n.dimension;return`${a}${Da}${t}${Da}${l}`}default:ve()}}function H1({metricKey:n,dimensions:a}){const[t,l,i]=n.split(Da);if(!U1(t))throw new Error(`Invalid metric type: ${t}`);switch(t){case"drift":return{type:t,metric:l};case"retrieval":return{type:t,metric:l};case"performance":return{type:t,metric:l};case"dataQuality":{const r=a.find(o=>o.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:t,metric:l,dimension:r}}default:ve()}}const G1=s(Aa,{variant:"info",children:[e(oe,{level:4,weight:"heavy",children:"Analysis Metric"}),s(ia,{children:[e("p",{children:"Select a metric to drive the analysis of your embeddings."}),e("p",{children:"To analyze the the drift between your two inferences, select a drift metric and the UI will highlight areas of high drift."}),e("p",{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})]});function W1({model:n}){const[,a]=m.useTransition(),t=x.useFragment(Gd,n),{referenceInferences:l,corpusInferences:i}=_n(),r=!!l,o=!!i,d=H(y=>y.metric),c=H(y=>y.loading),p=H(y=>y.setMetric),f=t.numericDimensions.edges.map(y=>y.node),u=f.length>0,g=m.useCallback(y=>{const k=H1({metricKey:y,dimensions:f});a(()=>{p(k)})},[p,f,a]);return s(Lt,{label:"metric",labelExtra:G1,selectedKey:d?Ja(d):void 0,onSelectionChange:g,placeholder:"Select a metric...",isDisabled:c,children:[r?e(bt,{title:"Drift",children:e(ie,{children:"Euclidean Distance"},Ja({type:"drift",metric:"euclideanDistance"}))}):null,o?e(bt,{title:"Retrieval",children:e(ie,{children:"Query Distance"},Ja({type:"retrieval",metric:"queryDistance"}))}):null,e(bt,{title:"Performance",children:e(ie,{children:"Accuracy Score"},Ja({type:"performance",metric:"accuracyScore"}))}),u?e(bt,{title:"Data Quality",children:f.map(y=>e(ie,{children:`${y.name} avg`},Ja({type:"dataQuality",metric:"average",dimension:y})))}):null]})}const Wd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},o={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},d={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},c={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},p={defaultValue:null,kind:"LocalArgument",name:"timeRange"},f=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={kind:"Variable",name:"granularity",variableName:"metricGranularity"},y={kind:"Variable",name:"timeRange",variableName:"timeRange"},k=[g,{kind:"Literal",name:"metric",value:"euclideanDistance"},y],b=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:b,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:b,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},K=[{kind:"Variable",name:"id",variableName:"dimensionId"}],T={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[g,{kind:"Literal",name:"metric",value:"mean"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"Dimension",abstractKey:null},D={alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[g,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},y],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:b,storageKey:null}]}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o,d,c,p],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:f,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:K,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[T],storageKey:null}]},D],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,p,d,n,i,o,l,a,r,c],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:f,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:K,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,T,{kind:"TypeDiscriminator",abstractKey:"__isNode"},u],storageKey:null}]},D]},params:{cacheID:"a68a8204bf7fdd13e6915b338d4b5497",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: GlobalID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: GlobalID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    __isNode: __typename
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}}();Wd.hash="f31abad2141a5a1c461ef2a598ffa4f3";const nr=new Intl.NumberFormat([],{maximumFractionDigits:2}),Jd=()=>{const n=Qn(),a=n.blue400,t=n.gray500;return{color:a,barColor:t}};function J1({active:n,payload:a,label:t}){var r,o,d;const{color:l,barColor:i}=Jd();if(n&&a&&a.length){const c=((r=a[1])==null?void 0:r.value)??null,p=((o=a[0])==null?void 0:o.value)??null,f=typeof c=="number"?nr.format(c):"--",u=typeof p=="number"?nr.format(p):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,name:((d=a[1])==null?void 0:d.payload.metricName)??"Metric",value:f}),e(ze,{color:i,shape:"square",name:"Count",value:u}),e(Wt,{}),s("div",{css:F`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(Mn,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function Z1(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:ve()}}function X1(n){if(n)switch(n.type){case"drift":return ka(n.metric);case"performance":return ka(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return ka(n.metric);default:ve()}else return"Count"}function Y1(n){switch(n.type){case"drift":return kl(n.metric);case"performance":return kl(n.metric);case"dataQuality":return null;case"retrieval":return kl(n.metric);default:ve()}}function eb({embeddingDimensionId:n}){const a=H(P=>P.metric),t=a.type==="drift",l=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:o}=On(),{selectedTimestamp:d,setSelectedTimestamp:c}=Gt(),p=Qa(o),f=x.useLazyLoadQuery(Wd,{embeddingDimensionId:n,timeRange:{start:o.start.toISOString(),end:o.end.toISOString()},metricGranularity:Gr(o),countGranularity:p,fetchDrift:t,fetchQueryDistance:l,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),u=ja({samplingIntervalMinutes:p.samplingIntervalMinutes}),g=m.useCallback(P=>{const{activePayload:_}=P;if(_!=null&&_.length>0){const z=_[0].payload;c(new Date(z.timestamp))}},[c]),y=nb({data:f,metric:a}),b=ab(f).reduce((P,_)=>(P[_.timestamp]=_.value,P),{})??{},S=y.map(P=>{const _=b[P.timestamp];return{...P,traffic:_,timestamp:new Date(P.timestamp).getTime()}}),K=X1(a),T=Y1(a),{color:D,barColor:w}=Jd();return s("section",{css:F`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-100)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[s(oe,{level:3,children:[Z1(a),T!=null?s(Aa,{children:[e(oe,{level:4,children:K}),e(ia,{children:T})]}):null]}),e("div",{children:e(qn,{width:"100%",height:"100%",children:s(ft,{data:S,margin:{top:25,right:18,left:18,bottom:10},onClick:g,children:[s("defs",{children:[s("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:D,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:D,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:w,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:w,stopOpacity:0})]})]}),e(ma,{...qa,tickFormatter:P=>u(new Date(P)),style:{fill:"var(--ac-global-text-color-700)"}}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:K,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Tn,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{content:e(J1,{})}),e(Ra,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(dt,{type:"monotone",dataKey:"value",stroke:D,fillOpacity:1,fill:"url(#colorUv)"}),d!=null?e(gs,{...Wr,x:d.getTime()}):null]})})})]})}function nb({data:n,metric:a}){var t,l,i,r,o,d;if(((t=n.embedding.euclideanDistanceTimeSeries)==null?void 0:t.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(c=>({metricName:ka(a.metric),...c}));if(((l=n.embedding.retrievalMetricTimeSeries)==null?void 0:l.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(c=>({metricName:ka(a.metric),...c}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const c=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(p=>({metricName:`${c} avg`,...p}))}else{if(n.model&&((o=n.model.performanceTimeSeries)==null?void 0:o.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(c=>({metricName:ka(a.metric),...c}));if(((d=n.embedding.trafficTimeSeries)==null?void 0:d.data)!=null)return n.embedding.trafficTimeSeries.data.map(c=>({metricName:"Count",...c}))}return[]}function ab(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const Zd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},t={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},l=[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null}],i=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:i,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:i},params:{cacheID:"8b48064eba35d0d6c8dc834c2f7795c0",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}}();Zd.hash="4bd627481610322f2acbcf73dfbfaadc";const ar=F`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function Za(n){return e("div",{css:F`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:F`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function tb({event:n}){const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,t=!n.id.includes("CORPUS");return s("section",{css:F`
        height: 100%;
        overflow-y: auto;
      `,children:[e(sb,{event:n}),s(gn,{defaultExpandedKeys:["prediction","document","dimensions","retrievals"],children:[t?s(fe,{id:"prediction",children:[e(ge,{children:"Prediction Details"}),e(ye,{children:s("dl",{css:ar,children:[n.predictionId!=null&&s("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:F`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]}),n.predictionLabel!=null&&s("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&s("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&s("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&s("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})})]}):s(fe,{id:"document",children:[e(ge,{children:"Document Details"}),e(ye,{children:e("dl",{css:ar,children:n.predictionId!=null&&s("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:F`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]})})})]}),s(fe,{id:"dimensions",children:[e(ge,{children:"Dimensions"}),e(ye,{children:e(ib,{dimensions:n.dimensions})})]}),a&&s(fe,{id:"retrievals",children:[s(ge,{children:["Retrieved Documents",e(yn,{children:n.retrievedDocuments.length})]}),e(ye,{children:e("ul",{css:F`
                  padding: var(--ac-global-dimension-static-size-100);
                  li + li {
                    margin-top: var(--ac-global-dimension-static-size-100);
                  }
                `,children:n.retrievedDocuments.map(l=>e("li",{children:e(lb,{document:l})},l.id))})})]})]})]})}function lb({document:n}){return e(C,{borderRadius:"medium",backgroundColor:"light",children:s(h,{direction:"column",children:[e(C,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(Mr,{})}),s(oe,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(La,{color:"var(--ac-global-color-blue-1000)",children:`relevance ${ql(n.relevance)}`})]})}),e("pre",{css:F`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function ib({dimensions:n}){const a=m.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),t=m.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),l=Le({columns:t,data:a,getCoreRowModel:we()});return s("table",{css:sn,children:[e("thead",{children:l.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:Z(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),l.getCoreRowModel().rows.length?e("tbody",{children:l.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:Z(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e(ob,{})]})}function rb({dataUrl:n}){const a=hg(n),t=kg(n);return a?e("video",{src:n,controls:!0,css:F`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):t?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:F`
        object-fit: contain;
        background-color: black;
      `})}function sb({event:n}){const a=n.linkToData||void 0,t=n.rawData,l=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=s(h,{direction:"column",children:[e(rb,{dataUrl:a}),t&&s(fe,{id:"raw",children:[e(ge,{children:"Raw Data"}),e(ye,{children:e(Za,{children:t})})]})]}):i?r=s(fe,{id:"document",children:[e(ge,{children:"Document"}),e(ye,{children:e(Za,{children:i})})]}):l?r=s(gn,{defaultExpandedKeys:["prompt","response"],children:[s(fe,{id:"prompt",children:[e(ge,{children:"Prompt"}),e(ye,{children:e(Za,{children:l.prompt})})]}),s(fe,{id:"response",children:[e(ge,{children:"Response"}),e(ye,{children:e(Za,{children:l.response})})]})]}):n.rawData&&n.rawData&&n.rawData,r}function ob(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:F`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:e(Er,{graphicKey:"documents",message:"This embedding has no associated dimensions"})})})})}const Xd=function(){var n=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}}();Xd.hash="7e6db431afe21f137e54505645c787f4";const Yd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}}();Yd.hash="8b0d6962e2034d4c148d1b9919111d2f";const db=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,cb=F`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function ub({value:n}){const{theme:a}=$n(),t=a==="light"?da:ca;return e(ua,{value:n,basicSetup:!1,extensions:[yt()],editable:!1,theme:t,css:cb})}function mb(){const n=H(o=>o.selectedEventIds),[a,t]=x.useMutation(Yd),[l,i]=m.useState(null),r=m.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:o=>{i(o.exportEvents)}})},[a,n]);return s(U,{children:[e(M,{size:"S",leadingVisual:e(L,{svg:t?e(We,{}):e(Ht,{})}),"aria-label":"Export selection / cluster",isDisabled:t,onPress:r,children:t?"Exporting":"Export"}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l!=null&&s(X,{title:"Cluster Exports",size:"M",children:[e(be,{variant:"success",banner:!0,title:"Export succeeded",extra:e(M,{variant:"success",size:"S",onPress:()=>{window.open(`/exports?filename=${l.fileName}`,"_self")},children:"Download"})}),s("div",{css:F`
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-start;
                padding: 16px;
                gap: 16px;
              `,children:[e("p",{css:F`
                  margin: 0;
                  flex: 1 1 auto;
                `,children:"You can retrieve your export in your notebook via"}),e(C,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e(ub,{value:db})})]}),e(gn,{defaultExpandedKeys:["all-exports"],children:s(fe,{id:"all-exports",children:[e(ge,{children:"Latest Exports"}),e(ye,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(pb,{})})})]})})]})})]})}function pb(){const n=x.useLazyLoadQuery(Xd,{},{fetchPolicy:"network-only"});return e(Et,{children:n.model.exportedFiles.map((a,t)=>e(wt,{children:s("div",{css:F`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(M,{size:"S","aria-label":"Download",variant:"default",leadingVisual:e(L,{svg:e(Hm,{})}),onPress:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},t))})}function gb(n){const{getInferencesNameByRole:a}=_n(),{events:t,onItemSelected:l}=n,i=H(p=>p.eventIdToDataMap),r=H(p=>p.eventIdToGroup),o=H(p=>p.pointGroupColors),d=H(p=>p.selectionGridSize),c=H(p=>p.setHoveredEventId);return e("div",{css:F`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":d,css:F`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:t.map((p,f)=>{const u=i.get(p.id),{rawData:g=null,linkToData:y=null}=(u==null?void 0:u.embeddingMetadata)??{},{predictionLabel:k=null,actualLabel:b=null}=(u==null?void 0:u.eventMetadata)??{},S=bg(p.id),K=a(S),T=r[p.id],D=o[T];return e("li",{children:e(Sg,{rawData:g,linkToData:y,inferencesName:K,group:T,onClick:()=>{l(p.id)},onMouseOver:()=>{c(p.id)},onMouseOut:()=>{c(null)},color:D,size:d,predictionLabel:k,actualLabel:b,promptAndResponse:p.promptAndResponse,documentText:p.documentText,autoPlay:!1})},f)})})})}function yb({data:n,onPointSelected:a}){const{primaryInferences:t,referenceInferences:l}=_n(),i=H(f=>f.metric),[r,o]=m.useState([]),{columns:d,tableData:c}=m.useMemo(()=>{const f=n.filter(D=>D.id.includes("CORPUS")===!1);let u=!1,g=!1,y=!1,k=!1,b=!1;n.forEach(D=>{D.linkToData&&(u=!0),D.rawData&&(g=!0),(D.prompt||D.response)&&(y=!0),D.predictionLabel&&(k=!0),D.actualLabel&&(b=!0)});const S=[];l&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:D})=>e(fb,{id:D(),primaryInferencesName:t.name,referenceInferencesName:(l==null?void 0:l.name)??"reference"})}),u&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:D})=>{const w=D();if(typeof w=="string"){const P=w.split("/").pop();return e(ln,{href:w,children:P})}return null}}),y?(S.push({header:"Prompt",accessorKey:"prompt",cell:Ee,size:200}),S.push({header:"Response",accessorKey:"response",cell:Ee,size:200})):g&&S.push({header:"Raw Data",accessorKey:"rawData"}),k&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),b&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const K=[];if(i&&i.type==="dataQuality"){const D=i.dimension.name;K.push({header:i.dimension.name,accessorKey:"metric",cell:vg,sortingFn:"basic"}),f.forEach(w=>{var _;const P=(_=w.dimensions.find(z=>z.dimension.name===D))==null?void 0:_.value;w.metric=P!=null?Number(P):null})}return{columns:[...S,...K,{header:"",id:"view-details",size:50,cell:({row:D})=>e(M,{"aria-label":"view point details",size:"S",onPress:()=>{a(D.original.id)},children:"view details"})}],tableData:f}},[n,a,t,l,i]),p=Le({columns:d,data:c,state:{sorting:r},getCoreRowModel:we(),onSortingChange:o,getSortedRowModel:Pn()});return s("table",{css:sn,children:[e("thead",{children:p.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(u=>s("th",{children:[u.isPlaceholder?null:s("div",{className:u.column.getCanSort()?"cursor-pointer":"",onClick:u.column.getToggleSortingHandler(),children:[Z(u.column.columnDef.header,u.getContext()),u.column.getIsSorted()?e(L,{className:"sort-icon",svg:u.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]}),e("div",{onMouseDown:u.getResizeHandler(),onTouchStart:u.getResizeHandler(),className:`resizer ${u.column.getIsResizing()?"isResizing":""}`,style:{transform:u.column.getIsResizing()?`translateX(${p.getState().columnSizingInfo.deltaOffset}px)`:""}})]},u.id))},f.id))}),e("tbody",{children:p.getRowModel().rows.map(f=>e("tr",{children:f.getVisibleCells().map(u=>e("td",{style:{width:u.column.getSize()},children:Z(u.column.columnDef.cell,u.getContext())},u.id))},f.id))})]})}function fb({id:n,primaryInferencesName:a,referenceInferencesName:t}){const l=n.includes("PRIMARY"),i=Q1();return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Fg,{shape:Cg.circle,color:i[l?0:1]}),l?a:t]})}const hb=F`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function kb({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function bb(){const n=H(P=>P.selectedEventIds),a=H(P=>P.setSelectedEventIds),t=H(P=>P.setSelectedClusterId),l=H(P=>P.selectionDisplay),[i,r]=pe.useState(null),{primaryEventIds:o,referenceEventIds:d,corpusEventIds:c}=m.useMemo(()=>{const P=[],_=[],z=[];return n.forEach(R=>{R.includes("PRIMARY")?P.push(R):R.includes("CORPUS")?z.push(R):_.push(R)}),{primaryEventIds:P,referenceEventIds:_,corpusEventIds:z}},[n]),p=x.useLazyLoadQuery(Zd,{primaryEventIds:[...o],referenceEventIds:[...d],corpusEventIds:[...c]}),f=m.useMemo(()=>{var R,Q,V,$,N,le;const P=((Q=(R=p.model)==null?void 0:R.primaryInferences)==null?void 0:Q.events)??[],_=(($=(V=p.model)==null?void 0:V.referenceInferences)==null?void 0:$.events)??[],z=((le=(N=p.model)==null?void 0:N.corpusInferences)==null?void 0:le.events)??[];return[...P,..._,...z]},[p]),u=()=>{a(new Set),t(null)},g=H(P=>P.eventIdToDataMap),y=H(P=>P.pointData),k=H(P=>P.selectionSearchText),b=m.useMemo(()=>f.map(P=>{var R,Q,V,$,N,le,re;const _=g.get(P.id),z=[];return y!=null&&(_==null?void 0:_.retrievals)!=null&&_.retrievals.forEach(({documentId:ke,relevance:Ln})=>{const Bn=y[ke];Bn!=null&&z.push(kb({event:Bn,relevance:Ln}))}),{id:P.id,predictionId:((R=P.eventMetadata)==null?void 0:R.predictionId)??null,actualLabel:((Q=P.eventMetadata)==null?void 0:Q.actualLabel)??null,actualScore:((V=P.eventMetadata)==null?void 0:V.actualScore)??null,predictionLabel:(($=P.eventMetadata)==null?void 0:$.predictionLabel)??null,predictionScore:((N=P.eventMetadata)==null?void 0:N.predictionScore)??null,rawData:(_==null?void 0:_.embeddingMetadata.rawData)??null,linkToData:(_==null?void 0:_.embeddingMetadata.linkToData)??null,dimensions:P.dimensions,prompt:((le=P.promptAndResponse)==null?void 0:le.prompt)??null,response:((re=P.promptAndResponse)==null?void 0:re.response)??null,retrievedDocuments:z,documentText:P.documentText??null}}),[f,g,y]),S=m.useMemo(()=>{if(k){const P=k.toLowerCase();return b.filter(_=>{var z,R,Q,V;return _.id.includes(P)||((z=_.documentText)==null?void 0:z.toLowerCase().includes(P))||((R=_.predictionId)==null?void 0:R.includes(P))||((Q=_.prompt)==null?void 0:Q.toLowerCase().includes(P))||((V=_.response)==null?void 0:V.toLowerCase().includes(P))})}return b},[b,k]),K=m.useMemo(()=>{if(k){const P=k.toLowerCase();return f.filter(_=>{var z,R,Q,V,$,N,le;return _.id.includes(P)||((z=_.documentText)==null?void 0:z.toLowerCase().includes(P))||((Q=(R=_.eventMetadata)==null?void 0:R.predictionId)==null?void 0:Q.includes(P))||(($=(V=_.promptAndResponse)==null?void 0:V.prompt)==null?void 0:$.toLowerCase().includes(P))||((le=(N=_.promptAndResponse)==null?void 0:N.response)==null?void 0:le.toLowerCase().includes(P))})}return f},[f,k]),T=m.useMemo(()=>i?b.find(_=>_.id===i)??null:null,[b,i]),D=f.length,w=K.length;return s("section",{css:hb,children:[s("div",{role:"toolbar",css:F`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(Gm,{})}),"aria-label":"Clear selection",onPress:u}),e(mb,{})]}),s(Ge,{children:[e(He,{children:e(ne,{id:"selection",children:"Selection"})}),s(ba,{id:"selection",children:[e(Sb,{numSelectedEvents:D,numMatchingEvents:w,searchText:k}),l===Jr.list?e("div",{css:F`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(yb,{data:S,onPointSelected:r})}):e(gb,{events:K,onItemSelected:r})]})]}),e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:T&&e(X,{title:"Embedding Details",size:"L",children:e(tb,{event:T})})})]})}function Sb({numSelectedEvents:n,numMatchingEvents:a,searchText:t}){const l=H(p=>p.selectionDisplay),i=H(p=>p.setSelectionDisplay),r=H(p=>p.selectionGridSize),o=H(p=>p.setSelectionGridSize),d=H(p=>p.setSelectionSearchText),c=m.useMemo(()=>t?`${a}/${n} match "${t}"`:`${n} selected`,[n,a,t]);return e(Zl,{extra:s("div",{css:F`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(Wm,{placeholder:"Search by text or ID",onChange:p=>{d(p)}}),l===Jr.gallery&&e(Kg,{size:r,onChange:o}),e(Tg,{mode:l,onChange:p=>{i(p)}})]}),children:e(v,{children:c})})}const ec=Bd;function k2(){const{referenceInferences:n,corpusInferences:a}=_n(),{timeRange:t}=On(),l=m.useMemo(()=>{let i={};return a!=null?i=xg():n!=null?i=Dg():i=_g(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(Zr,{initialTimestamp:t.end,children:e(Lg,{...l,children:e(vb,{})})})}function vb(){const n=j1(),{primaryInferences:a,referenceInferences:t}=_n(),l=H(K=>K.umapParameters),i=H(K=>K.getHDSCANParameters),r=H(K=>K.getMetric),o=H(K=>K.reset),d=H(K=>K.setLoading),[c,p]=m.useState(!0),[f,u,g]=x.useQueryLoader(ec),{selectedTimestamp:y}=Gt(),k=m.useMemo(()=>y??new Date(a.endTime),[y,a.endTime]),b=m.useMemo(()=>({start:fr(k,2).toISOString(),end:k.toISOString()}),[k]),S=x.useLazyLoadQuery(qd,{});return m.useEffect(()=>{o(),d(!0);const K=r();return u({id:n,timeRange:b,...l,...i(),fetchDataQualityMetric:K.type==="dataQuality",fetchPerformanceMetric:K.type==="performance",dataQualityMetricColumnName:K.type==="dataQuality"?K.dimension.name:null,performanceMetric:K.type==="performance"?K.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{g()}},[d,o,n,u,g,l,i,r,b]),s("main",{css:F`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(xb,{}),s(Zl,{extra:s(h,{direction:"row",justifyContent:"center",alignItems:"center",gap:"size-100",children:[e(Fa,{onChange:K=>{p(K)},defaultSelected:!0,labelPlacement:"start",children:"Show Timeseries"}),e(B1,{})]}),children:[e(Br,{}),t?e(Ur,{inferencesRole:"reference",timeRange:{start:new Date(t.startTime),end:new Date(t.endTime)}}):null,e(W1,{model:S.model})]}),s(pn,{direction:"vertical",children:[c?s(U,{children:[e(_e,{defaultSize:20,collapsible:!0,order:1,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(eb,{embeddingDimensionId:n})})}),e(vn,{css:Na})]}):null,e(_e,{order:2,children:e("div",{css:F`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(m.Suspense,{fallback:e(wg,{}),children:f?e(Fb,{queryReference:f}):null})})})]})]})}function Cb(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function Fb({queryReference:n}){const a=x.usePreloadedQuery(ec,n),t=m.useMemo(()=>{var p,f;return((f=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:f.data)??[]},[a]),l=m.useMemo(()=>{var p,f;return((f=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:f.referenceData)??[]},[a]),i=m.useMemo(()=>{var p,f;return((f=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:f.corpusData)??[]},[a]),r=m.useMemo(()=>{var p,f;return((f=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:f.contextRetrievals)??[]},[a]),o=m.useMemo(()=>[...t,...l,...i].map(f=>({...f,position:Cb(f.coordinates),metaData:{id:f.eventId}})),[l,t,i]),d=H(p=>p.setInitialData),c=H(p=>p.setClusters);return zm(()=>{var f,u;const p=((u=(f=a.embedding)==null?void 0:f.UMAPPoints)==null?void 0:u.clusters)||[];d({points:o,clusters:p,retrievals:r})},[o,n,r,d,c]),e("div",{css:F`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:s(pn,{direction:"horizontal",children:[e(_e,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:s(pn,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(_e,{css:F`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(Pb,{})}),e(vn,{css:Na}),e(_e,{css:F`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:s(Ge,{children:[s(He,{children:[e(ne,{id:"display",children:"Display"}),e(ne,{id:"hyperparameters",children:"Hyperparameters"})]}),e(ba,{id:"display",children:e(Eg,{})}),e(ba,{id:"hyperparameters",children:e(Rg,{})})]})})]})}),e(vn,{css:Bt}),e(_e,{children:s("div",{css:F`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(Kb,{}),e(Mg,{})]})})]})})}function Kb(){return H(a=>a.selectedEventIds).size===0?null:e("div",{css:F`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:s(pn,{direction:"vertical",children:[e(_e,{}),e(vn,{css:Na,style:{zIndex:1}}),e(_e,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(Tb,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(bb,{})})})})]})})}function Tb(n){return e("div",{css:F`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const Pb=pe.memo(function(){const{referenceInferences:a}=_n(),t=H(u=>u.clusters),l=H(u=>u.selectedClusterId),i=H(u=>u.metric),r=H(u=>u.setSelectedClusterId),o=H(u=>u.setSelectedEventIds),d=H(u=>u.setHighlightedClusterId),c=H(u=>u.setClusterColorMode),p=a==null||i.type==="drift",f=m.useCallback(u=>{c(u==="configuration"?Ei.highlight:Ei.default)},[c]);return s(Ge,{onSelectionChange:u=>f(u),children:[s(He,{children:[s(ne,{id:"clusters",children:["Clusters ",e(yn,{children:t.length})]}),e(ne,{id:"configuration",children:"Configuration"})]}),e(ba,{id:"clusters",children:s(h,{direction:"column",height:"100%",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(h,{direction:"row",justifyContent:"end",children:e(q1,{})})}),e(C,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:F`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-size-100);
                margin: var(--ac-global-dimension-size-100);
              `,children:t.map(u=>e("li",{children:e(Pg,{clusterId:u.id,numPoints:u.eventIds.length,isSelected:l===u.id,driftRatio:u.driftRatio,primaryToCorpusRatio:u.primaryToCorpusRatio,primaryMetricValue:u.primaryMetricValue,referenceMetricValue:u.referenceMetricValue,metricName:Ib(i),hideReference:p,onClick:()=>{l!==u.id?(r(u.id),o(new Set(u.eventIds))):(r(null),o(new Set))},onMouseEnter:()=>{d(u.id)},onMouseLeave:()=>{d(null)}})},u.id))})})]})}),e(ba,{id:"configuration",children:e(C,{overflow:"auto",height:"100%",children:e(Ig,{})})})]})});function Ib(n){const{type:a,metric:t}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(t){case"euclideanDistance":return"Cluster Drift";default:ve()}break}case"performance":return ka(t);case"retrieval":{switch(t){case"queryDistance":return"% Query";default:ve()}break}default:ve()}}function xb(){const{notifyError:n}=Hr(),a=H(l=>l.errorMessage),t=H(l=>l.setErrorMessage);return m.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{t(null)}}})},[a,n,t]),null}const nc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"cff0ac130f1ef79784f7bef4161ac60d",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: GlobalID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    __isNode: __typename
    id
  }
}
`}}}();nc.hash="c049e57d92943f64b5e751e0daa89dc8";async function b2(n){const{embeddingDimensionId:a}=n.params;return x.fetchQuery(Fe,nc,{id:a}).toPromise()}const ac=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},o=[r],d=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],f={kind:"Literal",name:"metric",value:"cardinality"},u={kind:"Literal",name:"metric",value:"percentEmpty"},g={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:o,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[f,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[u,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[g,f],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[g,u],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ad937e56d4647309b9d78ac11f57265",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    __isNode: __typename
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}}();ac.hash="d194bfd656408e8ba7cb427ddc80fc85";const tc=function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}}();tc.hash="8b4edef350e4df49e799afa70ca34918";function Db(n){const a=x.useFragment(tc,n.dimension);return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Cardinality"}),e(v,{children:Sa(a.cardinality)}),a.referenceCardinality!=null&&e(v,{size:"S",color:"purple-800",children:Sa(a.referenceCardinality)})]})}const lc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"f53e5ac5e0bfd6a0a6c50b761223a617",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();lc.hash="88ce04bb2022d5e2bc75c663abd7e5de";const kt={top:25,right:18,left:18,bottom:5},_b=new Intl.NumberFormat([],{maximumFractionDigits:2}),ic=()=>{const{gray300:n}=Qn();return{color:n}};function Lb({active:n,payload:a,label:t}){var i;const{color:l}=ic();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?_b.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,name:"Cardinality",value:o}),e(Wt,{})]})}return null}function wb({dimensionId:n}){var d;const{timeRange:a}=On(),t=Qa(a),l=x.useLazyLoadQuery(lc,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),{color:i}=ic(),r=((d=l.dimension.cardinalityTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],o=ja({samplingIntervalMinutes:t.samplingIntervalMinutes});return e(qn,{width:"100%",height:"100%",children:s(ft,{data:r,margin:kt,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(ma,{...qa,tickFormatter:c=>o(new Date(c))}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{content:e(Lb,{})}),e(dt,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const rc={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};rc.hash="6dccac51f3fb0853276677c692af5a43";function Eb(n){const t=x.useFragment(rc,n.dimension).count??0;return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Total Count"}),e(v,{size:"L",children:Sa(t)})]})}const sc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"1f9eff6d8d453148844edae32b844df7",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();sc.hash="9677ef7c6b298554824fe3fd3904c7aa";const Rb=new Intl.NumberFormat([],{maximumFractionDigits:2}),oc=()=>{const{gray300:n}=Qn();return{barColor:n}};function Mb({active:n,payload:a,label:t}){var i;const{barColor:l}=oc();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?Rb.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,shape:"square",name:"Count",value:o})]})}return null}function Vb({dimensionId:n}){var c;const{timeRange:a}=On(),t=Qa(a),r=(((c=x.useLazyLoadQuery(sc,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:t}).embedding.trafficTimeSeries)==null?void 0:c.data)||[]).map(p=>({...p,timestamp:new Date(p.timestamp).valueOf()})),o=ja({samplingIntervalMinutes:t.samplingIntervalMinutes}),{barColor:d}=oc();return e(qn,{width:"100%",height:"100%",children:s(ni,{data:r,margin:kt,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:d,stopOpacity:1}),e("stop",{offset:"95%",stopColor:d,stopOpacity:.5})]})}),e(ma,{...qa,tickFormatter:p=>o(new Date(p))}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{...Xl,content:e(Mb,{})}),e(Ra,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const dc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],c={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:d,storageKey:null},p={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:d,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,o],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null},action:"THROW"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[o],type:"IntervalBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"7d11d88f419003f5ee8cd9d11312e427",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}}();dc.hash="6bb76e3cce4ee28c333e485b3aa2dffd";const tr=Dl(".2f"),cc=()=>{const{primary:n,reference:a}=Qn();return{primaryBarColor:n,referenceBarColor:a}};function Ab({active:n,payload:a,label:t}){var r,o,d,c,p,f;const{primaryBarColor:l,referenceBarColor:i}=cc();if(n&&a&&a.length){const u=(o=(r=a[0])==null?void 0:r.payload)==null?void 0:o.primaryName,g=(d=a[0])==null?void 0:d.value,y=(p=(c=a[0])==null?void 0:c.payload)==null?void 0:p.referenceName,k=(f=a[1])==null?void 0:f.value;return s(An,{children:[e(v,{elementType:"h3",size:"S",weight:"heavy",children:t}),e(ze,{color:l,shape:"square",name:u,value:g!=null?`${tr(g)}%`:"--"}),e(ze,{color:i,shape:"square",name:y,value:k!=null?`${tr(k)}%`:"--"})]})}return null}function zb(n){var g,y,k,b,S;const{primaryInferences:a,referenceInferences:t}=_n(),l=a.name,i=(t==null?void 0:t.name)||"reference",{selectedTimestamp:r}=Gt(),o=m.useMemo(()=>r??new Date(a.endTime),[r,a.endTime]),d=m.useMemo(()=>({start:fr(o,2).toISOString(),end:o.toISOString()}),[o]),c=x.useLazyLoadQuery(dc,{dimensionId:n.dimensionId,timeRange:d}),p=m.useMemo(()=>{var w,P,_,z,R;const K=((w=c.dimension.segmentsComparison)==null?void 0:w.segments)??[],T=((_=(P=c.dimension.segmentsComparison)==null?void 0:P.totalCounts)==null?void 0:_.primaryValue)??0,D=((R=(z=c.dimension.segmentsComparison)==null?void 0:z.totalCounts)==null?void 0:R.referenceValue)??0;return K.map(Q=>{var ke,Ln;const V=((ke=Q.counts)==null?void 0:ke.primaryValue)??0,$=((Ln=Q.counts)==null?void 0:Ln.referenceValue)??0,N=Xr(Q.bin),le=V/T*100,re=$/D*100;return{name:N,primaryName:l,referenceName:i,primaryPercent:le,referencePercent:re}})},[(g=c.dimension.segmentsComparison)==null?void 0:g.segments,(k=(y=c.dimension.segmentsComparison)==null?void 0:y.totalCounts)==null?void 0:k.primaryValue,(S=(b=c.dimension.segmentsComparison)==null?void 0:b.totalCounts)==null?void 0:S.referenceValue,l,i]),{primaryBarColor:f,referenceBarColor:u}=cc();return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(v,{elementType:"h3",size:"S",color:"text-700",children:`Distribution comparison at ${Nn(new Date(d.end))}`})}),e(C,{flex:!0,children:e(qn,{children:s(ni,{data:p,margin:{top:15,right:18,left:18,bottom:5},children:[s("defs",{children:[s("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:f,stopOpacity:1}),e("stop",{offset:"95%",stopColor:f,stopOpacity:.5})]}),s("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:1}),e("stop",{offset:"95%",stopColor:u,stopOpacity:.5})]})]}),e(ma,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)"}),e(jn,{...Xl,content:e(Ab,{})}),e(Ra,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Ra,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const uc={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};uc.hash="f8a9fb08a14f63906e38bc247d50b189";const Nb=s(Aa,{variant:"info",placement:"top end",children:[e(oe,{weight:"heavy",level:4,children:"Population Stability Index"}),e(ia,{children:e(v,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."})}),e("footer",{children:e(ln,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function $b(n){const a=x.useFragment(uc,n.dimension);return s(U,{children:[s(h,{direction:"row",alignItems:"center",gap:"size-25",children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"PSI"}),Nb]}),e(v,{size:"L",children:_a(a.psi)})]})}const mc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},o],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,t,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,c],storageKey:null}]},params:{cacheID:"af2d25e28675891b3c8a6bc75027f731",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();mc.hash="6312b58dbb252b17efdf08d44dd58630";const pc=()=>{const{orange300:n,gray300:a}=Qn();return{color:n,barColor:a}};function Ob({active:n,payload:a,label:t}){var i;const{color:l}=pc();if(n&&a&&a.length){const r=((i=a[1])==null?void 0:i.value)??null;return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,name:"PSI",value:_a(r)}),e(Wt,{}),s("div",{css:F`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(Mn,{})}),e("span",{children:"Click to view details"})]})]})}return null}function Qb({dimensionId:n}){var y,k;const{timeRange:a}=On(),{selectedTimestamp:t,setSelectedTimestamp:l}=Gt(),i=Qa(a),r=x.useLazyLoadQuery(mc,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:Gr(a),countGranularity:i}),o=((y=r.embedding.driftTimeSeries)==null?void 0:y.data)||[],d=((k=r.embedding.trafficTimeSeries)==null?void 0:k.data.reduce((b,S)=>(b[S.timestamp]=S.value,b),{}))??{},c=o.map(b=>{const S=d[b.timestamp];return{...b,traffic:S,timestamp:new Date(b.timestamp).valueOf()}}),p=ja({samplingIntervalMinutes:i.samplingIntervalMinutes}),f=m.useCallback(b=>{const{activePayload:S}=b;if(S!=null&&S.length>0){const K=S[0].payload;l(new Date(K.timestamp))}},[l]),{color:u,barColor:g}=pc();return e(qn,{width:"100%",height:"100%",children:s(ft,{data:c,margin:kt,onClick:f,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:u,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:g,stopOpacity:0})]})]}),e(ma,{...qa,tickFormatter:b=>p(new Date(b))}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-color-grey-500)"}}),e(Tn,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{content:e(Ob,{})}),e(Ra,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(dt,{type:"monotone",dataKey:"value",stroke:u,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),t!=null?e(gs,{...Wr,x:t.getTime()}):null]})})}const gc=function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}}();gc.hash="1e10d0449d6607d9292f355548c41c78";function jb(n){const a=x.useFragment(gc,n.dimension);return s(U,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"% Empty"}),e(v,{size:"L",children:Pt(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(v,{size:"M",color:"purple-800",children:Pt(a.referencePercentEmpty)})]})}const yc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"9be05c72f19755036f4829777a96f97d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();yc.hash="1e843d6c8dbe05b389b24188c6bdb394";const qb=new Intl.NumberFormat([],{maximumFractionDigits:2}),fc=()=>{const{gray100:n}=Qn();return{color:n}};function Bb({active:n,payload:a,label:t}){var i;const{color:l}=fc();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?qb.format(r):"--";return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,name:"% Empty",value:o})]})}return null}function Ub({dimensionId:n}){var d;const{timeRange:a}=On(),t=Qa(a),i=((d=x.useLazyLoadQuery(yc,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}).embedding.percentEmptyTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],r=ja({samplingIntervalMinutes:t.samplingIntervalMinutes}),{color:o}=fc();return e(qn,{width:"100%",height:"100%",children:s(ft,{data:i,margin:kt,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:o,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:o,stopOpacity:0})]})}),e(ma,{...qa,tickFormatter:c=>r(new Date(c))}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{content:e(Bb,{})}),e(ys,{type:"monotone",dataKey:"value",stroke:o,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const hc=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}}();hc.hash="c306c8eafb1d34be464d3a658d5f94a7";function Hb(n){const a=x.useFragment(hc,n.dimension);return e("ul",{css:F`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(t=>{const l=a[t];return s("li",{css:F`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:t}),e(v,{size:"S","data-raw":l,children:ql(l)})]},t)})})}const kc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,c],storageKey:null}]},params:{cacheID:"0bb3d9faf9d7f0c2e27995120ae24e1c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();kc.hash="134f0dad0e0ecc7863dfbb0f437d829b";const Gb=Dl("~s");var bc=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(bc||{});const Wb=new Intl.NumberFormat([],{maximumFractionDigits:2});function Xa(n){return typeof n=="number"?Wb.format(n):"--"}const Sc=()=>{const n=Qn();return{outerColor:n.gray500,innerColor:n.gray300,lineColor:n.default}};function Jb({active:n,payload:a,label:t}){const{outerColor:l,innerColor:i,lineColor:r}=Sc();if(n&&a&&a.length){const o=a[0].payload;return s(An,{children:[e(v,{weight:"heavy",size:"S",children:`${Nn(new Date(t))}`}),e(ze,{color:l,name:"p99",value:Xa(o.p99_p01[0])}),e(ze,{color:i,name:"p75",value:Xa(o.p75_p25[0])}),e(ze,{color:r,name:"p50",value:Xa(o.p50)}),e(ze,{color:i,name:"p25",value:Xa(o.p75_p25[1])}),e(ze,{color:l,name:"p01",value:Xa(o.p99_p01[1])})]})}return null}function Zb({dimensionId:n}){var D,w,P,_,z;const{timeRange:a}=On(),t=Qa(a),l=x.useLazyLoadQuery(kc,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),i=((D=l.dimension.p99TimeSeries)==null?void 0:D.data.map(R=>R))||[],r=((w=l.dimension.p01TimeSeries)==null?void 0:w.data.map(R=>R))||[],o=((P=l.dimension.p75TimeSeries)==null?void 0:P.data.map(R=>R))||[],d=((_=l.dimension.p25TimeSeries)==null?void 0:_.data.map(R=>R))||[],c=((z=l.dimension.p50TimeSeries)==null?void 0:z.data.map(R=>R))||[],p=i.map((R,Q)=>({timestamp:new Date(R.timestamp).valueOf(),p99_p01:[R.value,r[Q].value],p75_p25:[o[Q].value,d[Q].value],p50:c[Q].value})),f=ja({samplingIntervalMinutes:t.samplingIntervalMinutes}),[u,g]=m.useState(Object.keys(bc).reduce((R,Q)=>(R[Q]=!1,R),{})),y=R=>{u[R.dataKey]||g({...u})},k=()=>{g({...u})},b=R=>{g({...u,[String(R.dataKey)]:!u[R.dataKey]})},{outerColor:S,innerColor:K,lineColor:T}=Sc();return e(qn,{width:"100%",height:"100%",children:s(ft,{data:p,margin:kt,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),s("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:K,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:K,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:K,stopOpacity:.7})]})]}),e(ma,{...qa,tickFormatter:R=>f(new Date(R))}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:R=>Gb(R),style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{content:e(Jb,{})}),e(cy,{onClick:b,onMouseOver:y,onMouseOut:k}),e(dt,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:u.p99_p01===!0}),e(dt,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:K,fill:"url(#p75_p25ColorUV)",hide:u.p75_p25===!0}),e(ys,{type:"monotone",dataKey:"p50",stroke:T,hide:u.p50===!0})]})})}const vc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}}();vc.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const Xb=Dl(".2f"),Cc=()=>{const{primary:n}=Qn();return{color:n}};function Yb({active:n,payload:a,label:t}){var i;const{color:l}=Cc();if(n&&a&&a.length){const r=(i=a[0])==null?void 0:i.value;return e(An,{children:e(ze,{color:l,shape:"square",name:t,value:r!=null?`${Xb(r)}%`:"--"})})}return null}function eS(n){const a=x.useFragment(vc,n.dimension),t=m.useMemo(()=>{var o,d,c;const i=((o=a.segmentsComparison)==null?void 0:o.segments)??[],r=((c=(d=a.segmentsComparison)==null?void 0:d.totalCounts)==null?void 0:c.primaryValue)??0;return i.map(p=>{var y;const f=((y=p.counts)==null?void 0:y.primaryValue)??0,u=Xr(p.bin),g=f/r*100;return{name:u,percent:g}})},[a]),{color:l}=Cc();return e(qn,{children:s(ni,{data:t,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:s("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:l,stopOpacity:1}),e("stop",{offset:"95%",stopColor:l,stopOpacity:.5})]})}),e(ma,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(Tn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(jn,{...Xl,content:e(Yb,{})}),e(Ra,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function S2(){const{dimensionId:n}=Be(),{timeRange:a}=On(),t=qe();Je(t);const{referenceInferences:l}=_n(),i=l!==null,r=i,o=t.dimension.shape!=="continuous",d=t.dimension.dataType==="numeric",c=ue(),p=x.useLazyLoadQuery(ac,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},hasReference:i});if(!n)throw new Error("Dimension ID is required to display a dimension");return e(Zr,{initialTimestamp:new Date(a.end),children:e(ae,{type:"slideOver",isDismissable:!0,onDismiss:()=>c(-1),children:e(X,{size:"L",title:t.dimension.name,children:e("main",{css:F`
              padding: var(--ac-global-dimension-static-size-100);
              display: flex;
              flex-direction: column;
              min-height: 400px;
              overflow-y: auto;
              height: 100%;
            `,children:e(m.Suspense,{fallback:e(Ce,{}),children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(eS,{dimension:p.dimension})}),e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(Vb,{dimensionId:n}),e(ha,{children:e(Eb,{dimension:p.dimension})})]})}),r?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:s(h,{direction:"column",alignItems:"stretch",children:[e(C,{width:"100%",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(Qb,{dimensionId:n})}),e(ha,{children:e($b,{dimension:p.dimension})})]})}),e(C,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(zb,{dimensionId:n})})})]})}):null,d?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(Zb,{dimensionId:n})}),e(ha,{children:e(Hb,{dimension:p.dimension})})]})}):null,o?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(wb,{dimensionId:n})}),e(ha,{children:e(Db,{dimension:p.dimension})})]})}):null,e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(Ub,{dimensionId:n}),e(ha,{children:e(jb,{dimension:p.dimension})})]})})]})})})})})})}const Fc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"03a9aafe3f08a9d093b029ff4a9e3253",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: GlobalID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    __isNode: __typename
    id
  }
}
`}}}();Fc.hash="5a662d77e69d2e9bb4eb2af4cad6b722";async function v2(n){const{dimensionId:a}=n.params;return x.fetchQuery(Fe,Fc,{id:a}).toPromise()}const C2=()=>{const n=rt(a=>a.defaultTab);return e(hr,{to:n,replace:!0})},Kc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"662cf4bec023d1f6542eb6ab6e13ffc4",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Kc.hash="bc529abcda2506cd71b12e5f4d579f36";const Tc=m.createContext(null);function Pa(){const n=pe.useContext(Tc);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function nS({initialFetchKey:n="initial",children:a}){const t=Fn(d=>d.traceStreamingEnabled),l=Fn(d=>d.setTraceStreamingEnabled),[i,r]=m.useState(n),o=m.useCallback(d=>{m.startTransition(()=>{r(d)})},[r]);return e(Tc.Provider,{value:{isStreaming:t,setIsStreaming:l,fetchKey:i,setFetchKey:o},children:a})}const Pc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[l];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"2b81cd60d6a8a82b6814df7a5a658114",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}}();Pc.hash="e110b84031cc6bfa6bb37751b9c69765";const Ic=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Pc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}}();Ic.hash="e110b84031cc6bfa6bb37751b9c69765";const xc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bae90b7000aa37d37050070d8504b41c",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();xc.hash="0a8e190e4d87acc87c161366f330e3af";const Dc={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:xc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Dc.hash="0a8e190e4d87acc87c161366f330e3af";const _c=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,t],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"88dfad5d25db7e03286a789f3ba37c75",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: GlobalID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();_c.hash="6a15ba35fe9e1e35aa4c517ab6309a2b";function aS({annotationName:n}){var i,r;const{projectId:a}=Be(),{timeRange:t}=Jt(),l=x.useLazyLoadQuery(_c,{annotationName:n,id:a,timeRange:{start:(i=t==null?void 0:t.start)==null?void 0:i.toISOString(),end:(r=t==null?void 0:t.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(m.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(tS,{annotationName:n,project:l.project})})]})}function tS(n){var y,k;const{project:a,annotationName:t}=n,{fetchKey:l}=Pa(),[i,r]=x.useRefetchableFragment(Dc,a);m.useEffect(()=>{m.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[l,r]);const o=Qn(),c=[Yr(t),o.default,o.gray600,o.gray400,o.gray200],p=(y=i==null?void 0:i.spanAnnotationSummary)==null?void 0:y.meanScore,f=(k=i==null?void 0:i.spanAnnotationSummary)==null?void 0:k.labelFractions,u=typeof p=="number",g=Array.isArray(f)&&f.length>0;return!u&&!g?e(v,{size:"L",children:"--"}):s(Se,{delay:0,placement:"bottom",children:[e($e,{children:s(h,{direction:"row",alignItems:"center",gap:"size-50",children:[g?e(ps,{width:24,height:24,children:e(us,{data:f,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",innerRadius:8,outerRadius:11,strokeWidth:0,stroke:"transparent",children:f.map((b,S)=>e(ms,{fill:c[S%c.length]},`cell-${S}`))})}):null,e(v,{size:"L",children:u?Gn(p):"--"})]})}),e(la,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",gap:"size-50",children:[g&&e("ul",{children:f.map((b,S)=>e("li",{children:e(ze,{color:c[S%c.length],name:b.label,shape:"square",value:es(b.fraction*100)})},b.label))}),g&&u?e(Wt,{}):null,u?s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{children:"mean"}),e(v,{children:Gn(p)})]}):null]})})})]})}const Lc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"60d7798d88e1408e6b6b0bebdc1716f5",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Lc.hash="15d0652aa260c80f62acec943f615d93";const wc={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Lc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};wc.hash="15d0652aa260c80f62acec943f615d93";const Ec=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"3ebd1cf66ef8f31c995ec6aae6505e94",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Ec.hash="4d50474ffa9b9e4a68d07f6e0777c144";function lS({evaluationName:n}){var i,r;const{projectId:a}=Be(),{timeRange:t}=Jt(),l=x.useLazyLoadQuery(Ec,{id:a,evaluationName:n,timeRange:{start:(i=t==null?void 0:t.start)==null?void 0:i.toISOString(),end:(r=t==null?void 0:t.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(m.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(iS,{evaluationName:n,project:l==null?void 0:l.project})})]})}function iS(n){var p,f,u,g;const{project:a}=n,{fetchKey:t}=Pa(),[l,i]=x.useRefetchableFragment(wc,a);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=(p=l==null?void 0:l.documentEvaluationSummary)==null?void 0:p.averageNdcg,o=(f=l==null?void 0:l.documentEvaluationSummary)==null?void 0:f.averagePrecision,d=(u=l==null?void 0:l.documentEvaluationSummary)==null?void 0:u.hitRate,c=(g=l==null?void 0:l.documentEvaluationSummary)==null?void 0:g.meanReciprocalRank;return s(Se,{delay:0,placement:"bottom",children:[e($e,{children:e(h,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:s(U,{children:[e(an,{metric:"ndcg",score:r},"ndcg"),e(an,{metric:"precision",score:o},"precision"),e(an,{metric:"hit rate",score:d},"hit")]})})}),e(la,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"average ndcg"}),e(v,{children:typeof r=="number"?Gn(r):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"average precision"}),e(v,{children:typeof o=="number"?Gn(o):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"mean reciprocal rank"}),e(v,{children:typeof c=="number"?Gn(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"hit rate"}),e(v,{children:typeof d=="number"?Gn(d):"--"})]})]})})})]})}function rS(n){const{extra:a}=n,{fetchKey:t}=Pa(),[l,i]=x.useRefetchableFragment(Ic,n.project);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=l==null?void 0:l.latencyMsP50,o=l==null?void 0:l.latencyMsP99,d=l==null?void 0:l.tokenCountTotal,c=l==null?void 0:l.tokenCountPrompt,p=l==null?void 0:l.tokenCountCompletion,f=l==null?void 0:l.spanAnnotationNames,u=l==null?void 0:l.documentEvaluationNames;return e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:F`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image: linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:s(h,{direction:"row",gap:"size-400",alignItems:"center",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:Sa(l==null?void 0:l.traceCount)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),s(Se,{delay:0,placement:"bottom",children:[e($e,{children:e(v,{size:"L",children:Sa(d)})}),e(la,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"Prompt Tokens"}),e(v,{children:typeof c=="number"?cl(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Completion Tokens"}),e(v,{children:typeof p=="number"?cl(p):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Total Tokens"}),e(v,{children:typeof d=="number"?cl(d):"--"})]})]})})})]})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),r!=null?e(Me,{latencyMs:r,size:"L"}):e(v,{size:"L",children:"--"})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P99"}),o!=null?e(Me,{latencyMs:o,size:"L"}):e(v,{size:"L",children:"--"})]}),f.map(g=>e(qt,{fallback:Vg,children:e(aS,{annotationName:g},g)},g)),u.map(g=>e(lS,{evaluationName:g},`document-${g}`))]})}),e(C,{flex:"none",paddingStart:"size-100",children:a})]})})}const Rc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"4e136f41c0942f253822336dc0c5b291",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();Rc.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const Mc={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Rc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Mc.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const sS=2e3,oS=["spans","traces","sessions"];function dS(n){const{isStreaming:a,setIsStreaming:t,setFetchKey:l}=Pa(),r=mt().pathname.split("/").pop()||"",o=oS.includes(r)&&a,[d,c]=x.useRefetchableFragment(Mc,n.project),p=m.useRef(d.streamingLastUpdatedAt),f=m.useCallback(()=>{o&&m.startTransition(()=>{c({},{fetchPolicy:"store-and-network"})})},[o,c]),u=d.streamingLastUpdatedAt;return m.useEffect(()=>{u!=null&&(p.current==null||p.current<u)&&(p.current=u,l(`fetch-traces-${u}`))},[l,u]),m0(f,sS),e(Fa,{labelPlacement:"start",isSelected:a,onChange:()=>{t(!a)},children:"Stream"})}const cS=F`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function F2(){const{projectId:n}=Be(),{timeRange:a}=Jt();return e(m.Suspense,{fallback:e(Ce,{}),children:e(mS,{projectId:n,timeRange:a})})}const uS=["spans","traces","sessions","config"],lr=n=>uS.includes(n),ir={spans:0,traces:1,sessions:2,config:3};function mS({projectId:n,timeRange:a}){const t=rt(_=>_.treatOrphansAsRoots),l=m.useMemo(()=>{var _,z;return{start:(_=a==null?void 0:a.start)==null?void 0:_.toISOString(),end:(z=a==null?void 0:a.end)==null?void 0:z.toISOString()}},[a]),i=ue(),{rootPath:r,tab:o}=il(),d=x.useLazyLoadQuery(Kc,{id:n,timeRange:l},{fetchPolicy:"store-and-network",fetchKey:`${n}-${l.start}-${l.end}`}),[c,p,f]=x.useQueryLoader(lo),[u,g,y]=x.useQueryLoader(io),[k,b,S]=x.useQueryLoader(ro),[K,T,D]=x.useQueryLoader(so),w=lr(o)?ir[o]:0;m.useEffect(()=>(w===0?g({id:n,timeRange:l,orphanSpanAsRootSpan:t}):w===1?p({id:n,timeRange:l}):w===2?b({id:n,timeRange:l}):w===3&&T({id:n}),()=>{y(),S(),f(),D()}),[p,n,l,w,y,S,f,g,b,T,D,t]);const P=m.useCallback(_=>{m.startTransition(()=>{i(_===1?`${r}/traces`:_===2?`${r}/sessions`:_===3?`${r}/config`:`${r}/spans`)})},[i,r]);return e(nS,{children:s("main",{css:cS,children:[e(rS,{project:d.project,extra:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(dS,{project:d.project}),e(ns,{})]})}),e(oo.Provider,{value:{spansQueryReference:u??null,sessionsQueryReference:k??null,tracesQueryReference:c??null,projectConfigQueryReference:K??null},children:s(Ge,{onSelectionChange:_=>{typeof _=="string"&&lr(_)&&P(ir[_])},selectedKey:o,children:[s(He,{children:[e(ne,{id:"spans",children:"Spans"}),e(ne,{id:"traces",children:"Traces"}),e(ne,{id:"sessions",children:"Sessions"}),e(ne,{id:"config",children:"Config"})]}),e(de,{padded:!1,id:"spans",children:e(Ke,{})}),e(de,{padded:!1,id:"traces",children:e(Ke,{})}),e(de,{padded:!1,id:"sessions",children:e(Ke,{})}),e(de,{padded:!1,id:"config",children:e(Ke,{})})]})})]})})}const Vc=m.createContext(null);function Ac(){const n=m.useContext(Vc);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function pS(n){const[a,t]=m.useState(""),l=m.useCallback(i=>{m.startTransition(()=>{t(i)})},[]);return e(Vc.Provider,{value:{filterIoSubstring:a,setFilterIoSubstring:l},children:n.children})}const zc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},t={defaultValue:30,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},p={kind:"Variable",name:"first",variableName:"first"},f={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y=[d,c,p,f,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,f],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:y,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:y,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bc674951f109dbbbb72aa937d1165279",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 30
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_2MhLSo
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions_2MhLSo on Project {
  name
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();zc.hash="36dfca4fe1c2c0f19a1fd0e2ac1c6316";const Nc=function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:zc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();Nc.hash="36dfca4fe1c2c0f19a1fd0e2ac1c6316";const $c=m.createContext(null);function gS({children:n,...a}){const[t]=m.useState(()=>Ag(a));return e($c.Provider,{value:t,children:n})}function je(n,a){const t=pe.useContext($c);if(!t)throw new Error("Missing TracingContext.Provider in the tree");return ut(t,n,a)}const yS=F`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,fS=F`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function hS(n){const{placeholder:a="Search messages"}=n,[t,l]=m.useState(!1),{filterIoSubstring:i,setFilterIoSubstring:r}=Ac(),{theme:o}=$n();return e("div",{"data-is-focused":t,className:"sessions-substring-field",css:fS,children:s(h,{direction:"row",children:[e(wl,{children:e(L,{svg:e(Yl,{})})}),e(ua,{css:yS,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>l(!0),onBlur:()=>l(!1),value:i,onChange:r,height:"36px",width:"100%",theme:o==="light"?da:ca,placeholder:a}),e("button",{css:F`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${i!==""?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(L,{svg:e(Zt,{})})})]})})}const kS="pip install openinference-instrumentation",bS=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function SS(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(oe,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Xe,{children:e(hn,{value:kS})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(oe,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Xe,{children:e(hn,{value:bS})}),e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(ln,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const vS="npm install @arizeai/openinference-core --save",CS=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function FS(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(oe,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Xe,{children:e(hn,{value:vS})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(oe,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Xe,{children:e(zg,{value:CS})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(ln,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function KS(){const[n,a]=m.useState("Python");return e(X,{title:"Setup Sessions for this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(Ot,{language:n,onChange:a})}),n==="Python"?e(SS,{}):e(FS,{})]})})}function TS(){const[n,a]=m.useState(null),t=()=>{a(e(KS,{}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:F`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",e(M,{leadingVisual:e(L,{svg:e(Ka,{})}),onPress:t,children:"Setup Sessions"})]})})}),e(ae,{onDismiss:()=>a(null),isDismissable:!0,type:"slideOver",children:n})]})}const hi=F`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,rr=ti,Oc=({table:n})=>{const a=ue();return e("tbody",{children:n.getRowModel().rows.map(t=>e("tr",{onClick:()=>a(`${encodeURIComponent(t.id)}`),children:t.getVisibleCells().map(l=>e("td",{style:{height:1,width:`calc(var(--col-${l.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${l.column.id}-size) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Z(l.column.columnDef.cell,l.getContext())},l.id))},t.id))})},PS=pe.memo(Oc,(n,a)=>n.table.options.data===a.table.options.data);function IS(n){const a=m.useRef(null),[t,l]=m.useState([]),{filterIoSubstring:i}=Ac(),{fetchKey:r}=Pa(),{data:o,loadNext:d,hasNext:c,isLoadingNext:p,refetch:f}=x.usePaginationFragment(Nc,n.project),u=m.useMemo(()=>o.sessions.edges.map(({session:$})=>({...$,tokenCountTotal:$.tokenUsage.total})),[o.sessions]),g=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:Ee},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:Ee},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:Ee},{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:Re},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:Re},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:$})=>{const N=$();return N===null||typeof N!="number"?null:e(Me,{latencyMs:N})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:$})=>{const N=$();return N===null||typeof N!="number"?null:e(Me,{latencyMs:N})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({row:$,getValue:N})=>{const le=N();if(le==null||typeof le!="number")return"--";const{prompt:re,completion:ke}=$.original.tokenUsage;return e(oa,{tokenCountTotal:le,tokenCountPrompt:re||0,tokenCountCompletion:ke||0})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:as}];m.useEffect(()=>{const $=t[0];m.startTransition(()=>{f({sort:$?{col:$.id,dir:$.desc?"desc":"asc"}:{col:"startTime",dir:"desc"},after:null,first:rr,filterIoSubstring:i},{fetchPolicy:"store-and-network"})})},[t,f,i,r]);const y=pe.useCallback($=>{if($){const{scrollHeight:N,scrollTop:le,clientHeight:re}=$;N-le-re<300&&!p&&c&&d(rr)}},[c,p,d]),[k,b]=m.useState({}),S=je($=>$.columnVisibility),K=je($=>$.columnSizing),T=je($=>$.setColumnSizing),D=Le({columns:g,data:u,onExpandedChange:b,manualSorting:!0,state:{sorting:t,expanded:k,columnVisibility:S,columnSizing:K},columnResizeMode:"onChange",onColumnSizingChange:T,enableSubRowSelection:!1,onSortingChange:l,getCoreRowModel:we(),getSortedRowModel:Pn(),getExpandedRowModel:kr(),getRowId:$=>$.id}),P=D.getRowModel().rows.length===0,{columnSizingInfo:_,columnSizing:z}=D.getState(),R=D.getFlatHeaders,Q=g.length,V=pe.useMemo(()=>{const $=R(),N={};for(let le=0;le<$.length;le++){const re=$[le];N[`--header-${re.id}-size`]=re.getSize(),N[`--col-${re.column.id}-size`]=re.column.getSize()}return N},[R,_,z,Q]);return s("div",{css:hi,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(hS,{})}),e("div",{css:F`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:$=>y($.target),ref:a,children:s("table",{css:sa,style:{...V,width:D.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:D.getHeaderGroups().map($=>e("tr",{children:$.headers.map(N=>e("th",{style:{width:`calc(var(--header-${N.id}-size) * 1px)`},children:N.isPlaceholder?null:s(U,{children:[s("div",{"data-sortable":N.column.getCanSort(),className:N.column.getCanSort()?"cursor-pointer":"",onClick:N.column.getToggleSortingHandler(),style:{left:N.getStart(),width:N.getSize()},children:[Z(N.column.columnDef.header,N.getContext()),N.column.getIsSorted()?e(L,{className:"sort-icon",svg:N.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]}),e("div",{onMouseDown:N.getResizeHandler(),onTouchStart:N.getResizeHandler(),className:`resizer ${N.column.getIsResizing()?"isResizing":""}`})]})},N.id))},$.id))}),P?e(TS,{}):_.isResizingColumn?e(PS,{table:D}):e(Oc,{table:D})]})})]})}const Qc=m.createContext(null);function rl(){const n=m.useContext(Qc);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function ki(n){const[a,t]=m.useState(""),l=m.useCallback(r=>{m.startTransition(()=>{t(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?t(a+" and "+r):t(r)})},[a]);return e(Qc.Provider,{value:{filterCondition:a,setFilterCondition:l,appendFilterCondition:i},children:n.children})}function bi({children:n}){const{projectId:a}=Be();if(!a)throw new Error("projectId is required");const{tab:t}=il();if(!Ys(t))throw new Error(`Invalid tab: ${t}`);return e(gS,{projectId:a,tableId:t||"table",children:n})}function xS({queryReference:n}){const a=x.usePreloadedQuery(ro,n);return e(pS,{children:e(IS,{project:a.project})})}const K2=()=>{const{sessionsQueryReference:n}=el();return n?s(bi,{children:[e(ki,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(xS,{queryReference:n})})}),e(m.Suspense,{children:e(Ke,{})})]}):null},jc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:30,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},r={defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},o={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},d={defaultValue:null,kind:"LocalArgument",name:"timeRange"},c=[{kind:"Variable",name:"id",variableName:"id"}],p={kind:"Variable",name:"after",variableName:"after"},f={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},u={kind:"Variable",name:"first",variableName:"first"},g={kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},y={kind:"Variable",name:"sort",variableName:"sort"},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},K=[p,f,u,{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},g,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],T=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r,o,d],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[p,f,u,g,y],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,o,d,l],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,{kind:"TypeDiscriminator",abstractKey:"__isNode"},b,{kind:"InlineFragment",selections:[S,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:K,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:T,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:T,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[S,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:K,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"724a34c18ec17312b01be5ccae4d7159",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $orphanSpanAsRootSpan: Boolean
  $rootSpansOnly: Boolean = true
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_xYL0c
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_xYL0c on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, rootSpansOnly: $rootSpansOnly, filterCondition: $filterCondition, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        spanId
        trace {
          id
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();jc.hash="3abfb2f2fae91e346221687ee5213714";const qc=function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"orphanSpanAsRootSpan"},{defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:jc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();qc.hash="3abfb2f2fae91e346221687ee5213714";const DS=F`
  border-radius: var(--ac-global-dimension-size-50);
  border: 1px solid var(--ac-global-color-grey-200);
  padding: var(--ac-global-dimension-size-50)
    var(--ac-global-dimension-size-100);
  transition: background-color 0.2s;

  &[role="button"] {
    cursor: pointer;
    &:hover {
      background-color: var(--ac-global-color-grey-200);
      border-color: var(--ac-global-color-grey-400);
    }
  }
  max-width: 100%;
  height: var(--ac-global-dimension-size-200);
`;function _S({metadata:n,onClick:a}){const t=m.useMemo(()=>{let l=n;return l.startsWith("{")&&(l=l.slice(1)),l.endsWith("}")&&(l=l.slice(0,-1)),l},[n]);return e("div",{css:F(DS),role:a?"button":"label","aria-label":"metadata",onClick:l=>{l.stopPropagation(),l.preventDefault(),a==null||a()},children:e(h,{direction:"row",justifyContent:"space-between",alignItems:"center",height:"100%",children:e(st,{maxWidth:"100%",children:e(v,{children:t})})})})}function LS(n){return n.replaceAll(`
`,"\\n").replaceAll('"','\\"')}function wS(n){return typeof n=="boolean"?n?"True":"False":typeof n=="number"?n.toString():typeof n=="string"?`"${LS(n)}"`:""}const Bc=(n,a)=>`metadata['${n}'] == ${wS(a)}`;function ES({children:n,metadata:a,width:t}){const{appendFilterCondition:l}=rl(),i=Object.entries(a).map(([r,o])=>({key:r,value:String(o),filterCondition:Bc(r,o)}));return s(Se,{delay:500,offset:3,children:[e($e,{children:n}),e(la,{UNSAFE_style:{minWidth:t},children:s(h,{direction:"row",wrap:"nowrap",gap:"size-100",children:[e(h,{flexBasis:"40%",children:s(h,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Metadata"}),e("ul",{css:F`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-size-100);
                  overflow-y: auto;
                  max-height: 200px;
                  scrollbar-gutter: stable;
                  padding-right: var(--ac-global-dimension-size-50);
                `,children:i.map(({key:r,value:o})=>e("li",{children:s(h,{direction:"row",gap:"size-100",children:[e(h,{flexBasis:"30%",width:0,children:e(st,{maxWidth:"100%",children:e(v,{weight:"heavy",color:"inherit",size:"XS",children:r})})}),e(h,{flexBasis:"70%",flexShrink:1,justifyContent:"end",width:0,children:e(st,{maxWidth:"100%",children:e(v,{color:"inherit",size:"XS",maxWidth:"100%",children:o})})})]})},r))})]})}),e(C,{borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",flexBasis:"60%",borderStartWidth:"thin",children:s(h,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:F`
                  display: flex;
                  flex-direction: row;
                  gap: var(--ac-global-dimension-size-100);
                  padding: var(--ac-global-dimension-size-50) 0;
                  flex-wrap: wrap;
                `,children:i.map(({key:r,filterCondition:o})=>e("li",{children:s("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),l(o)},css:F`
                        all: unset;
                        color: var(--ac-global-text-color-900);
                        border: 1px solid var(--ac-global-color-grey-300);
                        border-radius: 4px;
                        padding: var(--ac-global-dimension-size-50)
                          var(--ac-global-dimension-size-100);
                        cursor: pointer;
                        transition: background-color 0.2s;
                        &:hover {
                          background-color: var(--ac-global-color-gray-300);
                        }
                      `,children:["Match ",r]})},r))})]})})]})})]})}const Uc=({metadata:n})=>{const{appendFilterCondition:a}=rl(),[t,l]=pe.useMemo(()=>{try{if(typeof n!="string")throw new Error("Metadata is not a string");const i=Ng(n),r=JSON.stringify(i);if(Object.keys(i).length===0)throw new Error("Metadata is empty");return[i,r]}catch{return[null,null]}},[n]);return!t||!l?"--":e("div",{style:{maxWidth:"100%"},children:e(ES,{width:"800px",metadata:t,children:e(_S,{metadata:l,onClick:()=>{const[i,r]=Object.entries(t)[0],o=Bc(i,r);a(o)}})})})};function Hc(n){const{appendFilterCondition:a}=rl(),{annotation:t}=n,{name:l,label:i,score:r}=t,o=m.useMemo(()=>{const d=[];return i!=null&&(d.push({filterName:"Match label",filterCondition:`annotations['${l}'].label == "${i}"`}),d.push({filterName:"Exclude label",filterCondition:`annotations['${l}'].label != "${i}"`})),typeof r=="number"&&(d.push({filterName:"Greater than score",filterCondition:`annotations['${l}'].score > ${r}`}),d.push({filterName:"Less than score",filterCondition:`annotations['${l}'].score < ${r}`}),d.push({filterName:"Equals score",filterCondition:`annotations['${l}'].score == ${r}`})),d},[l,i,r]);return s(C,{borderStartWidth:"thin",borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",width:300,children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:F`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-100);
          color: var(--ac-global-color-primary);
          padding: var(--ac-global-dimension-size-100) 0;
          flex-wrap: wrap;
        `,children:o.map(d=>e("li",{children:e(RS,{onClick:()=>{a(d.filterCondition)},children:d.filterName})},d.filterName))})]})}function RS({onClick:n,children:a}){return e("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),n()},className:"button--reset",css:F`
        color: var(--ac-global-text-color-900);
        border: 1px solid var(--ac-global-color-grey-300);
        border-radius: 4px;
        padding: var(--ac-global-dimension-size-50)
          var(--ac-global-dimension-size-100);
        cursor: pointer;
        transition: background-color 0.2s;
        &:hover {
          background-color: var(--ac-global-color-gray-300);
        }
      `,children:a})}function MS(){const n=rt(t=>t.treatOrphansAsRoots),a=rt(t=>t.setTreatOrphansAsRoots);return s(_t,{children:[e(M,{size:"M","aria-label":"Filter Configuration",leadingVisual:e(L,{svg:e($g,{})})}),s(jr,{children:[e(qr,{}),e(Dt,{children:e(C,{padding:"size-100",children:e(h,{direction:"column",gap:"size-100",children:e(Fa,{isSelected:n,onChange:t=>{a(t)},children:"Treat Orphan Spans as Roots"})})})})]})]})}function VS({projectName:n}){const[a,t]=m.useState("Python");return e(X,{title:"Send Traces to this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(Ot,{language:a,onChange:t})}),a==="Python"?e(ts,{projectName:n}):e(ls,{projectName:n})]})})}function Gc({projectName:n}){const[a,t]=m.useState(null),l=()=>{t(e(VS,{projectName:n}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:F`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found that match the selected filters",e(M,{variant:"default",leadingVisual:e(L,{svg:e(Ka,{})}),onPress:l,children:"Get Started"})]})})}),e(ae,{onDismiss:()=>t(null),isDismissable:!0,type:"slideOver",children:a})]})}const Wc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};Wc.hash="ad01e6897ad1ea779eb346d85783b8b4";const AS=["spanKind","name"];function Jc(n){return e(El,{menu:e(zS,{...n}),triggerProps:{placement:"bottom end"},children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(L,{svg:e(Og,{})}),"Columns"]})})}const It=F`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function zS(n){const{columns:a}=n,t=je(c=>c.columnVisibility),l=je(c=>c.setColumnVisibility),i=m.useMemo(()=>a.filter(c=>!AS.includes(c.id)),[a]),r=m.useMemo(()=>i.every(c=>{const p=t[c.id];return p??!0}),[i,t]),o=m.useCallback(c=>{const{name:p,checked:f}=c.target;l({...t,[p]:f})},[t,l]),d=m.useCallback(c=>{const{checked:p}=c.target,f=i.reduce((u,g)=>({...u,[g.id]:p}),{});l(f)},[i,l]);return e("div",{css:F`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:s(C,{paddingTop:"size-50",paddingBottom:"size-50",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:It,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:d}),"span columns"]})})}),e("ul",{children:i.map(c=>{const p=t[c.id],f=p??!0,u=typeof c.columnDef.header=="string"?c.columnDef.header:c.id;return e("li",{css:It,children:s("label",{children:[e("input",{type:"checkbox",name:c.id,checked:f,onChange:o}),u]})},c.id)})}),e(NS,{...n})]})})}function NS({query:n}){const a=x.useFragment(Wc,n),t=je(o=>o.annotationColumnVisibility),l=je(o=>o.setAnnotationColumnVisibility),i=m.useMemo(()=>a.spanAnnotationNames.every(o=>t[o]||!1),[a.spanAnnotationNames,t]),r=m.useCallback(()=>{const o=a.spanAnnotationNames.reduce((d,c)=>({...d,[c]:!i}),{});l(o)},[a.spanAnnotationNames,l,i]);return s("section",{children:[e(C,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:"thin",children:e("div",{css:It,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-evaluations-all",checked:i,onChange:r}),"feedback"]})})}),e("ul",{children:a.spanAnnotationNames.map(o=>{const d=t[o]??!1;return e("li",{css:It,children:s("label",{children:[e("input",{type:"checkbox",name:o,checked:d,onChange:()=>{l({...t,[o]:!d})}}),o]})},o)})})]})}const Zc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"29583e7ec666cef832dc7effb9e75678",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Zc.hash="22836f192038b0c40201d3b25aad65b4";const Xc=F`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Yc=F`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function $S(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function OS(n,a){if(!n)return{isValid:!0,errorMessage:null};const t=await pt.fetchQuery(Fe,Zc,{condition:n,id:a}).toPromise();if(!t)throw new Error("Filter condition validation is null");return t.project.validateSpanFilterCondition}const QS=[ei.of([{key:"Enter",run:n=>!0}]),yt(),cs({override:[$S]})];function eu(n){const{onValidCondition:a,placeholder:t="filter condition (e.x. span_kind == 'LLM')"}=n,[l,i]=m.useState(!1),[r,o]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=rl(),f=m.useDeferredValue(d),{theme:u}=$n(),g=u==="light"?da:ca,{projectId:y}=Be();m.useEffect(()=>{OS(f,y).then(S=>{S!=null&&S.isValid?(o(""),m.startTransition(()=>{a(f)})):o((S==null?void 0:S.errorMessage)??"Invalid filter condition")})},[a,f,y]);const k=r!=="";return s("div",{"data-is-focused":l,"data-is-invalid":k,className:"span-filter-condition-field",css:Yc,children:[s(h,{direction:"row",children:[e(wl,{children:e(L,{svg:e(Yl,{})})}),e(ua,{css:Xc,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:t,extensions:QS}),e("button",{css:F`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(L,{svg:e(Zt,{})})}),s(Va,{placement:"bottom right",children:[e($e,{children:e("button",{css:F`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(L,{svg:e(Dn,{})})})}),e(jS,{onAddFilterConditionSnippet:p})]})]}),s(Se,{isOpen:k&&l,placement:"bottom",children:[e($e,{children:e("div",{})}),e(la,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function jS(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",padding:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(h,{direction:"column",gap:"size-100",children:[e(fa,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e(fa,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e(fa,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e(fa,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(fa,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e(fa,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e(fa,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function fa(n){const{initialSnippet:a,onAddFilterConditionSnippet:t}=n,[l,i]=m.useState(a),{theme:r}=$n(),o=r==="light"?da:ca;return e(ra,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:F(Yc,F`
              flex: 1 1 auto;
            `),children:e(ua,{value:l,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[yt()],editable:!0,onChange:i,theme:o,css:Xc})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>t(l),leadingVisual:e(L,{svg:e(Dn,{})})})]})})}const nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"traceIds"}],a=[{alias:null,args:[{kind:"Variable",name:"traceIds",variableName:"traceIds"}],concreteType:"Query",kind:"LinkedField",name:"deleteTraces",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarDeleteTracesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarDeleteTracesMutation",selections:a},params:{cacheID:"eb52eb7c9b255069f86fde333d3c1c75",id:null,metadata:{},name:"SpanSelectionToolbarDeleteTracesMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarDeleteTracesMutation(
  $traceIds: [GlobalID!]!
) {
  deleteTraces(traceIds: $traceIds) {
    __typename
  }
}
`}}}();nu.hash="5283cfa8a6e985223f13d95395852b17";const au=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();au.hash="5e3aef907285081a06c0e0360045e865";const tu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6d459b61a36b99979f025742892941f9",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};tu.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const lu={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:tu}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};lu.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const iu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"5fb28a402f330dd235295da21efea58b",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};iu.hash="7cd8a13144d97d2b5294f2a09c9e1351";function qS(n){const{onCreateNewDataset:a,onDatasetSelected:t}=n,[l,i]=m.useState(""),r=x.useLazyLoadQuery(iu,{},{fetchPolicy:"network-only"});return s(q,{title:"Add to Dataset",variant:"compact",backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},extra:e(M,{variant:"default",size:"S",onPress:a,children:"New Dataset"}),children:[e(C,{padding:"size-100",children:e(Qg,{onChange:o=>{i(o)},children:e(se,{placeholder:"Search datasets"})})}),e(C,{borderTopWidth:"thin",borderColor:"light",children:e("div",{css:F`
            height: 400px;
            overflow-y: auto;
            min-width: 300px;
          `,children:e(BS,{query:r,search:l,onDatasetSelected:t})})})]})}function BS(n){const{search:a,onDatasetSelected:t}=n,[l]=x.useRefetchableFragment(lu,n.query),i=m.useMemo(()=>{let o=l.datasets.edges.map(d=>d.dataset);return a&&(o=o.filter(d=>d.name.toLowerCase().includes(a.toLowerCase()))),o},[a,l]);return i.length===0?e(C,{padding:"size-200",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",flex:"1 1 auto",children:e(v,{children:"No datasets found"})})}):e(Vt,{selectionMode:"single",onSelectionChange:o=>{if(typeof o=="object"){const d=Array.from(o);t(d[0])}},children:i.map(o=>e(ie,{children:o.name},o.id))})}function ru(n){const a=ue(),[t,l]=m.useState(null),i=he(),r=Pe(),[o,d]=m.useState(!1),{selectedSpans:c,onClearSelection:p}=n,[f,u]=x.useMutation(au),[g,y]=x.useMutation(nu),k=c.length!==1,b=m.useCallback(T=>{f({variables:{input:{datasetId:T,spanIds:c.map(D=>D.id)}},onCompleted:()=>{i({title:"Examples added to dataset",message:`${c.length} example${k?"s have":" has"} been added to the dataset.`,action:{text:"View dataset",onClick:()=>{a(`/datasets/${T}/examples`)}}}),p()},onError:D=>{const w=De(D);r({title:"An error occurred",message:`Failed to add spans to dataset: ${(w==null?void 0:w[0])??D.message}`})}})},[f,c,i,k,p,a,r]),S=m.useCallback(()=>{const T=[...new Set(c.map(D=>D.traceId))];g({variables:{traceIds:T},onCompleted:()=>{i({title:"Traces deleted",message:`${T.length} trace${T.length!==1?"s have":" has"} been deleted.`}),p()},onError:D=>{const w=De(D);r({title:"An error occurred",message:`Failed to delete traces: ${(w==null?void 0:w[0])??D.message}`})}})},[g,c,i,p,r]),K=m.useCallback(()=>{l(s(X,{size:"S",title:"Delete Traces",isDismissable:!0,onDismiss:()=>l(null),children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete the selected spans and their traces?"})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{S(),l(null)},children:"Delete Traces"})})})]}))},[S]);return s("div",{css:F`
        position: absolute;
        bottom: var(--ac-global-dimension-size-600);
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        box-shadow: 8px 8px 20px 0 rgba(0, 0, 0, 0.4);
        border-radius: var(--ac-global-rounding-medium);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{children:`${c.length} span${k?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:p,children:"Cancel"}),s(Va,{placement:"top end",crossOffset:300,isOpen:o,onOpenChange:T=>{d(T)},children:[e($e,{children:e(M,{variant:"default",size:"S",leadingVisual:u?e(We,{}):e(zt,{}),onPress:()=>{d(!0)},isDisabled:u,children:u?"Adding...":"Add to Dataset"})}),e(m.Suspense,{children:e(qS,{onDatasetSelected:T=>{b(T),d(!1)},onCreateNewDataset:()=>{d(!1),l(e(X,{title:"New Dataset",isDismissable:!0,onDismiss:()=>l(null),children:e(is,{onDatasetCreateError:T=>{const D=De(T);r({title:"Dataset creation failed",message:`Failed to create dataset: ${(D==null?void 0:D[0])??T.message}`})},onDatasetCreated:T=>{l(null),i({title:"Dataset created",message:`${T.name} has been successfully created.`}),d(!0)}})}))}})})]}),e(M,{variant:"danger",size:"S",leadingVisual:e(L,{svg:y?e(We,{}):e(Ye,{})}),isDisabled:y,onPress:K,children:y?"Deleting...":"Delete"})]})]})}),e(ae,{onDismiss:()=>{l(null)},children:t})]})}const ct="annotations",En=":",su={col:"startTime",dir:"desc"};function ou(n){let a=null,t=null;if(n.id&&n.id.startsWith(ct)){const[,l,i]=n.id.split(En);t={attr:l,name:i}}else a=n.id;return{col:a,evalResultKey:t,dir:n.desc?"desc":"asc"}}const sr=ti,US={minSize:100};function HS(n){return n==="root"||n==="all"}const du=({table:n})=>{const a=ue();return e("tbody",{children:n.getRowModel().rows.map(t=>e("tr",{onClick:()=>a(`${t.original.trace.traceId}?selectedSpanNodeId=${t.original.id}`),children:t.getVisibleCells().map(l=>e("td",{style:{height:1,width:`calc(var(--col-${l.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${l.column.id}-size) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Z(l.column.columnDef.cell,l.getContext())},l.id))},t.id))})},GS=pe.memo(du,(n,a)=>n.table.options.data===a.table.options.data);function WS(n){const{fetchKey:a}=Pa(),t=!!br("/projects/:projectId/spans"),l=m.useRef(null),i=m.useRef(!0),[r,o]=m.useState({}),[d,c]=m.useState([]),[p,f]=m.useState(""),[u,g]=m.useState(!0),y=je(I=>I.columnVisibility),{data:k,loadNext:b,hasNext:S,isLoadingNext:K,refetch:T}=x.usePaginationFragment(qc,n.project),D=je(I=>I.annotationColumnVisibility),w=m.useMemo(()=>Object.keys(D).filter(I=>D[I]),[D]),P=m.useMemo(()=>k.spans.edges.map(({span:A})=>A),[k]),_=w.map(I=>({header:I,columns:[{header:"label",accessorKey:`${ct}${En}label${En}${I}`,cell:({row:A})=>{const B=A.original.spanAnnotations.find(G=>G.name===I);return B?B.label:null}},{header:"score",accessorKey:`${ct}${En}score${En}${I}`,cell:({row:A})=>{const B=A.original.spanAnnotations.find(G=>G.name===I);return B?B.score:null}}]})),z=[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Aa,{children:[e(oe,{level:3,weight:"heavy",children:"Feedback"}),e(ia,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"feedback",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:I})=>s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[I.original.spanAnnotations.map(A=>e(za,{annotation:A,layout:"horizontal",width:"500px",extra:e(Hc,{annotation:A}),children:e(zn,{annotation:A,annotationDisplayPreference:"label"})},A.name)),I.original.documentRetrievalMetrics.map(A=>s(U,{children:[e(an,{name:A.evaluationName,metric:"ndcg",score:A.ndcg},"ndcg"),e(an,{name:A.evaluationName,metric:"precision",score:A.precision},"precision"),e(an,{name:A.evaluationName,metric:"hit",score:A.hit},"hit")]}))]})},..._],R=[{id:"select",maxSize:10,header:({table:I})=>e(na,{checked:I.getIsAllRowsSelected(),indeterminate:I.getIsSomeRowsSelected(),onChange:I.getToggleAllRowsSelectedHandler()}),cell:({row:I})=>e(na,{checked:I.getIsSelected(),disabled:!I.getCanSelect(),indeterminate:I.getIsSomeSelected(),onChange:I.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:I})=>{const A=I();return e(h,{direction:"row",gap:"size-50",alignItems:"center",children:e(jt,{statusCode:A})})}},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:I})=>e(jl,{spanKind:I()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:I,row:A})=>{const B=A.original,{traceId:G}=B.trace;return e(Ze,{to:`${G}?selectedSpanNodeId=${B.id}`,children:I()})}},{header:"input",accessorKey:"input.value",cell:Ee,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:Ee,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:({row:I})=>e(Uc,{metadata:I.original.metadata}),enableSorting:!1},...z,{header:"start time",accessorKey:"startTime",cell:Re},{header:"latency",accessorKey:"latencyMs",cell:({getValue:I})=>{const A=I();return A===null||typeof A!="number"?null:e(Me,{latencyMs:A})}},{header:u?"cumulative tokens":"total tokens",accessorKey:u?"cumulativeTokenCountTotal":"tokenCountTotal",cell:({row:I,getValue:A})=>{if(A()===null)return"--";const G=I.original,fn=u?G.cumulativeTokenCountTotal:G.tokenCountTotal,Un=u?G.cumulativeTokenCountPrompt:G.tokenCountPrompt,Ha=u?G.cumulativeTokenCountCompletion:G.tokenCountCompletion;return e(oa,{tokenCountTotal:fn||0,tokenCountPrompt:Un||0,tokenCountCompletion:Ha||0})}}];m.useEffect(()=>{if(i.current===!0){i.current=!1;return}t&&m.startTransition(()=>{const I=d[0];T({sort:I?ou(I):su,after:null,first:sr,filterCondition:p,rootSpansOnly:u},{fetchPolicy:"store-and-network"})})},[d,T,p,a,t,u]);const Q=m.useCallback(I=>{if(I){const{scrollHeight:A,scrollTop:B,clientHeight:G}=I;A-B-G<300&&!K&&S&&b(sr)}},[S,K,b]),V=je(I=>I.setColumnSizing),$=je(I=>I.columnSizing),N=Le({columns:R,data:P,state:{sorting:d,columnVisibility:y,rowSelection:r,columnSizing:$},defaultColumn:US,columnResizeMode:"onChange",manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:o,onSortingChange:c,onColumnSizingChange:V,getCoreRowModel:we(),getSortedRowModel:Pn()}),le=N.getRowModel().rows,re=N.getSelectedRowModel().rows,ke=re.map(I=>({id:I.original.id,traceId:I.original.trace.id})),Ln=m.useCallback(()=>{o({})},[o]),Bn=le.length===0,ga=N.getAllColumns().filter(I=>I.columns.length===0),{columnSizingInfo:ya,columnSizing:j}=N.getState(),ee=N.getFlatHeaders,te=ga.length,Ie=pe.useMemo(()=>{const I=ee(),A={};for(let B=0;B<I.length;B++){const G=I[B];A[`--header-${G.id}-size`]=G.getSize(),A[`--col-${G.column.id}-size`]=G.column.getSize()}return A},[ee,ya,j,te]);return s("div",{css:hi,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(eu,{onValidCondition:f}),s(Jl,{"aria-label":"Toggle between root and all spans",selectionMode:"single",selectedKeys:[u?"root":"all"],onSelectionChange:I=>{if(I.size===0)return;const A=I.keys().next().value;if(HS(A))g(A==="root");else throw new Error(`Unknown root span filter selection: ${A}`)},children:[e(Xn,{"aria-label":"root spans",id:"root",children:"Root Spans"}),e(Xn,{"aria-label":"all spans",id:"all",children:"All"})]}),e(Jc,{columns:ga,query:k}),e(MS,{})]})}),e("div",{css:F`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:I=>Q(I.target),ref:l,children:s("table",{css:sa,style:{...Ie,width:N.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:N.getHeaderGroups().map(I=>e("tr",{children:I.headers.map(A=>e("th",{style:{width:`calc(var(--header-${A.id}-size) * 1px)`},children:A.isPlaceholder?null:s(U,{children:[s("div",{className:A.column.getCanSort()?"cursor-pointer":"",onClick:A.column.getToggleSortingHandler(),style:{left:A.getStart(),width:A.getSize()},children:[Z(A.column.columnDef.header,A.getContext()),A.column.getIsSorted()?e(L,{className:"sort-icon",svg:A.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]}),e("div",{onMouseDown:A.getResizeHandler(),onTouchStart:A.getResizeHandler(),className:`resizer ${A.column.getIsResizing()?"isResizing":""}`})]})},A.id))},I.id))}),Bn?e(Gc,{projectName:k.name}):ya.isResizingColumn?e(GS,{table:N}):e(du,{table:N})]})}),re.length?e(ru,{selectedSpans:ke,onClearSelection:Ln}):null]})}function JS({queryReference:n}){const a=x.usePreloadedQuery(io,n);return e(WS,{project:a.project})}const T2=()=>{const{spansQueryReference:n}=el();return n?s(bi,{children:[e(ki,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(JS,{queryReference:n})})}),e(m.Suspense,{children:e(Ke,{})})]}):null},cu=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:30,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},p={kind:"Variable",name:"first",variableName:"first"},f={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[d,c,p,{kind:"Literal",name:"rootSpansOnly",value:!0},f,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},D=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],w={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:D,storageKey:null},P={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:D,storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},R={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[g,y,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},Q={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,f],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[y,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,b,y,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},S,K,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},T,w,P,_,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[g,z,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},R,Q,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,b,y,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},S,K,T,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},w,P,_,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[g,z],storageKey:null},R,Q],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:k,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"d0a1b8418330452126093b027f027f43",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              cumulativeTokenCountPrompt: tokenCountPrompt
              cumulativeTokenCountCompletion: tokenCountCompletion
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
              }
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();cu.hash="946e6d9bfbf43ac9def8bfcc2ff30661";const uu=function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},d=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],c={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:d,storageKey:null},p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:d,storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},g={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},y={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:cu,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},i,r,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},o,c,p,f,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,u,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null}],storageKey:null},g,y,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,a,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},i,r,o,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},c,p,f,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,u],storageKey:null},g,y],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();uu.hash="946e6d9bfbf43ac9def8bfcc2ff30661";const or=ti,ZS=50,mu=({table:n})=>{const a=ue();return e("tbody",{children:n.getRowModel().rows.map(t=>e("tr",{onClick:()=>a(`${t.original.trace.traceId}`),"data-is-additional-row":t.original.__additionalRow,css:ev,children:t.getVisibleCells().map(l=>e("td",{style:{height:1,width:`calc(var(--col-${l.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${l.column.id}-size) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Z(l.column.columnDef.cell,l.getContext())},l.id))},t.id))})},XS=pe.memo(mu,(n,a)=>n.table.options.data===a.table.options.data),YS=({row:n})=>n.original.__additionalRow?null:e(Uc,{metadata:n.original.metadata}),ev=F`
  &[data-is-additional-row="true"] {
    box-shadow: inset 0 -10px 20px var(--ac-global-color-grey-100);
  }
`;function pu(n){const{children:a}=n,t=[];for(const l of a){const i={...l.span,children:pu({children:l.children})};t.push(i)}return t}function nv(n){const a=m.useRef(null),t=m.useRef(!0),[l,i]=m.useState({}),[r,o]=m.useState([]),[d,c]=m.useState(""),p=!!br("/projects/:projectId/traces"),{fetchKey:f}=Pa(),{data:u,loadNext:g,hasNext:y,isLoadingNext:k,refetch:b}=x.usePaginationFragment(uu,n.project),S=je(I=>I.annotationColumnVisibility),K=m.useMemo(()=>Object.keys(S).filter(I=>S[I]),[S]),T=m.useMemo(()=>u.rootSpans.edges.map(({rootSpan:I})=>{const A=jg([I,...I.descendants.edges.map(({node:fn})=>fn)]),[B]=pu({children:A}),G=I.trace.numSpans-ZS-1;return G>0&&(B.children=[...B.children,{...B,__additionalRow:!0,name:`+ ${G} more span${G>1?"s":""}`,id:`additional-${B.id}`,input:{value:""},output:{value:""},metadata:null,spanAnnotations:[],documentRetrievalMetrics:[],children:[]}]),B}),[u]),D=m.useMemo(()=>K.map(I=>({header:I,columns:[{header:"label",accessorKey:`${ct}${En}label${En}${I}`,cell:({row:A})=>{const G=A.original.spanAnnotations.find(fn=>fn.name===I);return G?G.label:null}},{header:"score",accessorKey:`${ct}${En}score${En}${I}`,cell:({row:A})=>{const B=A.original.spanAnnotations.find(G=>G.name===I);return B?B.score:null}}]})),[K]),w=m.useMemo(()=>[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Aa,{children:[e(oe,{level:3,weight:"heavy",children:"Feedback"}),e(ia,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"feedback",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:I})=>{if(I.original.__additionalRow)return null;const A=I.original.spanAnnotations.length===0&&I.original.documentRetrievalMetrics.length===0;return s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[I.original.spanAnnotations.map(B=>e(za,{annotation:B,layout:"horizontal",width:"500px",extra:e(Hc,{annotation:B}),children:e(zn,{annotation:B,annotationDisplayPreference:"label"})},B.name)),I.original.documentRetrievalMetrics.map(B=>s(m.Fragment,{children:[e(an,{name:B.evaluationName,metric:"ndcg",score:B.ndcg},"ndcg"),e(an,{name:B.evaluationName,metric:"precision",score:B.precision},"precision"),e(an,{name:B.evaluationName,metric:"hit",score:B.hit},"hit")]},"doc-evals")),A?"--":null]})}},...D],[D]),P=m.useMemo(()=>[{id:"select",maxSize:10,header:({table:I})=>e(na,{checked:I.getIsAllRowsSelected(),indeterminate:I.getIsSomeRowsSelected(),onChange:I.getToggleAllRowsSelectedHandler()}),cell:({row:I})=>I.original.__additionalRow?null:e(na,{checked:I.getIsSelected(),disabled:!I.getCanSelect(),indeterminate:I.getIsSomeSelected(),onChange:I.getToggleSelectedHandler()})},{header:"status",accessorKey:"statusCode",maxSize:30,enableSorting:!1,cell:({getValue:I,row:A})=>{if(A.original.__additionalRow)return null;const B=I();return e(jt,{statusCode:B})}},{header:({table:I})=>s(h,{gap:"size-50",direction:"row",alignItems:"center",children:[e(Ri,{isExpanded:I.getIsAllRowsExpanded(),onClick:I.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:I=>I.row.original.__additionalRow?e("div",{css:F`
                  // Since rows are flattened by default,
                  // we can use the row.depth property
                  // and paddingLeft to visually indicate the depth
                  // of the row
                  padding-left: ${I.row.depth*2}rem;
                `,children:e(L,{svg:e(qg,{})})}):e("div",{css:F`
                // Since rows are flattened by default,
                // we can use the row.depth property
                // and paddingLeft to visually indicate the depth
                // of the row
                padding-left: ${I.row.depth*2}rem;
              `,children:s(h,{gap:"size-50",children:[I.row.getCanExpand()?e(Ri,{isExpanded:I.row.getIsExpanded(),onClick:I.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(jl,{spanKind:I.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:I,row:A})=>{const{traceId:B}=A.original.trace,G=A.original.isAdditionalSpansRow?null:A.original.id;return e(Ze,{to:`${B}${G?`?selectedSpanNodeId=${G}`:""}`,children:I()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:Ee},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:Ee},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:YS},...w,{header:"start time",accessorKey:"startTime",cell:I=>I.row.original.__additionalRow?null:e(Re,{...I})},{header:"latency",accessorKey:"latencyMs",cell:({getValue:I,row:A})=>{const B=I();return B===null||typeof B!="number"||A.original.__additionalRow?null:e(Me,{latencyMs:B})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:I,getValue:A})=>{if(I.original.__additionalRow)return null;const B=A();return B===null?"--":e(oa,{tokenCountTotal:B,tokenCountPrompt:I.original.cumulativeTokenCountPrompt||0,tokenCountCompletion:I.original.cumulativeTokenCountCompletion||0})}}],[w]);m.useEffect(()=>{if(t.current===!0){t.current=!1;return}if(p){const I=r[0];m.startTransition(()=>{b({sort:I?ou(I):su,after:null,first:or,filterCondition:d},{fetchPolicy:"store-and-network"})})}},[r,b,d,f,p]);const _=m.useCallback(I=>{if(I){const{scrollHeight:A,scrollTop:B,clientHeight:G}=I;A-B-G<300&&!k&&y&&g(or)}},[y,k,g]),[z,R]=m.useState({}),Q=je(I=>I.columnVisibility),V=je(I=>I.setColumnSizing),$=je(I=>I.columnSizing),N=Le({columns:P,data:T,onExpandedChange:R,manualSorting:!0,getSubRows:I=>I.children,state:{sorting:r,expanded:z,columnVisibility:Q,rowSelection:l,columnSizing:$},columnResizeMode:"onChange",onRowSelectionChange:i,enableSubRowSelection:!1,onSortingChange:o,onColumnSizingChange:V,getCoreRowModel:we(),getSortedRowModel:Pn(),getExpandedRowModel:kr(),getRowId:I=>I.id}),le=N.getRowModel().rows,re=N.getSelectedRowModel().flatRows,ke=re.map(I=>({id:I.original.id,traceId:I.original.trace.id})),Ln=m.useCallback(()=>{i({})},[i]),Bn=le.length===0,ga=N.getAllColumns().filter(I=>I.columns.length===0),{columnSizingInfo:ya,columnSizing:j}=N.getState(),ee=N.getFlatHeaders,te=ga.length,Ie=pe.useMemo(()=>{const I=ee(),A={};for(let B=0;B<I.length;B++){const G=I[B];A[`--header-${G.id}-size`]=G.getSize(),A[`--col-${G.column.id}-size`]=G.column.getSize()}return A},[ee,ya,j,te]);return s("div",{css:hi,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(eu,{onValidCondition:c}),e(Jc,{columns:ga,query:u})]})}),e("div",{css:F`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:I=>_(I.target),ref:a,children:s("table",{css:sa,style:{...Ie,width:N.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:N.getHeaderGroups().map(I=>e("tr",{children:I.headers.map(A=>e("th",{style:{width:`calc(var(--header-${A.id}-size) * 1px)`},children:A.isPlaceholder?null:s(U,{children:[s("div",{"data-sortable":A.column.getCanSort(),className:A.column.getCanSort()?"cursor-pointer":"",onClick:A.column.getToggleSortingHandler(),style:{left:A.getStart(),width:A.getSize()},children:[Z(A.column.columnDef.header,A.getContext()),A.column.getIsSorted()?e(L,{className:"sort-icon",svg:A.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]}),e("div",{onMouseDown:A.getResizeHandler(),onTouchStart:A.getResizeHandler(),className:`resizer ${A.column.getIsResizing()?"isResizing":""}`})]})},A.id))},I.id))}),Bn?e(Gc,{projectName:u.name}):ya.isResizingColumn?e(XS,{table:N}):e(mu,{table:N})]})}),re.length?e(ru,{selectedSpans:ke,onClearSelection:Ln}):null]})}const av=({tracesQueryReference:n})=>{const a=x.usePreloadedQuery(lo,n);return e(nv,{project:a.project})},P2=()=>{const{tracesQueryReference:n}=el();return n?s(bi,{children:[e(ki,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(av,{tracesQueryReference:n})})}),e(m.Suspense,{children:e(Ke,{})})]}):null},gu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"04c84b5bc2a01477851d347af75dcc11",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}}();gu.hash="3d31e323c06df38ec2eaa6f3adb55e79";async function I2(n){const{projectId:a}=n.params;return await x.fetchQuery(Fe,gu,{id:a}).toPromise()}function x2(){const n=Nm(),a=m.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(tv,{}):e(lv,{error:n}),[n]);return e("main",{css:F`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:F`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function tv(){return s(U,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(Rt,{graphicKey:"not found"}),e("h1",{children:"Server disconnected"})]}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function lv({error:n}){return s(U,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(Rt,{graphicKey:"error"}),e("h1",{children:"Something went wrong"})]}),e("p",{children:"We strive to do our very best but  bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:F`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:s("span",{css:F`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:[" the",e(ln,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),s("div",{css:F`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(ln,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(M,{variant:"primary",size:"S",onPress:()=>{window.location.href="/"},children:"Return Home"})]}),s("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:F`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}const yu=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}}();yu.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const iv=yu;function D2(){const n=x.useLazyLoadQuery(iv,{}),{model:{primaryInferences:a,referenceInferences:t,corpusInferences:l}}=n;return e(Ug,{primaryInferences:a,referenceInferences:t??null,corpusInferences:l??null,children:e(Bg,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(Ke,{})})})}function _2(){return e(Hg,{children:e(Ke,{})})}const fu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t],i={kind:"InlineFragment",selections:[{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"0fa41a7d0406cd916f93bbafcb5fe94f",id:null,metadata:{},name:"ProjectsPageProjectMetricsQuery",operationKind:"query",text:`query ProjectsPageProjectMetricsQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      traceCount(timeRange: $timeRange)
      latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
      tokenCountTotal(timeRange: $timeRange)
    }
    __isNode: __typename
    id
  }
}
`}}}();fu.hash="abe4527bcaa911eb401e05797a984c38";const hu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"41a1a825d696f9bc4ab50131829ff347",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $first: Int = 50
) {
  ...ProjectsPageProjectsFragment_2HEEH6
}

fragment ProjectsPageProjectsFragment_2HEEH6 on Query {
  projects(first: $first, after: $after) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();hu.hash="d16c129ec8d3d2eb1509dc95e45334fd";const ku=function(){var n=["projects"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:hu}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();ku.hash="d16c129ec8d3d2eb1509dc95e45334fd";const bu=function(){var n=[{kind:"Literal",name:"first",value:50}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:n,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"},{alias:null,args:n,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"6684d1c11414c8f56561b6a65189bf77",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery {
  ...ProjectsPageProjectsFragment
}

fragment ProjectsPageProjectsFragment on Query {
  projects(first: 50) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();bu.hash="9091622e2fc47fff9434aeb3407882d4";const rv="https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-tracing";function sv(){const[n,a]=m.useState(null);return s("div",{children:[e(M,{leadingVisual:e(L,{svg:e(Ir,{})}),size:"S",onPress:()=>{a(e(ov,{}))},children:"New Project"}),e(ae,{isDismissable:!0,type:"slideOver",onDismiss:()=>a(null),children:n})]})}function ov(){const[n,a]=m.useState("Python");return e(X,{title:"Create a New Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-200",children:e(Ot,{language:n,onChange:a})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(ln,{href:rv,children:"documentation"})," ","for a complete guide."]})}),n==="Python"?e(ts,{}):e(ls,{})]})})}const Su=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();Su.hash="c43eec4d6b882468c611dd9ebf3b095e";const vu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"8b00ab3aaef4c5fb3de24f7295d38499",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: GlobalID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}}();vu.hash="3bf82e90b3f2d3485b4efb954e30b2cf";const Cu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();Cu.hash="212501fe2d6367ec1503bd7a00c1730f";function dv(n){const{projectId:a}=n,t=p0(),l=m.useRef(null),[i,r]=x.useMutation(Cu),{control:o,handleSubmit:d,setError:c,formState:{isValid:p}}=Oe({defaultValues:{endDate:$m(new Date(Date.now()-Gg).toISOString())}}),f=m.useCallback(u=>{const g=u.endDate.toDate(xl());if(!Om(g))return c("endDate",{message:"Date is not in a valid format"});i({variables:{input:{id:a,endTime:new Date(g).toISOString()}},onCompleted:()=>{n.onComplete()},onError:y=>{alert("Failed to clear project traces: "+y)}})},[i,a,n,c]);return s("form",{onSubmit:d(f),ref:l,children:[s(C,{padding:"size-200",children:[e(v,{color:"danger",children:" This will remove all data before the following date. This cannot be undone."}),e(W,{name:"endDate",control:o,rules:{required:"field is required"},render:({field:{name:u,onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Wg,{isInvalid:b,onChange:g,name:u,onBlur:y,value:k,granularity:"second",hideTimeZone:!0,css:F`
                .react-aria-DateInput {
                  width: 100%;
                }
              `,children:[e(J,{children:"End Date"}),e(Qm,{children:K=>e(jm,{segment:K})}),S?e(xe,{children:S.message}):e(v,{slot:"description",children:`The date up to which you want to remove data. The format is ${t}.`})]})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",variant:"danger",isDisabled:!p||r,size:"S",leadingVisual:r?e(L,{svg:e(We,{})}):void 0,onPress:()=>{var u;(u=l.current)==null||u.requestSubmit()},children:r?"Removing...":"Remove Data"})})})]})}function cv({projectId:n,projectName:a,onProjectDelete:t,onProjectClear:l,onProjectRemoveData:i}){const[r,o]=m.useState(null),d=a!=="default",[c]=x.useMutation(vu),[p]=x.useMutation(Su),f=m.useCallback(()=>{m.startTransition(()=>{c({variables:{projectId:n}}),t()})},[c,n,t]),u=m.useCallback(()=>{m.startTransition(()=>{p({variables:{input:{id:n}},onCompleted:()=>{l()},onError:b=>{alert("Failed to clear project: "+b)}})})},[p,n,l]),g=m.useCallback(()=>{o(s(X,{size:"S",title:"Delete Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{f(),o(null)},children:"Delete Project"})})})]}))},[f,a]),y=m.useCallback(()=>{o(s(X,{size:"S",title:"Clear Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{u(),o(null)},children:"Clear"})})})]}))},[u,a]),k=m.useCallback(()=>{o(e(X,{size:"S",title:"Remove Data",children:e(dv,{projectId:n,onComplete:()=>{i(),o(null)}})}))},[i,n]);return s("div",{onClick:b=>{b.preventDefault(),b.stopPropagation()},children:[s(xn,{buttonVariant:"quiet",buttonSize:"compact",align:"end",onAction:b=>{switch(b){case"deleteProject":return g();case"clearProject":return y();case"removeProjectData":return k()}},disabledKeys:d?[]:["deleteProject"],children:[e(ie,{textValue:"Clear All Traces",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Tr,{})}),e(v,{children:"Clear All Data"})]})},"clearProject"),e(ie,{textValue:"Remove Data",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Zt,{})}),e(v,{children:"Remove Data"})]})},"removeProjectData"),d?e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ye,{})}),e(v,{children:"Delete"})]})},"deleteProject"):null]}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>o(null),children:r})]})}const uv=50;function L2(){const{timeRange:n}=Jt(),a=x.useLazyLoadQuery(bu,{});return e(mv,{timeRange:n,query:a})}function mv({timeRange:n,query:a}){const[t,l]=Jm(),i=m.useMemo(()=>{var S,K;return{start:(S=n==null?void 0:n.start)==null?void 0:S.toISOString(),end:(K=n==null?void 0:n.end)==null?void 0:K.toISOString()}},[n]),{data:r,loadNext:o,hasNext:d,isLoadingNext:c,refetch:p}=x.usePaginationFragment(ku,a),f=r==null?void 0:r.projects.edges.map(S=>S.project),u=m.useRef(null),g=m.useCallback(S=>{if(S){const{scrollHeight:K,scrollTop:T,clientHeight:D}=S;K-T-D<300&&!c&&d&&o(uv)}},[d,c,o]),y=m.useCallback(S=>{m.startTransition(()=>{p({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Deleted",message:`Project ${S} has been deleted.`})})},[t,p]),k=m.useCallback(S=>{m.startTransition(()=>{p({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Cleared",message:`Project ${S} has been cleared of traces.`})})},[t,p]),b=m.useCallback(S=>{m.startTransition(()=>{p({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Data Removed",message:`Old data from project ${S} have been removed.`})})},[t,p]);return s("div",{css:F`
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
        padding-bottom: var(--ac-global-dimension-size-750);
      `,onScroll:S=>g(S.target),ref:u,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",children:[e(sv,{}),e(ns,{})]})}),e(C,{padding:"size-200",width:"100%",children:e("ul",{css:F`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-size-200);
            flex-wrap: wrap;
          `,children:f==null?void 0:f.map(S=>e("li",{children:e(Ze,{to:`/projects/${S.id}`,css:F`
                  text-decoration: none;
                `,children:e(gv,{project:S,timeRange:i,onProjectDelete:()=>y(S.name),onProjectClear:()=>k(S.name),onProjectRemoveData:()=>b(S.name)})})},S.id))})}),l]})}function pv({gradientStartColor:n,gradientEndColor:a}){return e("div",{css:F`
        border-radius: 50%;
        width: 32px;
        height: 32px;
        background: linear-gradient(
          136.27deg,
          ${n} 14.03%,
          ${a} 84.38%
        );
        flex-shrink: 0;
      `})}function gv({project:n,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l,timeRange:i}){const{gradientStartColor:r,gradientEndColor:o,endTime:d}=n,c=m.useMemo(()=>d?`Last updated  ${qm(new Date(d),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[d]);return s("div",{css:F`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-400);
        background-color: var(--ac-global-color-grey-100);
        box-shadow:
          0 0 1px 0px var(--ac-global-color-grey-400) inset,
          0 0 1px 0px var(--ac-global-color-grey-400);
        border-radius: var(--ac-global-rounding-medium);
        width: var(--ac-global-dimension-size-3600);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: var(--ac-global-dimension-size-200);
      `,children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(pv,{gradientStartColor:r,gradientEndColor:o}),s(h,{direction:"column",minWidth:0,children:[e(oe,{level:2,css:F`
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
              `,children:n.name}),e(v,{color:"text-700",size:"XS",fontStyle:"italic",children:c})]})]}),e(cv,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l})]}),e(hv,{projectId:n.id,timeRange:i})]})}const yv=fu;function fv(){return s(h,{direction:"row",justifyContent:"space-between",minHeight:"size-600",children:[s(h,{direction:"column",flex:"none",gap:"size-100",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(ul,{width:60,height:20,animation:"wave"})]}),s(h,{direction:"column",flex:"none",gap:"size-100",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(ul,{width:60,height:20,animation:"wave"})]}),s(h,{direction:"column",flex:"none",gap:"size-100",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),e(ul,{width:60,height:20,animation:"wave"})]})]})}function hv({projectId:n,timeRange:a}){const t=x.useRelayEnvironment(),l=m.useRef(null),[i,r]=m.useState(null),o=m.useCallback(()=>(r(null),x.fetchQuery(t,yv,{id:n,timeRange:a}).subscribe({next:p=>{r(p)},error:()=>{r(null)}})),[n,a,t]);return m.useEffect(()=>(l.current=o(),()=>{var d;(d=l.current)==null||d.unsubscribe(),l.current=null}),[o]),i==null?e(fv,{}):e(kv,{project:i})}function kv({project:n}){const{project:{traceCount:a,tokenCountTotal:t,latencyMsP50:l}}=n;return s(h,{direction:"row",justifyContent:"space-between",minHeight:"size-600",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:Sa(a)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(v,{size:"L",children:Sa(t)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),l!=null?e(Me,{latencyMs:l,size:"L"}):e(v,{size:"L",children:"--"})]})]})}const Fu=function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"695b221e981c4795492d79faa7d007e4",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Fu.hash="985853a7939f44c0cefdd1a91472c67e";function bv(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(t=>t.trim()):[]}function Sv(n){const{onDatasetCreated:a,onDatasetCreateError:t}=n,[l,i]=m.useState([]),{control:r,handleSubmit:o,resetField:d,formState:{isDirty:c,isValid:p}}=Oe({defaultValues:{name:"Dataset "+new Date().toISOString(),input_keys:[],output_keys:[],metadata_keys:[],description:"",metadata:{}}}),f=m.useCallback(u=>{const g=new FormData;return g.append("file",u.file[0]),g.append("name",u.name),g.append("description",u.description),g.append("metadata",JSON.stringify(u.metadata)),u.input_keys.forEach(y=>{g.append("input_keys[]",y)}),u.output_keys.forEach(y=>{g.append("output_keys[]",y)}),u.metadata_keys.forEach(y=>{g.append("metadata_keys[]",y)}),fetch(un("/v1/datasets/upload?sync=true"),{method:"POST",body:g}).then(y=>{if(!y.ok)throw t(new Error(y.statusText||"Failed to create dataset"));return y.json()}).then(y=>{a({name:u.name,id:y.data.dataset_id})})},[t,a]);return s(tn,{onSubmit:o(f),children:[s("div",{css:F`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(W,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{isInvalid:k,onChange:u,onBlur:g,value:y.toString(),children:[e(J,{children:"Dataset Name"}),e(se,{placeholder:"e.x. Golden Dataset"}),b!=null&&b.message?e(xe,{children:b.message}):e(v,{slot:"description",children:"The name of the dataset"})]})}),e(W,{name:"description",control:r,render:({field:{onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{isInvalid:k,onChange:u,onBlur:g,value:y.toString(),children:[e(J,{children:"Description"}),e(Ca,{placeholder:"e.x. A dataset for structured data extraction"}),b!=null&&b.message?e(xe,{children:b.message}):e(v,{slot:"description",children:"The description of the dataset"})]})}),e(W,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:u,onChange:g,...y},fieldState:{invalid:k,error:b}})=>e(ra,{label:"CSV file",validationState:k?"invalid":"valid",errorMessage:b==null?void 0:b.message,children:e("input",{...y,onChange:S=>{var T;g(S.target.files),d("input_keys"),d("output_keys"),d("metadata_keys");const K=(T=S.target.files)==null?void 0:T[0];if(K){const D=new FileReader;D.onload=function(w){if(!w.target)return;const P=w.target.result,_=bv(P);i(_)},D.readAsText(K)}},type:"file",id:"file",accept:".csv"})})}),e(W,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:u,onChange:g},fieldState:{invalid:y,error:k}})=>e(bl,{label:"input keys",validationState:y?"invalid":"valid",description:"the columns to use as input",columns:l,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})}),e(W,{name:"output_keys",control:r,render:({field:{value:u,onChange:g},fieldState:{invalid:y,error:k}})=>e(bl,{label:"output keys",validationState:y?"invalid":"valid",description:"the columns to use as output",columns:l,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})}),e(W,{name:"metadata_keys",control:r,render:({field:{value:u,onChange:g},fieldState:{invalid:y,error:k}})=>e(bl,{label:"metadata keys",validationState:y?"invalid":"valid",description:"the columns to use as metadata",columns:l,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",isDisabled:!p,variant:c?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function bl(n){const{columns:a,selectedColumns:t,onChange:l,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=a.length===0,f=m.useMemo(()=>p?"No columns to select":t.length>0?`${t.join(", ")}`:"No columns selected",[t,p]);return e(ra,{label:i,isDisabled:p,validationState:r,description:o,errorMessage:d,children:e(El,{isDisabled:p,...c,menu:e(Vt,{selectionMode:"multiple",onSelectionChange:u=>{l(Array.from(u))},selectedKeys:new Set(t),children:a.map(u=>e(ie,{children:u},u))}),triggerProps:{placement:"bottom end"},children:f})})}const Ku=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"5ac1688f54e51f9bb3247c83e23d98fb",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_dWkdd
}

fragment DatasetsTable_datasets_dWkdd on Query {
  datasets(first: $first, after: $after, sort: $sort) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ku.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Tu=function(){var n=["datasets"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Ku}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Tu.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Pu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"3d32b97acd630dd7dbc9c85a632a1d49",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: GlobalID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}}();Pu.hash="7066cca7015a7e344b77862b0bdab21c";function vv({datasetId:n,datasetName:a,onDatasetDelete:t,onDatasetDeleteError:l}){const[i,r]=x.useMutation(Pu),o=m.useCallback(()=>{m.startTransition(()=>{i({variables:{datasetId:n},onCompleted:()=>{t()},onError:d=>{l(d)}})})},[i,n,t,l]);return s(X,{size:"S",title:"Delete Dataset",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{o()},isDisabled:r,leadingVisual:e(L,{svg:r?e(We,{}):e(Ye,{})}),children:"Delete Dataset"})})})]})}function Cv({datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r}){return e(X,{title:"Edit Dataset",size:"M",children:e(Jg,{datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r})})}function Fv(n){const{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:o,onDatasetEdit:d,onDatasetEditError:c}=n,[p,f]=m.useState(null),u=m.useCallback(()=>{f(e(vv,{datasetId:a,datasetName:t,onDatasetDelete:()=>{r(),f(null)},onDatasetDeleteError:o}))},[a,t,r,o]),g=m.useCallback(()=>{f(e(Cv,{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetEdited:()=>{d(),f(null)},onDatasetEditError:c}))},[l,a,i,t,d,c]);return s("div",{onClick:y=>{y.preventDefault(),y.stopPropagation()},children:[s(xn,{align:"end",buttonSize:"compact",onAction:y=>{switch(y){case"deleteDataset":u();break;case"editDataset":g();break}},children:[e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ye,{})}),e(v,{children:"Delete"})]})},"deleteDataset"),e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ol,{})}),e(v,{children:"Edit"})]})},"editDataset")]}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>f(null),children:p})]})}const dr=100;function Kv(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function Tv(n){const[a,t]=m.useState([]),l=m.useRef(null),i=ue(),r=he(),o=Pe(),{data:d,loadNext:c,hasNext:p,isLoadingNext:f,refetch:u}=x.usePaginationFragment(Tu,n.query),g=m.useMemo(()=>d.datasets.edges.map(K=>K.node),[d]),y=pe.useCallback(K=>{if(K){const{scrollHeight:T,scrollTop:D,clientHeight:w}=K;T-D-w<300&&!f&&p&&c(dr)}},[p,f,c]),k=Le({columns:[{header:"name",accessorKey:"name",cell:({row:K})=>{const D=K.original.experimentCount>0?`${K.original.id}/experiments`:`${K.original.id}/examples`;return e(Ze,{to:D,children:K.original.name})}},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:Re},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:wa},{header:"",id:"actions",enableSorting:!1,size:10,cell:({row:K})=>e(Fv,{datasetId:K.original.id,datasetName:K.original.name,datasetDescription:K.original.description,datasetMetadata:K.original.metadata,onDatasetEdit:()=>{r({title:"Dataset updated",message:`${K.original.name} has been successfully updated.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetEditError:T=>{const D=De(T);o({title:"Dataset update failed",message:(D==null?void 0:D[0])??T.message})},onDatasetDelete:()=>{r({title:"Dataset deleted",message:`${K.original.name} has been successfully deleted.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:T=>{const D=De(T);o({title:"Dataset deletion failed",message:(D==null?void 0:D[0])??T.message})}})}],data:g,state:{sorting:a},getCoreRowModel:we(),getSortedRowModel:Pn(),onSortingChange:t,manualSorting:!0});m.useEffect(()=>{const K=a[0];m.startTransition(()=>{u({sort:K?Kv(K):{col:"createdAt",dir:"desc"},after:null,first:dr},{fetchPolicy:"store-and-network"})})},[a,u]);const b=k.getRowModel().rows,S=b.length===0;return e("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:K=>y(K.target),ref:l,children:s("table",{css:sa,children:[e("thead",{children:k.getHeaderGroups().map(K=>e("tr",{children:K.headers.map(T=>{var D;return e("th",{colSpan:T.colSpan,children:T.isPlaceholder?null:s("div",{className:T.column.getCanSort()?"cursor-pointer":"",onClick:T.column.getToggleSortingHandler(),style:{textAlign:(D=T.column.columnDef.meta)==null?void 0:D.textAlign},children:[Z(T.column.columnDef.header,T.getContext()),T.column.getIsSorted()?e(L,{className:"sort-icon",svg:T.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},T.id)})},K.id))}),S?e(cn,{}):e("tbody",{children:b.map(K=>e("tr",{onClick:()=>{const D=K.original.experimentCount>0?`${K.original.id}/experiments`:`${K.original.id}/examples`;i(D)},children:K.getVisibleCells().map(T=>{var D;return e("td",{align:(D=T.column.columnDef.meta)==null?void 0:D.textAlign,children:Z(T.column.columnDef.cell,T.getContext())},T.id)})},K.id))})]})})}function w2(){return e(m.Suspense,{fallback:e(Ce,{}),children:e(Pv,{})})}function Pv(){const[n,a]=m.useState(0),t=x.useLazyLoadQuery(Fu,{},{fetchKey:n,fetchPolicy:"store-and-network"}),l=m.useCallback(()=>{a(i=>i+1)},[a]);return s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(oe,{level:1,children:"Datasets"}),e(Iv,{onDatasetCreated:l})]})}),e(Tv,{query:t})]})}function Iv({onDatasetCreated:n}){const a=ue(),t=he(),l=Pe(),[i,r]=m.useState(null),o=()=>{r(e(X,{size:"S",title:"New Dataset",children:e(is,{onDatasetCreated:c=>{t({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=De(c);l({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))},d=()=>{r(e(X,{size:"M",title:"New Dataset from CSV",children:e(Sv,{onDatasetCreated:c=>{t({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=De(c);l({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))};return s(U,{children:[s(xn,{buttonText:"Create Dataset",align:"end",icon:e(L,{svg:e(zt,{})}),onAction:c=>{switch(c){case"newDataset":o();break;case"datasetFromCSV":d();break}},children:[e(ie,{children:"New Dataset"},"newDataset"),e(ie,{children:"Dataset from CSV"},"datasetFromCSV")]}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Iu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"d7075240e4dae8871997e57616c05302",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Iu.hash="a1349b92d8b0c745f5e8039c55b048c7";const xv=n=>{const a=(t,l)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=l();t({isRefreshingLatestVersion:!0});const r=await Dv({datasetId:i.datasetId});t({latestVersion:r,isRefreshingLatestVersion:!1})}});return gr()(Bm(a))};async function Dv({datasetId:n}){var i;const a=await x.fetchQuery(Fe,Iu,{datasetId:n}).toPromise(),t=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return t&&t.length&&t[0].version||null}const xu=m.createContext(null);function _v({children:n,...a}){const[t]=m.useState(()=>xv(a));return e(xu.Provider,{value:t,children:n})}function va(n,a){const t=m.useContext(xu);if(!t)throw new Error("Missing DatasetContext.Provider in the tree");return ut(t,n,a)}const Du=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}}();Du.hash="8d99470f590cd5d28701fa6e3c0330e6";const Sl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Lv(n){const{datasetId:a,onCompleted:t}=n,[l,i]=m.useState(null),[r,o]=x.useMutation(Du),{control:d,setError:c,handleSubmit:p,formState:{isValid:f}}=Oe({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),u=m.useCallback(g=>{if(i(null),!Rn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Rn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Rn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],datasetVersionDescription:g.description}},onCompleted:()=>{t()},onError:y=>{const k=De(y);i((k==null?void 0:k[0])??y.message)}})},[r,a,c,t]);return s(X,{size:"L",title:"Add Example",children:[e("div",{css:F`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[l?e(be,{variant:"danger",children:l}):null,e(W,{control:d,name:"input",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Sl,children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"output",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Sl,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Sl,children:[b?e(be,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(Ue,{value:k,onChange:g,onBlur:y})]})}),e(W,{control:d,name:"description",render:({field:{onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Y,{value:k,onChange:g,onBlur:y,isInvalid:b,children:[e(J,{children:"Version Description"}),e(Ca,{}),S?e(xe,{children:S.message}):e(v,{slot:"description",children:"A description of the changes made. Will be displayed in the version history."})]})})]})})})}),e(C,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(M,{variant:"primary",size:"S",isDisabled:!f||o,leadingVisual:o?e(L,{svg:e(We,{})}):null,onPress:()=>p(u)(),children:o?"Adding Example...":"Add Example"})})})]})}function wv(n){const{datasetId:a,onAddExampleCompleted:t}=n,[l,i]=m.useState(null),r=m.useCallback(()=>{i(e(Lv,{datasetId:a,onCompleted:()=>{t(),i(null)}}))},[a,t]);return s(U,{children:[e(M,{leadingVisual:e(L,{svg:e(Dn,{})}),size:"S",onPress:r,"aria-label":"Add Dataset Example",children:"Add Example"}),e(ae,{isDismissable:!0,onDismiss:()=>{i(null)},children:l})]})}function Ev(){const n=va(i=>i.datasetId),a=va(i=>i.latestVersion);let t=`${Fl}/v1/datasets/${n}/examples`;a&&(t+=`?version-id=${a.id}`);const l=m.useMemo(()=>`import phoenix as px
client = px.Client()
# Get the current dataset version
dataset = client.get_dataset(id="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return e("div",{css:F`
        button.ac-dropdown-button {
          min-width: 80px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:s(Va,{placement:"bottom right",children:[e(Sr,{addonBefore:e(L,{svg:e($l,{})}),children:"Code"}),e(Ll,{children:s("section",{css:F`
              width: 500px;
              .ac-field {
                flex: 1 1 auto;
              }
            `,children:[e(C,{padding:"size-200",children:s(tn,{children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[s(Y,{isReadOnly:!0,value:n,children:[e(J,{children:"Dataset ID"}),e(se,{})]}),e(ce,{text:n,size:"M"})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(Y,{isReadOnly:!0,value:(a==null?void 0:a.id)||"No Versions",isInvalid:!a,children:[e(J,{children:"Version ID"}),e(se,{})]}),e(ce,{text:(a==null?void 0:a.id)||"No Versions",isDisabled:!a,size:"M"})]})]})}),s(Ge,{children:[s(He,{children:[e(ne,{id:"python",children:"Python"}),e(ne,{id:"rest",children:"REST"})]}),e(ba,{id:"python",children:e(C,{margin:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"small",children:e(hn,{value:l})})}),e(ba,{id:"rest",children:e(C,{padding:"size-200",children:e(tn,{children:s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(Y,{isReadOnly:!0,value:t,children:[e(J,{children:"URL"}),e(se,{})]}),e(ce,{text:t,size:"M"})]})})})})]})]})})]})})}const _u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"df94b4e72c0187fd0fd1c8416af19354",id:null,metadata:{},name:"DatasetHistoryDialogQuery",operationKind:"query",text:`query DatasetHistoryDialogQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();_u.hash="7215c18bda690418c5ecbcb3131a288e";const Lu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"e8e3a05b4e86c8eaeea98172405fdc7e",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Lu.hash="37e453bc58759a1e89bc5862c460de6b";const wu=function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Lu,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();wu.hash="37e453bc58759a1e89bc5862c460de6b";const Rv=100;function Mv(n){const a=m.useRef(null),{data:t,loadNext:l,hasNext:i,isLoadingNext:r}=x.usePaginationFragment(wu,n.dataset),o=m.useMemo(()=>t.versions.edges.map(u=>u.node),[t]),d=pe.useCallback(u=>{if(u){const{scrollHeight:g,scrollTop:y,clientHeight:k}=u;g-y-k<300&&!r&&i&&l(Rv)}},[i,r,l]),c=Le({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:Re}],data:o,getCoreRowModel:we(),getSortedRowModel:Pn()}),p=c.getRowModel().rows,f=p.length===0;return e("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:u=>d(u.target),ref:a,children:s("table",{css:sn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},g.id))},u.id))}),f?e(cn,{}):e("tbody",{children:p.map(u=>e("tr",{children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))})]})})}function Vv(n){const{datasetId:a}=n,t=x.useLazyLoadQuery(_u,{datasetId:a});return e(X,{size:"L",title:"Dataset History",children:e("div",{css:F`
          height: 500px;
        `,children:e(Mv,{dataset:t.dataset})})})}function Av(n){const{datasetId:a}=n,[t,l]=m.useState(null);return s(U,{children:[s(Se,{children:[e(M,{leadingVisual:e(L,{svg:e(Zg,{})}),"aria-label":"Version History",onPress:()=>{l(e(Vv,{datasetId:a}))}}),e(Ne,{children:"Dataset Version History"})]}),e(m.Suspense,{fallback:null,children:e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>{l(null)},children:t})})]})}const zv=`pip install arize-phoenix>=${window.Config.platformVersion}`;function Nv({isAuthEnabled:n}){let a=`import os
# Set the phoenix collector endpoint. Commonly http://localhost:6006 
os.environ["PHOENIX_COLLECTOR_ENDPOINT"] = "<your-phoenix-url>"`;return n&&(a+=`
# Configure access
os.environ["PHOENIX_API_KEY"] = "<your-api-key>"`),a}const $v=`from phoenix.experiments.types import Example
# Define your task
# Typically should be an LLM call or a call to your application
def my_task(example: Example) -> str:
    # This is just an example of how to return a JSON serializable value
    return f"Hello {example.input['person']}"`,Ov=`# Define an evaluator. This just an example.
def exact_match(input, output) -> float:
    return 1.0 if output is f"Hello {input}" else 0.0

# Store the evaluators for later use
evaluators = [exact_match]`,Qv=`# Run an experiment
from phoenix.experiments import run_experiment

experiment = run_experiment(dataset, my_task, evaluators=evaluators)`;function Eu(){const[n,a]=m.useState(null),t=m.useCallback(()=>{a(e(X,{title:"Run Experiment",size:"XL",children:e(jv,{})}))},[]);return s(U,{children:[e(M,{size:"S",leadingVisual:e(L,{svg:e(zr,{})}),onPress:t,children:"Run Experiment"}),e(ae,{isDismissable:!0,type:"slideOver",onDismiss:()=>{a(null)},children:n})]})}function jv(){const n=va(i=>i.datasetName),a=va(i=>i.latestVersion),t=window.Config.authenticationEnabled,l=m.useMemo(()=>`import phoenix as px
# Initialize a phoenix client
client = px.Client()
# Get the current dataset version. You can omit the version for the latest.
dataset = client.get_dataset(name="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(v,{children:"Install Phoenix"})}),e(Xe,{children:e(hn,{value:zv})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Point to a running instance of Phoenix"})}),e(Xe,{children:e(hn,{value:Nv({isAuthEnabled:t})})}),e(Xg,{children:e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:e(Pr,{fallback:s(v,{children:["Your personal API keys can be created and managed on your"," ",e(ln,{href:"/profile",children:"Profile"})]}),children:s(v,{children:["System API keys can be created and managed in"," ",e(ln,{href:"/settings/general",children:"Settings"})]})})})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Pull down this dataset"})}),e(Xe,{children:e(hn,{value:l})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define your task"})}),e(Xe,{children:e(hn,{value:$v})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define evaluators"})}),e(Xe,{children:e(hn,{value:Ov})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Run an experiment"})}),e(Xe,{children:e(hn,{value:Qv})})]})}function E2(){const n=qe();Je(n);const a=m.useMemo(()=>{const t=n.dataset.latestVersions;return t!=null&&t.edges&&t.edges.length?t.edges[0].version:null},[n]);return e(_v,{datasetId:n.dataset.id,datasetName:n.dataset.name,latestVersion:a,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Bv,{dataset:n.dataset})})})}const qv=F`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function Bv({dataset:n}){const a=n.id,t=va(c=>c.refreshLatestVersion),l=he(),i=ue(),r=m.useCallback(c=>{c===0?i(`/datasets/${a}/experiments`):c===1&&i(`/datasets/${a}/examples`)},[i,a]),d=mt().pathname.includes("examples")?1:0;return s("main",{css:qv,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(h,{direction:"column",justifyContent:"space-between",children:e(h,{direction:"row",gap:"size-200",alignItems:"center",children:s(h,{direction:"column",children:[e(v,{elementType:"h1",size:"L",weight:"heavy",children:n.name}),e(v,{color:"text-700",children:n.description||"--"})]})})}),s(h,{direction:"row",gap:"size-100",children:[s(xn,{align:"end",icon:e(L,{svg:e(Ht,{})}),onAction:c=>{switch(c){case"csv":window.open(un(`/v1/datasets/${n.id}/csv`),"_blank");break;case"openai-ft":window.open(un(`/v1/datasets/${n.id}/jsonl/openai_ft`),"_blank");break;case"openai-evals":window.open(un(`/v1/datasets/${n.id}/jsonl/openai_evals`),"_blank");break}},children:[e(ie,{children:"Download CSV"},"csv"),e(ie,{children:"Download OpenAI Fine-Tuning JSONL"},"openai-ft"),e(ie,{children:"Download OpenAI Evals JSONL"},"openai-evals")]}),e(Av,{datasetId:n.id}),e(Ev,{}),e(Eu,{}),e(M,{leadingVisual:e(L,{svg:e(Ka,{})}),onPress:()=>{i(`/playground?datasetId=${n.id}`)},children:"Playground"}),e(wv,{datasetId:n.id,onAddExampleCompleted:()=>{l({title:"Example added",message:"The example has been added successfully and the version has been updated."}),t()}})]})]})}),s(Ge,{defaultSelectedKey:d===0?"experiments":"examples",onSelectionChange:c=>{switch(c){case"experiments":r(0);break;case"examples":r(1);break}},children:[s(He,{children:[s(ne,{id:"experiments",children:["Experiments ",e(yn,{children:n.experimentCount})]}),s(ne,{id:"examples",children:["Examples ",e(yn,{children:n.exampleCount})]})]}),e(de,{id:"experiments",children:e(m.Suspense,{children:e(Ke,{})})}),e(de,{id:"examples",children:e(m.Suspense,{children:e(Ke,{})})})]})]})}const Ru=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,i],storageKey:null}]},params:{cacheID:"5b221627cf7e63f41fbec41027cc0951",id:null,metadata:{},name:"datasetLoaderQuery",operationKind:"query",text:`query datasetLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Ru.hash="469da2debdebd608c88a6ef83c2540aa";async function R2(n){const{datasetId:a}=n.params;return await x.fetchQuery(Fe,Ru,{id:a}).toPromise()}function M2(){const{exampleId:n,datasetId:a}=Be(),t=ue();return e(mi,{exampleId:n,onDismiss:()=>{t(`/datasets/${a}/examples`)}})}const Mu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e303fa9a3c09ccd6a3dc1f3dbb2afb3",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Mu.hash="6406bbf43a2e850b384ba9573d8e69de";async function V2(n){const{datasetId:a}=n.params;return await x.fetchQuery(Fe,Mu,{id:a}).toPromise()}const Vu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"ca59c018695d41ca01b5f9d453386886",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment ExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Vu.hash="e04e697cdb44ab2dd115f4562211f6a4";const Au=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Vu,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Au.hash="e04e697cdb44ab2dd115f4562211f6a4";const zu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();zu.hash="455bf9e5dc4b9cc655095dc829ef7e12";function Uv(n){const a=va(y=>y.refreshLatestVersion),{selectedExamples:t,onExamplesDeleted:l,onClearSelection:i}=n,[r,o]=m.useState(null),d=he(),c=Pe(),[p,f]=x.useMutation(zu),u=t.length!==1,g=m.useCallback(()=>{p({variables:{input:{exampleIds:t.map(y=>y.id)}},onCompleted:()=>{d({title:"Examples Deleted",message:`${t.length} example${u?"s":""} have been deleted.`}),l(),i(),a()},onError:y=>{const k=De(y);c({title:"An error occurred",message:`Failed to delete examples: ${(k==null?void 0:k[0])??y.message}`})}})},[p,t,d,u,l,i,a,c]);return s("div",{css:F`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{children:`${t.length} example${u?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:i,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(L,{svg:f?e(We,{}):e(Ye,{})}),isDisabled:f,onPress:g,children:f?"Deleting...":"Delete Example"+(u?"s":"")})]})]})}),e(ae,{onDismiss:()=>{o(null)},children:r})]})}const Hv=100;function Gv({dataset:n}){const a=va(w=>w.latestVersion),t=m.useRef(null),[l,i]=pe.useState({}),{data:r,loadNext:o,hasNext:d,isLoadingNext:c,refetch:p}=x.usePaginationFragment(Au,n);m.useEffect(()=>{m.startTransition(()=>{p({datasetVersionId:(a==null?void 0:a.id)||null},{fetchPolicy:"store-and-network"})})},[a,p]);const f=m.useMemo(()=>r.examples.edges.map(w=>{const P=w.example,_=P.revision;return{id:P.id,input:_.input,output:_.output,metadata:_.metadata}}),[r]),g=Le({columns:[{id:"select",header:({table:w})=>e(na,{checked:w.getIsAllRowsSelected(),indeterminate:w.getIsSomeRowsSelected(),onChange:w.getToggleAllRowsSelectedHandler()}),cell:({row:w})=>e(na,{checked:w.getIsSelected(),disabled:!w.getCanSelect(),indeterminate:w.getIsSomeSelected(),onChange:w.getToggleSelectedHandler()})},{header:"example id",accessorKey:"id",cell:({getValue:w,row:P})=>{const _=P.original.id;return e(Ze,{to:`${_}`,children:w()})}},{header:"input",accessorKey:"input",cell:wa},{header:"output",accessorKey:"output",cell:wa},{header:"metadata",accessorKey:"metadata",cell:wa}],data:f,state:{rowSelection:l},onRowSelectionChange:i,getCoreRowModel:we()}),y=g.getRowModel().rows,k=y.length===0,b=g.getSelectedRowModel().rows,S=b.map(w=>w.original),K=m.useCallback(()=>{i({})},[i]),T=m.useCallback(w=>{if(w){const{scrollHeight:P,scrollTop:_,clientHeight:z}=w;P-_-z<300&&!c&&d&&o(Hv)}},[d,c,o]),D=ue();return s("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:t,onScroll:w=>T(w.target),children:[s("table",{css:sa,children:[e("thead",{children:g.getHeaderGroups().map(w=>e("tr",{children:w.headers.map(P=>e("th",{children:e("div",{children:Z(P.column.columnDef.header,P.getContext())})},P.id))},w.id))}),k?e(cn,{}):e("tbody",{children:y.map(w=>e("tr",{onClick:()=>{D(`${w.original.id}`)},children:w.getVisibleCells().map(P=>e("td",{children:Z(P.column.columnDef.cell,P.getContext())},P.id))},w.id))})]}),b.length?e(Uv,{selectedExamples:S,onClearSelection:K,onExamplesDeleted:()=>{p({},{fetchPolicy:"store-and-network"})}}):null]})}function A2(){const n=qe();return Je(n),s(U,{children:[e(Gv,{dataset:n.dataset})," ",e(m.Suspense,{children:e(Ke,{})})]})}const Nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},r=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:r,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:r,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"91f92395f5df4858554b124deed3f47a",id:null,metadata:{},name:"experimentsLoaderQuery",operationKind:"query",text:`query experimentsLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      ...ExperimentsTableFragment
    }
  }
}

fragment ExperimentsTableFragment on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Nu.hash="1461484d9e1232cbb99e1251edabbec3";async function z2(n){const{datasetId:a}=n.params;return await x.fetchQuery(Fe,Nu,{id:a}).toPromise()}const $u=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:t,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1db5ce5523fa9a472c91d093b0e6160e",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();$u.hash="c7c7580fe40888ceb86a1701fe4eedf4";const Ou=function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:$u,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Dataset",abstractKey:null}}();Ou.hash="c7c7580fe40888ceb86a1701fe4eedf4";function Wv({experimentId:n}){return e(Ut,{children:s(xn,{buttonSize:"compact",align:"end",icon:e(L,{svg:e(Ht,{})}),onAction:a=>{a==="csv"&&window.open(un(`/v1/experiments/${n}/csv`),"_blank"),a==="json"&&window.open(un(`/v1/experiments/${n}/json`),"_blank")},children:[e(ie,{children:"Download CSV"},"csv"),e(ie,{children:"Download JSON"},"json")]})})}function Jv({getValue:n}){const a=n(),t=a!==null?a*100:null,l=m.useMemo(()=>{if(t!==null)return t>=80?"red-1100":t>0?"orange-1100":"green-1100"},[t]);return e(v,{color:l,children:Pt(t)})}const Qu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}}();Qu.hash="4ab310746eb51c6a3fcb799d2c972762";function Zv(n){const a=ue(),[t,l]=m.useState(null),[i,r]=x.useMutation(Qu),{datasetId:o,selectedExperiments:d,onClearSelection:c,onExperimentsDeleted:p}=n,f=d.length!==1,u=he(),g=Pe(),y=m.useCallback(()=>{i({variables:{input:{experimentIds:d.map(b=>b.id)}},onCompleted:()=>{u({title:"Experiments Deleted",message:`${d.length} experiment${f?"s":""} have been deleted.`}),p(),c()},onError:b=>{const S=De(b);g({title:"An error occurred",message:`Failed to delete experiments: ${(S==null?void 0:S[0])??b.message}`})}})},[i,f,g,u,c,p,d]),k=m.useCallback(()=>{l(s(X,{size:"S",title:"Delete Experiments",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{y(),l(null)},children:"Delete Experiments"})})})]}))},[y]);return s("div",{css:F`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(v,{children:`${d.length} experiment${f?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:c,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(L,{svg:r?e(We,{}):e(Ye,{})}),isDisabled:r,onPress:k,children:r?"Deleting...":"Delete"}),e(M,{variant:"primary",size:"S",onPress:()=>{a(`/datasets/${o}/compare?${d.map(b=>`experimentId=${b.id}`).join("&")}`)},leadingVisual:e(L,{svg:e(Yg,{})}),children:"Compare Experiments"})]})]})}),e(ae,{onDismiss:()=>{l(null)},children:t})]})}const Xv=100;function Yv(){return e("tbody",{className:"is-empty",children:e("tr",{children:s("td",{colSpan:100,css:F`
            text-align: center;
            padding: var(--ac-global-dimension-size-400) !important;
            button {
              margin-top: var(--ac-global-dimension-size-200);
              margin-left: auto;
              margin-right: auto;
            }
          `,children:["No experiments for this dataset. To see how to run experiments on a dataset, check out the documentation.",e(Eu,{})]})})})}function eC({dataset:n}){const a=m.useRef(null),[t,l]=m.useState({}),{data:i,loadNext:r,hasNext:o,isLoadingNext:d,refetch:c}=x.usePaginationFragment(Ou,n),p=m.useMemo(()=>i.experiments.edges.map(P=>{const _=P.experiment.annotationSummaries.reduce((z,R)=>(z[R.annotationName]=R,z),{});return{...P.experiment,annotationSummaryMap:_}}),[i.experiments.edges]),f=[{id:"select",header:({table:P})=>e(na,{checked:P.getIsAllRowsSelected(),indeterminate:P.getIsSomeRowsSelected(),onChange:P.getToggleAllRowsSelectedHandler()}),cell:({row:P})=>e(na,{checked:P.getIsSelected(),disabled:!P.getCanSelect(),indeterminate:P.getIsSomeSelected(),onChange:P.getToggleSelectedHandler()})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:P,row:_})=>{const z=_.original.id,R=_.original.sequenceNumber;return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Xt,{sequenceNumber:R}),e(Ze,{to:`/datasets/${n.id}/compare?experimentId=${z}`,children:P()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:Ee},{header:"created at",accessorKey:"createdAt",cell:Re}],u=i.experimentAnnotationSummaries.map(P=>{const{annotationName:_,minScore:z,maxScore:R}=P;return{header:()=>s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"end",children:[e(v,{children:_}),e(ey,{annotationName:_})]}),id:`annotation-${_}`,meta:{textAlign:"right"},cell:({row:Q})=>{const V=Q.original.annotationSummaryMap[_];return!V||V.meanScore==null?e("span",{css:F`
                  float: right;
                `,children:"--"}):e(nC,{annotationName:_,value:V.meanScore,min:z,max:R})}}}),g=[{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:as},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:P})=>{const _=P();return _===null||typeof _!="number"?"--":e(Me,{latencyMs:_})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:Jv},{header:"metadata",accessorKey:"metadata",minSize:200,cell:wa},{id:"actions",cell:({row:P})=>{const _=P.original.project,z=P.original.metadata;return s(h,{direction:"row",gap:"size-100",children:[e(Wv,{experimentId:P.original.id}),e(rs,{projectId:(_==null?void 0:_.id)||null,experimentId:P.original.id,metadata:z,canDeleteExperiment:!0,onExperimentDeleted:()=>{c({},{fetchPolicy:"store-and-network"})}})]})}}],y=Le({columns:[...f,...u,...g],data:p,getCoreRowModel:we(),state:{rowSelection:t},onRowSelectionChange:l}),k=y.getRowModel().rows,b=y.getSelectedRowModel().rows,S=b.map(P=>P.original),K=m.useCallback(()=>{l({})},[l]),T=k.length===0,D=m.useCallback(P=>{if(P){const{scrollHeight:_,scrollTop:z,clientHeight:R}=P;_-z-R<300&&!d&&o&&r(Xv)}},[o,d,r]),w=ue();return s("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
        width: table.getTotalSize();
      `,ref:a,onScroll:P=>D(P.target),children:[s("table",{css:sa,children:[e("thead",{children:y.getHeaderGroups().map(P=>e("tr",{children:P.headers.map(_=>{var z,R;return e("th",{align:(R=(z=_.column.columnDef)==null?void 0:z.meta)==null?void 0:R.textAlign,children:e("div",{children:Z(_.column.columnDef.header,_.getContext())})},_.id)})},P.id))}),T?e(Yv,{}):e("tbody",{children:k.map(P=>e("tr",{onClick:()=>{w(`/datasets/${n.id}/compare?experimentId=${P.original.id}`)},children:P.getVisibleCells().map(_=>e("td",{children:Z(_.column.columnDef.cell,_.getContext())},_.id))},P.id))})]}),b.length?e(Zv,{datasetId:n.id,selectedExperiments:S,onClearSelection:K,onExperimentsDeleted:()=>{c({},{fetchPolicy:"store-and-network"})}}):null]})}function nC({annotationName:n,value:a,min:t,max:l}){const i=Yr(n),r=m.useMemo(()=>{const o=typeof t=="number"?t:0,d=typeof l=="number"?l:1;if(o===d&&d===a)return 100;const c=d-o||1;return(a-o)/c*100},[a,t,l]);return s(Se,{children:[e($e,{children:s("div",{css:F`
            float: right;
            --mod-barloader-fill-color: ${i};
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: var(--ac-global-dimension-size-100);
          `,children:[_a(a),e(Zm,{width:"40px",value:r,"aria-label":"where the mean score lands between overall min max"})]})}),e(la,{children:s(C,{width:"size-2400",children:[e(oe,{level:3,weight:"heavy",children:n}),s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score"}),e(v,{size:"XS",children:_a(a)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Min"}),e(v,{size:"XS",children:_a(t)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Max"}),e(v,{size:"XS",children:_a(l)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score Percentile"}),e(v,{size:"XS",children:es(r)})]})]})]})})]})}function N2(){const n=qe();return Je(n),s(U,{children:[e(eC,{dataset:n.dataset}),e(m.Suspense,{children:e(Ke,{})})]})}const ju=function(){var n={defaultValue:null,kind:"LocalArgument",name:"datasetId"},a={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},t={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:"comparisons",args:[{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},{kind:"Variable",name:"filterCondition",variableName:"filterCondition"}],concreteType:"ExperimentComparison",kind:"LinkedField",name:"compareExperiments",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},i,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d=[{kind:"Variable",name:"id",variableName:"datasetId"}],c={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,t],kind:"Operation",name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,c],storageKey:null}]},params:{cacheID:"2858d6862ebdeb9248578effd1944942",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $experimentIds: [GlobalID!]!
  $datasetId: GlobalID!
  $filterCondition: String
) {
  comparisons: compareExperiments(experimentIds: $experimentIds, filterCondition: $filterCondition) {
    example {
      id
      revision {
        input
        referenceOutput: output
      }
    }
    runComparisonItems {
      experimentId
      runs {
        output
        error
        startTime
        endTime
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              score
              label
              annotatorKind
              explanation
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}
`}}}();ju.hash="3a013b01c738ae156d59ed0d0dcced72";const qu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a=[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateExperimentRunFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a},params:{cacheID:"215d8f5d35b74d08ed0935cc97450385",id:null,metadata:{},name:"ExperimentRunFilterConditionFieldValidationQuery",operationKind:"query",text:`query ExperimentRunFilterConditionFieldValidationQuery(
  $condition: String!
  $experimentIds: [GlobalID!]!
) {
  validateExperimentRunFilterCondition(condition: $condition, experimentIds: $experimentIds) {
    isValid
    errorMessage
  }
}
`}}}();qu.hash="ebd42c04f1fa695bbd658ed88c167854";const Bu=m.createContext(null);function aC(){const n=m.useContext(Bu);if(n===null)throw new Error("useExperimentRunFilterCondition must be used within a ExperimentRunFilterConditionProvider");return n}function tC(n){const[a,t]=m.useState(""),l=m.useCallback(r=>{m.startTransition(()=>{t(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?t(a+" and "+r):t(r)})},[a]);return e(Bu.Provider,{value:{filterCondition:a,setFilterCondition:l,appendFilterCondition:i},children:n.children})}const Uu=F`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Hu=F`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function lC(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"input",type:"variable",info:"The input of the dataset example"},{label:"reference_output",type:"variable",info:"The reference output of the dataset example"},{label:"metadata",type:"variable",info:"The metadata of the dataset example"},{label:"output",type:"variable",info:"The output of the experiment run"},{label:"error",type:"variable",info:"The error message of the experiment run (if exists)"},{label:"latency_ms",type:"variable",info:"The duration of the experiment run in milliseconds"},{label:"evals",type:"variable",info:"The evaluations of the experiment run"},{label:"search input",type:"text",apply:"'' in input",detail:"macro"},{label:"search reference output",type:"text",apply:"'' in reference_output",detail:"macro"},{label:"search output",type:"text",apply:"'' in output",detail:"macro"},{label:"has error",type:"text",apply:"error is not None",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"evals['hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['category'] == 'hard_examples'",detail:"macro"}]}}async function iC(n,a){if(!n)return{isValid:!0,errorMessage:null};const t=await pt.fetchQuery(Fe,qu,{condition:n,experimentIds:a}).toPromise();if(!t)throw new Error("Filter condition validation is null");return t.validateExperimentRunFilterCondition}const rC=[ei.of([{key:"Enter",run:n=>!0}]),yt(),cs({override:[lC]})];function sC(n){const{onValidCondition:a,placeholder:t=`filter condition (e.g., evals["Hallucination"].label == 'hallucinated')`}=n,[l,i]=m.useState(!1),[r,o]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=aC(),f=m.useDeferredValue(d),{theme:u}=$n(),g=u==="light"?da:ca,[y]=In(),k=y.getAll("experimentId");m.useEffect(()=>{iC(f,k).then(K=>{K!=null&&K.isValid?(o(""),m.startTransition(()=>{a(f)})):o((K==null?void 0:K.errorMessage)??"Invalid filter condition")})},[a,f,k]);const b=r!=="";return s("div",{"data-is-focused":l,"data-is-invalid":b,css:Hu,children:[s(h,{direction:"row",children:[e(wl,{children:e(L,{svg:e(Yl,{})})}),e(ua,{css:Uu,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:t,extensions:rC}),e("button",{css:F`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(L,{svg:e(Zt,{})})}),s(Va,{placement:"bottom right",children:[e($e,{children:e("button",{css:F`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-300);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(L,{svg:e(Dn,{})})})}),e(oC,{onAddFilterConditionSnippet:p})]})]}),s(Se,{isOpen:b&&l,placement:"bottom",children:[e($e,{children:e("div",{})}),e(la,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function oC(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(tn,{children:[e(Hn,{label:"filter by substring",initialSnippet:"'search term' in output['key']",onAddFilterConditionSnippet:a},"substring"),e(Hn,{label:"filter on errors",initialSnippet:"error is not None",onAddFilterConditionSnippet:a},"errors"),e(Hn,{label:"filter by evaluation label",initialSnippet:"evals['hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(Hn,{label:"filter by evaluation score",initialSnippet:"evals['hallucination'].score >= 0.5",onAddFilterConditionSnippet:a},"eval_score"),e(Hn,{label:"filter by evaluation explanation",initialSnippet:"'search term' in evals['hallucination'].explanation",onAddFilterConditionSnippet:a},"eval_explanation"),e(Hn,{label:"filter for lower scores than first experiment",initialSnippet:"evals['hallucination'].score < experiments[0].evals['hallucination'].score",onAddFilterConditionSnippet:a},"compare_experiments"),e(Hn,{label:"filter by metadata",initialSnippet:"metadata['category'] == 'hard_examples'",onAddFilterConditionSnippet:a},"metadata"),e(Hn,{label:"filter by latency",initialSnippet:"latency_ms >= 10_000",onAddFilterConditionSnippet:a},"latency")]})})}function Hn(n){const{initialSnippet:a,onAddFilterConditionSnippet:t}=n,[l,i]=m.useState(a),{theme:r}=$n(),o=r==="light"?da:ca;return e(ra,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:F(Hu,F`
              flex: 1 1 auto;
            `),children:e(ua,{value:l,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[yt()],editable:!0,onChange:i,theme:o,css:Uu})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>t(l),leadingVisual:e(L,{svg:e(Dn,{})})})]})})}const vl={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},dC=F`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,cC=F`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function uC(n){const{datasetId:a,experimentIds:t,displayFullText:l}=n,[i,r]=m.useState(""),o=x.useLazyLoadQuery(ju,{experimentIds:t,datasetId:a,filterCondition:i}),d=m.useMemo(()=>{var T,D;return((D=(T=o.dataset)==null?void 0:T.experiments)==null?void 0:D.edges.reduce((w,P)=>{var _,z;return w[P.experiment.id]={...P.experiment,projectId:((z=(_=P.experiment)==null?void 0:_.project)==null?void 0:z.id)||null},w},{}))||{}},[o]),c=m.useMemo(()=>o.comparisons.map(T=>{const D=T.runComparisonItems.reduce((w,P)=>(w[P.experimentId]=P,w),{});return{...T,id:T.example.id,input:T.example.revision.input,referenceOutput:T.example.revision.referenceOutput,runComparisonMap:D}}),[o]),[p,f]=m.useState(null),u=m.useMemo(()=>[{header:"input",accessorKey:"input",minWidth:500,cell:({row:T})=>e(Mi,{controls:s(Se,{children:[e(M,{size:"S","aria-label":"View example details",leadingVisual:e(L,{svg:e(ot,{})}),onPress:()=>{m.startTransition(()=>{f(e(m.Suspense,{children:e(mi,{exampleId:T.original.example.id,onDismiss:()=>{f(null)}})}))})}}),e(Ne,{children:"View Example"})]}),children:e(Ft,{children:e(Si,{children:e($a,{json:T.original.input,disableTitle:!0,space:l?2:0})})})})},{header:"reference output",accessorKey:"referenceOutput",minWidth:500,cell:T=>e(Ft,{children:l?yC(T):wa(T)})}],[l]),g=m.useMemo(()=>t.map(T=>({header:()=>{var z,R,Q,V;const D=(z=d[T])==null?void 0:z.name,w=(R=d[T])==null?void 0:R.metadata,P=(Q=d[T])==null?void 0:Q.projectId,_=((V=d[T])==null?void 0:V.sequenceNumber)||0;return s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Xt,{sequenceNumber:_}),e(v,{children:D})]}),e(rs,{experimentId:T,metadata:w,isQuiet:!0,projectId:P,canDeleteExperiment:!1})]})},accessorKey:T,minSize:500,cell:({row:D})=>{var $,N;const w=D.original.runComparisonMap[T],P=(w==null?void 0:w.runs.length)||0;if(P===0)return e(cr,{});if(P>1)return e(v,{color:"warning",children:`${P} runs`});const _=w==null?void 0:w.runs[0];let z=null;const R=($=_==null?void 0:_.trace)==null?void 0:$.traceId,Q=(N=_==null?void 0:_.trace)==null?void 0:N.projectId;return R&&Q&&(z=s(Se,{children:[e(M,{variant:"default",className:"trace-button",size:"S","aria-label":"View run trace",leadingVisual:e(L,{svg:e(Qt,{})}),onPress:()=>{m.startTransition(()=>{f(e(Zu,{traceId:R,projectId:Q,title:"Experiment Run Trace"}))})}}),e(Ne,{children:"View Trace"})]})),_?e(Mi,{controls:s(U,{children:[s(Se,{children:[e(M,{variant:"default",className:"expand-button",size:"S","aria-label":"View example run details",leadingVisual:e(L,{svg:e(ot,{})}),onPress:()=>{m.startTransition(()=>{f(e(fC,{selectedExample:D.original,datasetId:a,experimentInfoById:d}))})}}),e(Ne,{children:"View run details"})]}),z]}),children:e(Ft,{children:e(gC,{..._,displayFullText:l,setDialog:f})})}):e(Ft,{children:e(cr,{})})}})),[t,d,a,l]),y=m.useMemo(()=>[...u,...g],[u,g]),k=Le({columns:y,data:c,getCoreRowModel:we(),columnResizeMode:"onChange"}),b=pe.useMemo(()=>{const T=k.getFlatHeaders(),D={};for(let w=0;w<T.length;w++){const P=T[w];D[`--header-${P.id}-size`]=P.getSize(),D[`--col-${P.column.id}-size`]=P.column.getSize()}return D},[k.getState().columnSizingInfo,k.getState().columnSizing]),K=k.getRowModel().rows.length===0;return e(C,{overflow:"auto",children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(sC,{onValidCondition:r})}),s("div",{css:dC,children:[s("table",{css:F(sn,Vr),style:{...b,width:k.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:k.getHeaderGroups().map(T=>e("tr",{children:T.headers.map(D=>s("th",{style:{width:`calc(var(--header-${D==null?void 0:D.id}-size) * 1px)`},children:[e("div",{children:Z(D.column.columnDef.header,D.getContext())}),e("div",{onMouseDown:D.getResizeHandler(),onTouchStart:D.getResizeHandler(),className:`resizer ${D.column.getIsResizing()?"isResizing":""}`})]},D.id))},T.id))}),K?e(cn,{}):k.getState().columnSizingInfo.isResizingColumn?e(mC,{table:k}):e(Gu,{table:k})]}),e(ae,{isDismissable:!0,type:"slideOver",onDismiss:()=>{f(null)},children:p})]})]})})}function Gu({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{height:1,width:`calc(var(--col-${t.column.id}-size) * 1px)`,padding:0},children:Z(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const mC=pe.memo(Gu,(n,a)=>n.table.options.data===a.table.options.data);function pC(n){const{datasetId:a,exampleId:t}=n,l=ue();return e("div",{onClick:i=>{i.preventDefault(),i.stopPropagation()},children:e(xn,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"gotoExample":return l(`/datasets/${a}/examples/${t}`);default:ve()}},children:e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(ay,{})}),e(v,{children:"Go to example"})]})},"gotoExample")})})}function gC(n){const{output:a,error:t,startTime:l,endTime:i,annotations:r,displayFullText:o,setDialog:d}=n;if(t)return e(Wu,{error:t});const c=r!=null&&r.edges.length?r.edges.map(p=>p.annotation):[];return s(h,{direction:"column",gap:"size-100",height:"100%",justifyContent:"space-between",children:[e(Si,{children:e($a,{json:a,disableTitle:!0,space:o?2:0})}),s("ul",{css:F`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-static-size-100);
          align-items: center;
          flex-wrap: wrap;
        `,children:[e("li",{children:e(Ju,{startTime:l,endTime:i})},"run-latency"),c.map(p=>e("li",{children:e(za,{annotation:p,extra:p.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:cC,children:[e(L,{svg:e(Mn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(zn,{annotation:p,onClick:()=>{const f=p.trace;f&&m.startTransition(()=>{d(e(Zu,{traceId:f.traceId,projectId:f.projectId,title:`Evaluator Trace: ${p.name}`}))})}})})},p.id))]})]})}function Wu({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(Ql,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}function Ju({startTime:n,endTime:a}){const t=m.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Me,{latencyMs:t})}function cr(){return s(h,{direction:"row",gap:"size-50",children:[e(L,{svg:e(ny,{}),color:"grey-800"}),e(v,{color:"text-700",children:"not run"})]})}function yC({getValue:n}){const a=n();return e(Si,{children:e($a,{json:a,space:2})})}function Si({children:n}){return e("div",{css:F`
        max-height: 300px;
        overflow-y: auto;
      `,children:n})}function fC({selectedExample:n,datasetId:a,experimentInfoById:t}){return e(X,{title:`Comparing Experiments for Example: ${n.id}`,size:"fullscreen",extra:e(pC,{datasetId:a,exampleId:n.id}),children:s(pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(_e,{defaultSize:35,children:e("div",{css:F`
              overflow-y: auto;
              height: 100%;
            `,children:e(C,{overflow:"hidden",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(q,{title:"Input",...vl,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(ce,{text:JSON.stringify(n.input)}),children:e(nn,{value:JSON.stringify(n.input,null,2)})})}),e(C,{width:"50%",children:e(q,{title:"Reference Output",...vl,extra:e(ce,{text:JSON.stringify(n.referenceOutput)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(nn,{value:JSON.stringify(n.referenceOutput,null,2)})})})]})})})}),e(vn,{css:Na}),e(_e,{defaultSize:65,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(oe,{level:2,children:"Experiments"})}),e("div",{css:F`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:e("ul",{css:F`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-static-size-200);
                `,children:n.runComparisonItems.map(l=>{const i=t[l.experimentId];return e("li",{children:e(q,{...vl,title:i==null?void 0:i.name,titleExtra:e(Xt,{sequenceNumber:(i==null?void 0:i.sequenceNumber)||0}),children:e("ul",{children:l.runs.map((r,o)=>{var d;return e("li",{children:s(h,{direction:"row",children:[e(C,{flex:!0,children:r.error?e(C,{padding:"size-200",children:e(Wu,{error:r.error})}):e(nn,{value:JSON.stringify(r.output,null,2)})}),s(ha,{width:"size-3000",children:[e(Ju,{startTime:r.startTime,endTime:r.endTime}),e("ul",{css:F`
                                      margin-top: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                      display: flex;
                                      flex-direction: column;
                                      justify-content: flex-start;
                                      align-items: flex-end;
                                      gap: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                    `,children:(d=r.annotations)==null?void 0:d.edges.map(c=>e("li",{children:e(zn,{annotation:c.annotation})},c.annotation.id))})]})]})},o)})})})},l.experimentId)})})})]})})]})})}function Zu({traceId:n,projectId:a,title:t}){const l=ue();return e(X,{title:t,size:"fullscreen",extra:e(M,{onPress:()=>l(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(gi,{traceId:n,projectId:a})})}function Ft({children:n}){return e(C,{paddingX:"size-200",paddingY:"size-100",children:n})}const Xu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__experiments",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};Xu.hash="1aa376b1e9425f49268ac231dc2c0412";function hC(n){const{dataset:a,selectedExperimentIds:t,onChange:l,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=x.useFragment(Xu,a),f=m.useMemo(()=>p.experiments.edges.map(y=>y.experiment),[p]),u=f.length===0,g=m.useMemo(()=>{if(u)return"No experiments";const y=t.length;return y>0?`${y} experiment${y>1?"s":""}`:"No experiments selected"},[t,u]);return e(ra,{label:i,isDisabled:u,validationState:r,description:o,errorMessage:d,children:e(El,{isDisabled:u,...c,menu:e(Vt,{selectionMode:"multiple",onSelectionChange:y=>{l(Array.from(y))},selectedKeys:new Set(t),children:f.map(y=>e(ie,{textValue:y.name,children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(Xt,{sequenceNumber:y.sequenceNumber}),e(v,{children:y.name})]}),e(v,{size:"XS",color:"text-700",children:new Date(y.createdAt).toLocaleString()})]})},y.id))}),triggerProps:{placement:"bottom start"},children:g})})}function $2(){const n=qe();Je(n);const[a,t]=m.useState(!1),[l,i]=In(),r=l.getAll("experimentId"),o=r.length>0;return s("main",{css:F`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"column",gap:"size-100",children:[e(oe,{level:1,children:"Compare Experiments"}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[e(hC,{dataset:n.dataset,selectedExperimentIds:r,label:"experiments",onChange:d=>{m.startTransition(()=>{l.delete("experimentId"),d.forEach(c=>{l.append("experimentId",c)}),i(l)})}}),e(Fa,{onChange:d=>{t(d)},defaultSelected:!1,labelPlacement:"start",children:"Full Text"})]})]})}),o?e(tC,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(uC,{datasetId:n.dataset.id,experimentIds:r,displayFullText:a})})}):e(C,{padding:"size-200",children:e(be,{variant:"info",title:"No Experiment Selected",children:"Please select one or more experiments."})})]})}const Yu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,{args:null,kind:"FragmentSpread",name:"ExperimentMultiSelector__experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[l,{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e89f99f940098a21985137aae870de7",id:null,metadata:{},name:"experimentCompareLoaderQuery",operationKind:"query",text:`query experimentCompareLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      ...ExperimentMultiSelector__experiments
    }
  }
}

fragment ExperimentMultiSelector__experiments on Dataset {
  experiments {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        createdAt
      }
    }
  }
}
`}}}();Yu.hash="fa02088830fd16688f0f2fba9a0009eb";async function O2(n){const{datasetId:a}=n.params;return await x.fetchQuery(Fe,Yu,{id:a}).toPromise()}const kC=F`
  overflow-y: auto;
  height: 100%;
`,bC=F`
  padding: var(--ac-global-dimension-size-100);
  max-width: 1000px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  height: 100%;
`;function Q2(){const{pathname:n}=mt(),a=ue(),t=n.split("/settings")[1].replace("/",""),l=m.useCallback(i=>{typeof i=="string"&&a(`/settings/${i}`,{replace:!0})},[a]);return t?e("main",{css:kC,children:e("div",{css:bC,children:s(Ge,{selectedKey:t,onSelectionChange:l,children:[s(He,{children:[e(ne,{id:"general",children:"General"}),e(ne,{id:"providers",children:"AI Providers"})]}),e(de,{id:"general",padded:!0,children:e(Ke,{})}),e(de,{id:"providers",padded:!0,children:e(Ke,{})}),e(de,{id:"annotations",padded:!0,children:e(q,{title:"Annotations Settings",variant:"compact",children:s(h,{direction:"column",gap:"size-200",children:[e(v,{children:"Annotation settings and configurations will be available here."}),e(v,{children:"Configure annotation types, labels, and workflows for your projects."})]})})})]})})}):e(hr,{to:"/settings/general",replace:!0})}const em={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsGeneralPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"DBUsagePieChart_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsGeneralPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}]},params:{cacheID:"b23054c72be2f3ddc335774d54407667",id:null,metadata:{},name:"settingsGeneralPageLoaderQuery",operationKind:"query",text:`query settingsGeneralPageLoaderQuery {
  ...DBUsagePieChart_data
}

fragment DBUsagePieChart_data on Query {
  dbTableStats {
    tableName
    numBytes
  }
  dbStorageCapacityBytes
}
`}};em.hash="567b82d32463e4ba410f49c53bc9dcf2";async function j2(){return await x.fetchQuery(Fe,em,{}).toPromise()}const ur=window.Config.basename,mr={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function q2(){return s("div",{css:F`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(be,{variant:"info",banner:!0,icon:e(L,{svg:e(ty,{})}),children:"These APIs are under active development and are subject to change."}),s(Ge,{children:[s(He,{children:[e(ne,{id:"rest",children:"REST"}),e(ne,{id:"graphql",children:"GraphQL"})]}),e(de,{id:"rest",children:e("iframe",{src:`${ur}/docs`,style:mr})}),e(de,{id:"graphql",children:e("iframe",{src:`${ur}/graphql`,style:mr})})]})]})}function sl({children:n}){return s("main",{css:F`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(C,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),s("footer",{css:F`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://docs.arize.com/phoenix",children:"Documentation"}),"|",e("a",{href:"https://join.slack.com/t/arize-ai/shared_invite/zt-1px8dcmlf-fmThhDFD_V_48oU7ALan4Q",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function SC(n){const a=ue(),{initialError:t,onSubmit:l}=n,[i,r]=m.useState(t),[o,d]=m.useState(!1),c=m.useCallback(async u=>{l==null||l(),r(null),d(!0);try{const y=await fetch(un("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!y.ok){const k=y.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const g=ly();a(g)},[a,l,r]),{control:p,handleSubmit:f}=Oe({defaultValues:{email:"",password:""}});return s(U,{children:[i?s(C,{paddingBottom:"size-100",children:[e(be,{variant:"danger",children:i})," "]}):null,e(tn,{children:s(h,{direction:"column",gap:"size-100",children:[e(W,{name:"email",control:p,render:({field:{onChange:u,value:g}})=>s(Y,{name:"email",isRequired:!0,type:"email",onChange:u,value:g,autoComplete:"email",children:[e(J,{children:"Email"}),e(se,{placeholder:"your email address"})]})}),s("div",{css:F`
              position: relative;
              a {
                position: absolute;
                float: right;
                right: 0;
                top: var(--ac-global-dimension-size-50);
                font-size: 12px;
              }
            `,children:[e(W,{name:"password",control:p,render:({field:{onChange:u,value:g}})=>s(Y,{name:"password",type:"password",isRequired:!0,onChange:u,value:g,onKeyDown:y=>{y.key==="Enter"&&f(c)()},autoComplete:"password",children:[e(J,{children:"Password"}),e(se,{placeholder:"your password"})]})}),e(Ze,{to:"/forgot-password",children:"Forgot your password?"})]}),e(M,{variant:"primary",isDisabled:o,leadingVisual:o?e(L,{svg:e(We,{})}):void 0,onPress:()=>f(c)(),children:o?"Logging In":"Log In"})]})})]})}const vC=F`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`;function CC({idpName:n,idpDisplayName:a,returnUrl:t}){return e("form",{action:un(`/oauth2/${n}/login${t?`?returnUrl=${t}`:""}`),method:"post",css:vC,"data-provider":n,children:s(M,{variant:"default",type:"submit",leadingVisual:e(FC,{idpName:n}),children:["Login with ",a]})})}function FC({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n.startsWith("aws")?e("i",{children:e("div",{css:F`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
        `,"data-provider":n})}):null}function vi(){return s("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),s("defs",{children:[s("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),s("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const KC=F`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,TC=F`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function B2(){const n=window.Config.oAuth2Idps,a=n.length>0,[t,l]=In(),i=t.get("returnUrl"),r=t.get("message");return s(sl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(vi,{})})}),r&&e(C,{paddingBottom:"size-100",children:e(be,{variant:"success",children:r})}),e(SC,{initialError:t.get("error"),onSubmit:()=>{l(o=>{const d=new URLSearchParams(o);return d.delete("message"),d.delete("error"),d})}}),a&&s(U,{children:[e("div",{css:KC,children:"or"}),e("ul",{css:TC,children:n.map(o=>e("li",{children:e(CC,{idpName:o.name,idpDisplayName:o.displayName,returnUrl:i},o.name)},o.name))})]})]})}const nm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();nm.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const am={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResetPasswordFormQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};am.hash="1161643b76edb6ef437d8f136038cf21";const Ya=4;function PC(n){var p;const a=ue(),t=Pe(),l=x.useFragment(am,n.query),[i,r]=x.useMutation(nm),{control:o,handleSubmit:d}=Oe({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),c=m.useCallback(f=>{i({variables:{input:{currentPassword:f.currentPassword,newPassword:f.newPassword}},onCompleted:()=>{const u=ss({path:"/login",searchParams:{message:"Password has been reset."}});a(u)},onError:u=>{t({title:"Failed to reset password",message:u.message})}})},[i,a,t]);return s(Mt,{onSubmit:d(c),children:[e(Tl,{children:s(Y,{name:"email",type:"email",autoComplete:"email",isRequired:!0,isReadOnly:!0,value:(p=l.viewer)==null?void 0:p.email,children:[e(J,{children:"Email"}),e(se,{})]})}),e(W,{name:"currentPassword",control:o,rules:{required:"the current is required"},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{type:"password",name:f,isRequired:!0,isInvalid:k,onChange:u,onBlur:g,value:y,id:"current-password",autoComplete:"current-password",children:[e(J,{children:"Old Password"}),e(se,{}),b?e(xe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"The current password"})]})}),e(W,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:Ya,message:`Password must be at least ${Ya} characters`},validate:(f,u)=>f!==u.currentPassword||"New password must be different"},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{type:"password",isRequired:!0,name:f,isInvalid:k,onChange:u,onBlur:g,defaultValue:y,id:"new-password",autoComplete:"new-password",children:[e(J,{children:"New Password"}),e(se,{}),b?e(xe,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",Ya," characters"]})]})}),e(W,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:Ya,message:`Password must be at least ${Ya} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{isRequired:!0,type:"password",name:f,isInvalid:k,onChange:u,onBlur:g,defaultValue:y,autoComplete:"new-password",children:[e(J,{children:"Confirm Password"}),e(se,{}),b?e(xe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),s("div",{css:F`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-200);
          padding-top: var(--ac-global-dimension-size-100);
          & > * {
            width: 50%;
          }
        `,children:[e(M,{onPress:()=>{a(-1)},children:"Cancel"}),e(M,{variant:"primary",type:"submit",isDisabled:r,children:r?"Resetting...":"Reset Password"})]})]})}function U2(){const n=qe();return s(sl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(vi,{})})}),e(PC,{query:n})]})}const et=4,IC="An error occurred. Please try resetting again.";function xC({resetToken:n}){const a=ue(),[t,l]=m.useState(null),[i,r]=m.useState(!1),o=m.useCallback(async({resetToken:f,newPassword:u})=>{l(null),r(!0);try{const g=await fetch(un("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:f,password:u})});if(!g.ok){const y=await g.text();l(y);return}}catch{l(IC);return}finally{r(()=>!1)}a(`/login?message=${encodeURIComponent("Password has been reset.")}`)},[l,a]),{control:d,handleSubmit:c,formState:{isDirty:p}}=Oe({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return s(U,{children:[t?e(C,{paddingBottom:"size-100",children:e(be,{variant:"danger",children:t})}):null,s(Mt,{onSubmit:c(o),children:[e(W,{name:"newPassword",control:d,rules:{required:"Password is required",minLength:{value:et,message:`Password must be at least ${et} characters`}},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{type:"password",isRequired:!0,name:f,isInvalid:k,id:"new-password",autoComplete:"new-password",onChange:u,onBlur:g,defaultValue:y,children:[e(J,{children:"New Password"}),e(se,{}),b?e(xe,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",et," characters"]})]})}),e(W,{name:"confirmPassword",control:d,rules:{required:"Password is required",minLength:{value:et,message:`Password must be at least ${et} characters`},validate:(f,u)=>f===u.newPassword||"Passwords do not match"},render:({field:{name:f,onChange:u,onBlur:g,value:y},fieldState:{invalid:k,error:b}})=>s(Y,{type:"password",isRequired:!0,name:f,isInvalid:k,onChange:u,onBlur:g,defaultValue:y,children:[e(J,{children:"Confirm Password"}),e(se,{}),b?e(xe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),e("div",{css:F`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:p?"primary":"default",type:"submit",isDisabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function H2(){const n=ue(),[a]=In(),t=a.get("token");return t?s(sl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(vi,{})})}),e(xC,{resetToken:t}),e(C,{paddingTop:"size-200",children:e(h,{direction:"column",alignItems:"center",justifyContent:"center",children:e(Ze,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const tm=function(){var n={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:[n,{args:null,kind:"FragmentSpread",name:"ResetPasswordFormQuery"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:[n]},params:{cacheID:"558e2fa85c0dc24da6318db9ebbd7958",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
  ...ResetPasswordFormQuery
}

fragment ResetPasswordFormQuery on Query {
  viewer {
    email
  }
}
`}}}();tm.hash="17bb397eaa3a44dd33996854e538f2ef";async function G2(){const n=await x.fetchQuery(Fe,tm,{}).toPromise();return n!=null&&n.viewer?n:it("/login")}function DC({onResetSent:n}){const[a,t]=m.useState(null),[l,i]=m.useState(!1),r=m.useCallback(async c=>{t(null),i(!0);try{const p=await fetch(un("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!p.ok){const f=await p.text();t(f);return}n()}finally{i(()=>!1)}},[n,t]),{control:o,handleSubmit:d}=Oe({defaultValues:{email:""}});return s(U,{children:[a?e(C,{paddingBottom:"size-100",children:e(be,{variant:"danger",children:a})}):null,s(tn,{onSubmit:d(r),children:[e(W,{name:"email",control:o,render:({field:{onChange:c,value:p}})=>s(Y,{name:"email",isRequired:!0,type:"email",onChange:c,value:p,children:[e(J,{children:"Email"}),e(se,{placeholder:"your email address"}),e(v,{slot:"description",children:"Enter the email address associated with your account."})]})}),e("div",{css:F`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:"primary",type:"submit",isDisabled:l,children:l?"Sending...":"Send"})})]})]})}function W2(){const[n,a]=m.useState(!1),t=n?s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(oe,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):s(U,{children:[s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(oe,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(DC,{onResetSent:()=>a(!0)})]});return e(sl,{children:s("div",{css:F`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[t,e(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(Ze,{to:"/login",children:"Back to Login"})})]})})}const lm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"572bf0f64678128defccf833e6a5d4ce",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();lm.hash="28061ae008e197468be6fd5f2775ccb0";const im=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f28a00e7a6eb2e18b1f8b31c8231c2b7",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
    query {
      ...UserAPIKeysTableFragment
    }
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();im.hash="3a505d9d13944798a57fc873ddf0992d";const rm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"e677b5974fa137ac3a26acde353767d8",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    __isNode: __typename
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();rm.hash="6c32098d55e4cba859dcec73f3ccd28c";const sm=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:rm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}}();sm.hash="6c32098d55e4cba859dcec73f3ccd28c";const pr=70;function _C({query:n}){const[a,t]=x.useRefetchableFragment(sm,n),l=he(),[i]=x.useMutation(im),r=m.useCallback(u=>{i({variables:{input:{id:u}},onCompleted:()=>{l({title:"API key deleted",message:"The key has been deleted and is no longer active."}),m.startTransition(()=>{t({},{fetchPolicy:"network-only"})})}})},[i,l,t]),o=m.useMemo(()=>[...a.apiKeys],[a]),d=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Ee},{header:"Description",accessorKey:"description",cell:Ee},{header:"Created At",accessorKey:"createdAt",size:pr,cell:Re},{header:"Expires At",accessorKey:"expiresAt",size:pr,cell:Re},{header:"",accessorKey:"id",size:10,cell:({row:g})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Al,{handleDelete:()=>{r(g.original.id)}})}),meta:{textAlign:"right"}}],[r]),c=Le({columns:d,data:o,getCoreRowModel:we()}),p=c.getRowModel().rows,f=c.getRowModel().rows.length===0;return s("table",{css:sn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},g.id))},u.id))}),f?e(cn,{message:"No Keys"}):e("tbody",{children:p.map(u=>e("tr",{children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))})]})}function LC({viewer:n}){const[a,t]=m.useState(null),l=Pe(),[i,r]=x.useMutation(lm),o=m.useCallback(d=>{var c;i({variables:{input:{...d,expiresAt:((c=d.expiresAt)==null?void 0:c.toDate(xl()).toISOString())||null}},onCompleted:p=>{t(e(Fr,{jwt:p.createUserApiKey.jwt}))},onError:p=>{l({title:"Error creating API key",message:p.message})}})},[i,l]);return s(q,{title:"API Keys",variant:"compact",bodyStyle:{padding:0},extra:e(M,{size:"S",leadingVisual:e(L,{svg:e(Dn,{})}),onPress:()=>t(e(Kr,{onSubmit:o,isCommitting:r})),children:"New Key"}),children:[e(_C,{query:n}),e(ae,{onDismiss:()=>{t(null)},children:a})]})}const om=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();om.hash="4a11ca65151d84fe95f636763c91dc68";function wC(){const{viewer:n,refetchViewer:a}=os(),t=Pe(),l=he(),[i,r]=x.useMutation(om),{control:o,handleSubmit:d,formState:{isDirty:c},reset:p}=Oe({defaultValues:{username:(n==null?void 0:n.username)||""}}),f=m.useCallback(u=>{i({variables:{input:{newUsername:u.username}},onCompleted:()=>{l({title:"Profile updated",message:"Your profile has been updated"}),p({username:u.username}),a()},onError:g=>{t({title:"Failed update profile",message:g.message})}})},[i,l,p,a,t]);return n?s(q,{title:"Profile",variant:"compact",bodyStyle:{padding:0},extra:n.authMethod==="LOCAL"&&e(Ta,{size:"S",to:"/reset-password",children:"Reset Password"}),children:[e(C,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[e(zl,{name:n.username||n.email,profilePictureUrl:n.profilePictureUrl}),s(h,{direction:"column",gap:"size-50",children:[e(oe,{level:2,weight:"heavy",children:n.username||n.email}),e(v,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(C,{children:s(tn,{onSubmit:d(f),children:[e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[s(Y,{value:n.email,isReadOnly:!0,size:"S",children:[e(J,{children:"Email"}),e(se,{})]}),e(W,{name:"username",control:o,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:u,onChange:g,onBlur:y,value:k},fieldState:{invalid:b,error:S}})=>s(Y,{isRequired:!0,name:u,isInvalid:b,onChange:g,onBlur:y,defaultValue:k,size:"S",children:[e(J,{children:"Username"}),e(se,{}),S?e(xe,{children:S.message}):e(v,{slot:"description",children:"A unique username"})]})})]})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",size:"S",isDisabled:!c,onPress:()=>{d(f)()},children:r?"Saving...":"Save"})})})]})})]}):null}const EC=F`
  overflow-y: auto;
`,RC=F`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function J2(){const{viewer:n}=os();return n?e("main",{css:EC,children:e("div",{css:RC,children:s(h,{direction:"column",gap:"size-200",children:[e(wC,{}),e(LC,{viewer:n})]})})}):null}function Z2(){return e(fi,{})}function X2(){const n=qe();Je(n);const a=m.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:t,parsingErrors:l,playgroundInput:i}=m.useMemo(()=>Jy(a),[a]),r=i!=null?{input:i}:{};return s(h,{direction:"column",height:"100%",children:[e(MC,{span:a,parsingErrors:l}),e(fi,{instances:[t],...r},a.id)]})}function MC({span:n,parsingErrors:a}){const t=ue(),l=a&&a.length>0,[i,r]=m.useState(!0),[o,d]=m.useState(l);return s(h,{direction:"column",children:[i&&e(be,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(M,{leadingVisual:e(L,{svg:e(iy,{})}),onPress:()=>{t(`/projects/${n.project.id}/traces/${n.trace.traceId}?selectedSpanNodeId=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),o&&l&&e(be,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{d(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(c=>e("li",{children:c},c))})})]})}const dm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},o={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],p={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:c,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,o,d,p],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,o,d,p],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"a386c63f2da095f3c0f5bbb383ffd74d",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      spanId
      trace {
        id
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();dm.hash="1b9e7f07a78fcf0f03722fea073f8a32";async function Y2(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await x.fetchQuery(Fe,dm,{spanId:a}).toPromise()}const cm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptsTablePromptsQuery",selections:[{args:a,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptsTablePromptsQuery",selections:[{alias:null,args:a,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"78e88c2a2ce510e78c6c6d8e1b8523b2",id:null,metadata:{},name:"PromptsTablePromptsQuery",operationKind:"query",text:`query PromptsTablePromptsQuery(
  $after: String = null
  $first: Int = 100
) {
  ...PromptsTable_prompts_2HEEH6
}

fragment PromptsTable_prompts_2HEEH6 on Query {
  prompts(first: $first, after: $after) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();cm.hash="829c7cff273e0ebcfba1c0606c052d8b";const um=function(){var n=["prompts"],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:cm}},name:"PromptsTable_prompts",selections:[{alias:"prompts",args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"__PromptsTable_prompts_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();um.hash="829c7cff273e0ebcfba1c0606c052d8b";const mm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"}],kind:"ObjectValue",name:"input"}],t=[{kind:"Literal",name:"first",value:100}],l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:t,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}],storageKey:null}],storageKey:null}]},params:{cacheID:"3afd45452374727a72b967ee1cce1632",id:null,metadata:{},name:"DeletePromptDialogMutation",operationKind:"mutation",text:`mutation DeletePromptDialogMutation(
  $promptId: GlobalID!
) {
  deletePrompt(input: {promptId: $promptId}) {
    query {
      ...PromptsTable_prompts
    }
  }
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();mm.hash="209a27a82eef96e2c39abfe579346bcc";function VC({promptId:n,onDeleted:a,onClose:t}){const[l,i]=x.useMutation(mm),r=he(),o=Pe(),d=m.useCallback(()=>{l({variables:{promptId:n},onCompleted:()=>{r({title:"Delete Successful",message:"Prompt has been deleted."}),a(),t()},onError:c=>{o({title:"Failed to delete prompt",message:c.message})}})},[l,o,r,t,a,n]);return s(X,{title:"Delete Prompt",isDismissable:!0,onDismiss:t,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this prompt? This action cannot be undone and all services dependent on this prompt will be affected."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:t,size:"S",children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},size:"S",isDisabled:i,children:"Delete Prompt"})]})})]})}function AC({onDeleted:n,promptId:a}){const[t,l]=m.useState(null),i=m.useCallback(()=>{l(e(VC,{promptId:a,onClose:()=>l(null),onDeleted:()=>{n(),l(null)}}))},[a,n]);return s(Ut,{children:[e(xn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:r=>{switch(r){case"DELETE":i();break}},children:e(ie,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(Ye,{})}),e(U,{children:"Delete"})]})},"DELETE")}),e(ae,{type:"modal",isDismissable:!0,onDismiss:()=>l(null),children:t})]})}const zC=100;function NC(n){const a=ue(),t=m.useRef(null),{data:l,loadNext:i,hasNext:r,isLoadingNext:o,refetch:d}=x.usePaginationFragment(um,n.query),c=m.useMemo(()=>l.prompts.edges.map(k=>({lastUpdatedAt:k.prompt.version.createdAt,...k.prompt})),[l]),p=pe.useCallback(k=>{if(k){const{scrollHeight:b,scrollTop:S,clientHeight:K}=k;b-S-K<300&&!o&&r&&i(zC)}},[r,o,i]),f=m.useMemo(()=>[{header:"name",accessorKey:"name",cell:({row:b})=>e(Ze,{to:`${b.original.id}`,children:b.original.name})},{header:"description",accessorKey:"description",cell:Ee},{header:"created at",accessorKey:"createdAt",cell:Re},{header:"last updated",accessorKey:"lastUpdatedAt",cell:Re},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:b})=>s(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:[e(Ut,{children:e(Ta,{leadingVisual:e(L,{svg:e(Ka,{})}),size:"S","aria-label":"Open in playground",to:`${b.original.id}/playground`,children:"Playground"})}),e(AC,{promptId:b.original.id,onDeleted:()=>{d({},{fetchPolicy:"network-only"})}})]})}],[d]),u=Le({columns:f,data:c,getCoreRowModel:we(),getSortedRowModel:Pn()}),g=u.getRowModel().rows,y=g.length===0;return e("div",{css:F`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:k=>p(k.target),ref:t,children:s("table",{css:sa,children:[e("thead",{children:u.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(b=>{var S;return e("th",{colSpan:b.colSpan,children:b.isPlaceholder?null:s("div",{className:b.column.getCanSort()?"cursor-pointer":"","aria-role":b.column.getCanSort()?"button":null,onClick:b.column.getToggleSortingHandler(),style:{textAlign:(S=b.column.columnDef.meta)==null?void 0:S.textAlign},children:[Z(b.column.columnDef.header,b.getContext()),b.column.getIsSorted()?e(L,{className:"sort-icon",svg:b.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},b.id)})},k.id))}),y?e(cn,{}):e("tbody",{children:g.map(k=>e("tr",{onClick:()=>{a(`${k.original.id}`)},children:k.getVisibleCells().map(b=>{var S;return e("td",{align:(S=b.column.columnDef.meta)==null?void 0:S.textAlign,children:Z(b.column.columnDef.cell,b.getContext())},b.id)})},k.id))})]})})}function eF(){const n=qe();return Je(n),s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(oe,{level:1,children:"Prompts"}),e(Ta,{size:"M",leadingVisual:e(L,{svg:e(Nl,{})}),variant:"primary",to:"/playground",children:"Create Prompt"})]})}),e(NC,{query:n})]})}const pm=function(){var n=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"promptsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"promptsLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"191e9b9974109498195fdef708db636b",id:null,metadata:{},name:"promptsLoaderQuery",operationKind:"query",text:`query promptsLoaderQuery {
  ...PromptsTable_prompts
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();pm.hash="ed4295f193bd2a6d2402a82966d45a7f";async function nF(n){return await x.fetchQuery(Fe,pm,{}).toPromise()}const gm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},f={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},u=[l,i],g={alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:u,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionsPageContent__main"},{args:null,kind:"FragmentSpread",name:"PromptLayout__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[r,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null},{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,c,p,f,g],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,p,c,f,g],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:u,storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"cc1c86124ed137944acd05f33823e920",id:null,metadata:{},name:"promptLoaderQuery",operationKind:"query",text:`query promptLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
      ...PromptIndexPage__main
      ...PromptVersionsPageContent__main
      ...PromptLayout__main
    }
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptLayout__main on Prompt {
  id
  name
  description
  sourcePrompt {
    id
    name
  }
  promptVersions {
    edges {
      node {
        id
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptVersionsPageContent__main on Prompt {
  ...PromptVersionsList__main
}
`}}}();gm.hash="dd012c15d97eec72a33a69900a92dc9a";async function aF(n){const{promptId:a}=n.params;return await x.fetchQuery(Fe,gm,{id:a}).toPromise().catch(()=>{throw new Error("Prompt not found")})}const ym=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsConfigCard_data",selections:[n,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();ym.hash="3650e60f18eb8d95b707df7bdbce99a9";const fm=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f33f0c5c35bdfcb0a9fdb1eacff3dec8",id:null,metadata:{},name:"DeletePromptVersionTagButtonMutation",operationKind:"mutation",text:`mutation DeletePromptVersionTagButtonMutation(
  $input: DeletePromptVersionTagInput!
  $promptId: GlobalID!
) {
  deletePromptVersionTag(input: $input) {
    query {
      node(id: $promptId) {
        __typename
        ...PromptVersionTagsConfigCard_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();fm.hash="9a239d04f2789c811b994f09bd0a814a";function $C({promptVersionTagId:n,promptId:a}){const[t,l]=m.useState(!1),i=he(),[r,o]=x.useMutation(fm);return s(_t,{isOpen:t,onOpenChange:l,children:[e(M,{"aria-label":"Delete tag",size:"S",leadingVisual:e(L,{svg:e(Ye,{})})}),e(Dr,{size:"S",isDismissable:!0,children:s(Dt,{children:[e(oe,{slot:"title",children:"Delete Tag"}),e(C,{padding:"size-200",children:e(C,{paddingBottom:"size-100",children:e(v,{color:"danger",size:"XS",children:"Are you sure you want to delete this tag? This will make pulling prompts by this tag no longer possible. Make sure this tag is not used before deleting."})})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:s(h,{gap:"size-100",justifyContent:"end",children:[e(M,{size:"S",onPress:()=>l(!1),children:"Cancel"}),e(M,{variant:"danger",size:"S",onPress:()=>r({variables:{input:{promptVersionTagId:n},promptId:a},onCompleted:()=>{i({title:"Tag Deleted",message:"The tag has been deleted"})}}),children:o?"Deleting...":"Delete Tag"})]})})]})})]})}function OC({prompt:n}){const a=x.useFragment(ym,n),t=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Ee},{header:"Version",accessorKey:"promptVersionId",cell:({row:d})=>{const{promptId:c,promptVersionId:p}=d.original;return e(Ze,{to:`/prompts/${c}/versions/${p}`,children:d.original.promptVersionId})}},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:d})=>e(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:e($C,{promptVersionTagId:d.original.id,promptId:d.original.promptId},d.original.id)})}],[]),l=m.useMemo(()=>a.versionTags.map(d=>({id:d.id,name:d.name,description:d.description,promptId:a.id,promptVersionId:d.promptVersionId})),[a]),i=Le({columns:t,data:l,getCoreRowModel:we(),getSortedRowModel:Pn()}),r=i.getRowModel().rows,o=r.length===0;return e(q,{title:"Tags",variant:"compact",bodyStyle:{padding:0},children:s("table",{css:sn,children:[e("thead",{children:i.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:s("div",{className:c.column.getCanSort()?"cursor-pointer":"",onClick:c.column.getToggleSortingHandler(),style:{left:c.getStart(),width:c.getSize()},children:[Z(c.column.columnDef.header,c.getContext()),c.column.getIsSorted()?e(L,{className:"sort-icon",svg:c.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]})},c.id))},d.id))}),o?e(cn,{message:"No Tags"}):e("tbody",{children:r.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:Z(c.column.columnDef.cell,c.getContext())},c.id))},d.id))})]})})}function tF(){const n=qe();return Je(n),e(h,{direction:"row",height:"100%",children:e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:e(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:e(OC,{prompt:n.prompt})})})})})}function lF(){const n=qe();return Je(n),e(ry,{query:n,children:e(Ke,{})})}const hm=function(){var n={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],storageKey:null}]},params:{cacheID:"d63c6184305079deb38a6f6235ba88e6",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    passwordNeedsReset
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    role {
      name
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}}();hm.hash="d30a68846023740517243e9394be73a8";async function iF(){var a;const n=await x.fetchQuery(Fe,hm,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const t=ss({path:"/reset-password"});return it(t)}return n}const QC=F`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--ac-global-dimension-size-200);
  padding: var(--ac-global-dimension-size-200);
`;function rF(){return e("main",{children:s(h,{direction:"column",width:"100%",children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",gap:"size-50",children:[e(oe,{level:1,children:"Support"}),e(v,{color:"text-700",children:"We are here to help. Pick a channel below to get in touch with us."})]})}),s("div",{css:QC,children:[e(nt,{leadingVisual:e(L,{svg:e(sy,{})}),href:"https://docs.arize.com/phoenix",title:"Documentation",description:"Visit our documentation for tutorials and AI support."}),e(nt,{leadingVisual:e(L,{svg:e(Vi,{})}),href:"https://github.com/Arize-ai/phoenix/issues",title:"GitHub Issues",description:"Create an issue on Github to report bugs or request new features."}),e(nt,{leadingVisual:e(L,{svg:e(Vi,{})}),href:"https://github.com/Arize-ai/phoenix/discussions",title:"GitHub Discussions",description:"Create a discussion on Github to ask questions or share feedback."}),e(nt,{leadingVisual:e(L,{svg:e(Ai,{})}),href:"https://arize-ai.slack.com/join/shared_invite/zt-11t1vbu4x-xkBIHmOREQnYnYDH1GDfCg?__hstc=259489365.a667dfafcfa0169c8aee4178d115dc81.1733501603539.1733501603539.1733501603539.1&__hssc=259489365.1.1733501603539&__hsfp=3822854628&submissionGuid=381a0676-8f38-437b-96f2-fc10875658df#/shared-invite/email",title:"Slack",description:"Join our Slack community to chat with other users and the team."}),e(nt,{leadingVisual:e(L,{svg:e(Ai,{})}),href:"mailto:phoenix-support@arize.com?subject=Slack%20Connect%20Request",title:"Slack Connect",description:"Get a dedicated support channel for you and your team."})]})]})})}const jC=F`
  padding: var(--ac-global-dimension-size-200)
    var(--ac-global-dimension-size-200) var(--ac-global-dimension-size-200);
  border: var(--ac-global-border-size-thin) solid
    var(--ac-global-border-color-dark);
  border-radius: var(--ac-global-dimension-size-100);
  cursor: pointer;
  background-color: var(--ac-global-background-color-dark);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
  color: var(--ac-global-color-text-700);
  transition: border-color 0.2s ease-in-out;
  text-decoration: none;
  &:hover {
    border-color: var(--ac-global-color-primary);
  }
`,nt=({leadingVisual:n,href:a,title:t,description:l})=>s("a",{css:jC,href:a,target:"_blank",rel:"noreferrer",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[n,e(oe,{level:2,children:t})]}),e(v,{color:"text-700",children:l})]});export{c2 as $,R2 as A,z2 as B,N2 as C,S2 as D,k2 as E,W2 as F,V2 as G,M2 as H,A2 as I,E2 as J,O2 as K,B2 as L,h2 as M,$2 as N,Z2 as O,J2 as P,Y2 as Q,Sn as R,y2 as S,Yn as T,X2 as U,nF as V,eF as W,aF as X,i2 as Y,m2 as Z,u2 as _,aa as a,p2 as a0,l2 as a1,tF as a2,r2 as a3,s2 as a4,d2 as a5,q2 as a6,rF as a7,j2 as a8,e2 as a9,YC as aa,XC as ab,Q2 as ac,n2 as ad,lF as ae,x2 as af,ZC as ag,JC as ah,kn as b,Yy as c,U2 as d,H2 as e,iF as f,v2 as g,f2 as h,b2 as i,D2 as j,L2 as k,C2 as l,WC as m,o2 as n,P2 as o,I2 as p,T2 as q,G2 as r,g2 as s,K2 as t,Q1 as u,a2 as v,F2 as w,t2 as x,_2 as y,w2 as z};
